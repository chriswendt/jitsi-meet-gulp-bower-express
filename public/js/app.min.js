/**
 * meet - 
 * @version v0.0.0
 * @link 
 * @license MIT
 */
!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.APP=e()}}(function(){var e;return function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return o(n?n:t)},l,l.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t){function n(){i.RTC.start(),i.xmpp.start(),i.statistics.start(),i.connectionquality.init(),i.desktopsharing.init(),i.keyboardshortcut.init(),i.members.start()}var i={init:function(){this.UI=e("./modules/UI/UI"),this.API=e("./modules/API/API"),this.connectionquality=e("./modules/connectionquality/connectionquality"),this.statistics=e("./modules/statistics/statistics"),this.RTC=e("./modules/RTC/RTC"),this.simulcast=e("./modules/simulcast/simulcast"),this.desktopsharing=e("./modules/desktopsharing/desktopsharing"),this.xmpp=e("./modules/xmpp/xmpp"),this.keyboardshortcut=e("./modules/keyboardshortcut/keyboardshortcut"),this.translation=e("./modules/translation/translation"),this.settings=e("./modules/settings/Settings"),this.DTMF=e("./modules/DTMF/DTMF"),this.members=e("./modules/members/MemberList")}};$(document).ready(function(){i.init(),i.translation.init(),i.API.isEnabled()&&i.API.init(),i.UI.start(n)}),$(window).bind("beforeunload",function(){i.API.isEnabled()&&i.API.dispose()}),t.exports=i},{"./modules/API/API":2,"./modules/DTMF/DTMF":3,"./modules/RTC/RTC":7,"./modules/UI/UI":9,"./modules/connectionquality/connectionquality":36,"./modules/desktopsharing/desktopsharing":37,"./modules/keyboardshortcut/keyboardshortcut":38,"./modules/members/MemberList":39,"./modules/settings/Settings":40,"./modules/simulcast/simulcast":45,"./modules/statistics/statistics":48,"./modules/translation/translation":49,"./modules/xmpp/xmpp":63}],2:[function(e,t){function n(e){if("execute"!=e.action)return void console.error("Unknown action of the message");for(var t in e)c[t]&&c[t].apply(null,e[t])}function i(e){if(!e.action)return void console.error("Event with no action is received.");var t=0;switch(e.action){case"add":for(;t<e.events.length;t++)l[e.events[t]]=!0;break;case"remove":for(;t<e.events.length;t++)l[e.events[t]]=!1;break;default:console.error("Unknown action for event.")}}function o(e){window.parent.postMessage(JSON.stringify(e),"*")}function r(e){var t;try{t=JSON.parse(e.data)}catch(o){}if(t.type)switch(t.type){case"command":n(t);break;case"event":i(t);break;default:return void console.error("Unknown type of the message")}}function a(){APP.xmpp.addListener(s.MUC_MEMBER_JOINED,function(e){d.triggerEvent("participantJoined",{jid:e})}),APP.xmpp.addListener(s.MESSAGE_RECEIVED,function(e,t,n,i){e!=i&&d.triggerEvent("incomingMessage",{from:e,nick:t,message:n})}),APP.xmpp.addListener(s.MUC_MEMBER_LEFT,function(e){d.triggerEvent("participantLeft",{jid:e})}),APP.xmpp.addListener(s.DISPLAY_NAME_CHANGED,function(e,t){name=u[e],name&&name==t||(d.triggerEvent("displayNameChange",{jid:e,displayname:t}),u[e]=t)}),APP.xmpp.addListener(s.SENDING_CHAT_MESSAGE,function(e){APP.API.triggerEvent("outgoingMessage",{message:e})})}var s=e("../../service/xmpp/XMPPEvents"),c={displayName:APP.UI.inputDisplayNameHandler,muteAudio:APP.UI.toggleAudio,muteVideo:APP.UI.toggleVideo,toggleFilmStrip:APP.UI.toggleFilmStrip,toggleChat:APP.UI.toggleChat,toggleContactList:APP.UI.toggleContactList},l={incomingMessage:!1,outgoingMessage:!1,displayNameChange:!1,participantJoined:!1,participantLeft:!1},u={},d={isEnabled:function(){var e=location.hash;return e&&e.indexOf("external")>-1&&window.postMessage?!0:!1},init:function(){window.addEventListener?window.addEventListener("message",r,!1):window.attachEvent("onmessage",r),o({type:"system",loaded:!0}),a()},isEventEnabled:function(e){return l[e]},triggerEvent:function(e,t){this.isEnabled()&&this.isEventEnabled(e)&&o({type:"event",action:"result",event:e,result:t})},dispose:function(){window.removeEventListener?window.removeEventListener("message",r,!1):window.detachEvent("onmessage",r)}};t.exports=d},{"../../service/xmpp/XMPPEvents":75}],3:[function(e,t){var n,i=function(){if(!n){var e=APP.RTC.localAudio;if(e&&e.getTracks().length>0){var t=APP.xmpp.getConnection().jingle.activecall.peerconnection;t?(n=t.peerconnection.createDTMFSender(e.getTracks()[0]),console.log("Initialized DTMFSender")):console.log("Failed to initialize DTMFSender: no PeerConnection.")}else console.log("Failed to initialize DTMFSender: no audio track.")}},o={sendTones:function(e,t,o){n||i(),n&&n.insertDTMF(e,t||200,o||200)}};t.exports=o},{}],4:[function(e,t){function n(e){console.log("selected endpoint changed: ",e),r&&0!=r.length&&r.some(function(t){return"open"==t.readyState?(console.log("sending selected endpoint changed notification to the bridge: ",e),t.send(JSON.stringify({colibriClass:"SelectedEndpointChangedEvent",selectedEndpoint:e&&null!==e?e:null})),!0):void 0})}function i(e){console.log("pinned endpoint changed: ",e),r&&0!=r.length&&r.some(function(t){return"open"==t.readyState?(t.send(JSON.stringify({colibriClass:"PinnedEndpointChangedEvent",pinnedEndpoint:e&&null!=e?e:null})),!0):void 0})}var o=e("../../service/RTC/RTCEvents"),r=[],a=null,s={onDataChannel:function(e){var t=e.channel;t.onopen=function(){console.info("Data channel opened by the Videobridge!",t);var e=APP.UI.getLargeVideoState().userResourceJid;n(e)},t.onerror=function(e){console.error("Data Channel Error:",e,t)},t.onmessage=function(e){var n,i=e.data;try{n=JSON.parse(i)}catch(r){console.error("Failed to parse data channel message as JSON: ",i,t)}if("undefined"!=typeof n&&null!==n){var s=n.colibriClass;if("DominantSpeakerEndpointChangeEvent"===s){var c=n.dominantSpeakerEndpoint;console.info("Data channel new dominant speaker event: ",c),a.emit(o.DOMINANTSPEAKER_CHANGED,c)}else if("InLastNChangeEvent"===s){var l,u=n.oldValue,d=n.newValue;"boolean"!=(l=typeof u)&&(u="string"===l?"true"==u:new Boolean(u).valueOf()),"boolean"!=(l=typeof d)&&(d="string"===l?"true"==d:new Boolean(d).valueOf()),a.emit(o.LASTN_CHANGED,u,d)}else if("LastNEndpointsChangeEvent"===s){{var p=n.lastNEndpoints,f=n.endpointsEnteringLastN;n.stream}console.log("Data channel new last-n event: ",p,f,n),a.emit(o.LASTN_ENDPOINT_CHANGED,p,f,n)}else"SimulcastLayersChangedEvent"===s?a.emit(o.SIMULCAST_LAYER_CHANGED,n.endpointSimulcastLayers):"SimulcastLayersChangingEvent"===s?a.emit(o.SIMULCAST_LAYER_CHANGING,n.endpointSimulcastLayers):"StartSimulcastLayerEvent"===s?a.emit(o.SIMULCAST_START,n.simulcastLayer):"StopSimulcastLayerEvent"===s?a.emit(o.SIMULCAST_STOP,n.simulcastLayer):console.debug("Data channel JSON-formatted message: ",n)}},t.onclose=function(){console.info("The Data Channel closed",t);var e=r.indexOf(t);e>-1&&(r=r.splice(e,1))},r.push(t)},init:function(e,t){config.openSctp&&(e.ondatachannel=this.onDataChannel,a=t)},handleSelectedEndpointEvent:n,handlePinnedEndpointEvent:i};t.exports=s},{"../../service/RTC/RTCEvents":66}],5:[function(e,t){function n(e,t,n,i,o){this.stream=e,this.eventEmitter=n,this.type=t,this.videoType=i,this.isGUMStream=!0,o===!1&&(this.isGUMStream=o);var r=this;this.getTracks="audio"==t?function(){return r.stream.getAudioTracks()}:function(){return r.stream.getVideoTracks()},this.stream.onended=function(){r.streamEnded()}}var i=e("../../service/RTC/StreamEventTypes.js");n.prototype.streamEnded=function(){this.eventEmitter.emit(i.EVENT_TYPE_LOCAL_ENDED,this)},n.prototype.getOriginalStream=function(){return this.stream},n.prototype.isAudioStream=function(){return"audio"===this.type},n.prototype.setMute=function(e){if("https:"!=window.location.protocol&&this.isGUMStream||this.isAudioStream()&&this.isGUMStream||"screen"===this.videoType)for(var t=this.getTracks(),n=0;n<t.length;n++)t[n].enabled=e;else if(e===!1)APP.xmpp.removeStream(this.stream),this.stream.stop();else{var i=this;APP.RTC.rtcUtils.obtainAudioAndVideoPermissions(this.isAudioStream()?["audio"]:["video"],function(e){i.isAudioStream()?APP.RTC.changeLocalAudio(e,function(){}):APP.RTC.changeLocalVideo(e,!1,function(){})})}},n.prototype.isMuted=function(){var e=[];if("audio"==this.type)e=this.stream.getAudioTracks();else{if(this.stream.ended)return!0;e=this.stream.getVideoTracks()}for(var t=0;t<e.length;t++)if(e[t].enabled)return!1;return!0},n.prototype.getId=function(){return this.stream.getTracks()[0].id},t.exports=n},{"../../service/RTC/StreamEventTypes.js":68}],6:[function(e,t){function n(e,t,n,o,r){this.sid=t,this.stream=e.stream,this.peerjid=e.peerjid,this.ssrc=n,this.type=this.stream.getVideoTracks().length>0?i.VIDEO_TYPE:i.AUDIO_TYPE,this.videoType=null,this.muted=!1,this.eventEmitter=r}var i=e("../../service/RTC/MediaStreamTypes"),o=e("../../service/RTC/StreamEventTypes");n.prototype.getOriginalStream=function(){return this.stream},n.prototype.setMute=function(e){this.stream.muted=e,this.muted=e},n.prototype.setVideoType=function(e){this.videoType!==e&&(this.videoType=e,this.eventEmitter.emit(o.EVENT_TYPE_REMOTE_CHANGED,this.peerjid))},t.exports=n},{"../../service/RTC/MediaStreamTypes":64,"../../service/RTC/StreamEventTypes":68}],7:[function(e,t){function n(){var e={audio:!0,video:!0};return e}var i=e("events"),o=e("./RTCUtils.js"),r=e("./LocalStream.js"),a=e("./DataChannels"),s=e("./MediaStream.js"),c=e("../../service/desktopsharing/DesktopSharingEventTypes"),l=e("../../service/RTC/MediaStreamTypes"),u=e("../../service/RTC/StreamEventTypes.js"),d=e("../../service/RTC/RTCEvents.js"),p=e("../../service/xmpp/XMPPEvents"),f=e("../../service/UI/UIEvents"),h=new i,m={rtcUtils:null,devices:{audio:!0,video:!0},localStreams:[],remoteStreams:{},localAudio:null,localVideo:null,addStreamListener:function(e,t){h.on(t,e)},addListener:function(e,t){h.on(e,t)},removeStreamListener:function(e,t){if(!(t instanceof u))throw"Illegal argument";h.removeListener(t,e)},createLocalStream:function(e,t,n,i,o,a){var s=new r(e,t,h,i,a);(0==this.localStreams.length||this.localStreams[0].getOriginalStream()!=e)&&this.localStreams.push(s),o===!0&&s.setMute(!1),"audio"==t?this.localAudio=s:this.localVideo=s;var c=u.EVENT_TYPE_LOCAL_CREATED;return n&&(c=u.EVENT_TYPE_LOCAL_CHANGED),h.emit(c,s,o),s},removeLocalStream:function(e){for(var t=0;t<this.localStreams.length;t++)if(this.localStreams[t].getOriginalStream()===e)return void delete this.localStreams[t]},createRemoteStream:function(e,t,n){var i=new s(e,t,n,this.getBrowserType(),h),o=e.peerjid||APP.xmpp.myJid();return this.remoteStreams[o]||(this.remoteStreams[o]={}),this.remoteStreams[o][i.type]=i,h.emit(u.EVENT_TYPE_REMOTE_CREATED,i),i},getBrowserType:function(){return this.rtcUtils.browser},getPCConstraints:function(){return this.rtcUtils.pc_constraints},getUserMediaWithConstraints:function(e,t,n,i,o,r,a){return this.rtcUtils.getUserMediaWithConstraints(e,t,n,i,o,r,a)},attachMediaStream:function(e,t){this.rtcUtils.attachMediaStream(e,t)},getStreamID:function(e){return this.rtcUtils.getStreamID(e)},getVideoSrc:function(e){return this.rtcUtils.getVideoSrc(e)},setVideoSrc:function(e,t){this.rtcUtils.setVideoSrc(e,t)},dispose:function(){this.rtcUtils&&(this.rtcUtils=null)},stop:function(){this.dispose()},start:function(){var e=this;APP.desktopsharing.addListener(function(t,n,i){e.changeLocalVideo(t,n,i)},c.NEW_STREAM_CREATED),APP.xmpp.addListener(p.STREAMS_CHANGED,function(t,n){for(var i=0;i<n.length;i++){var o=n[i].type;if("audio"!=o){var r=e.remoteStreams[t];if(!r)continue;var a=r[l.VIDEO_TYPE];if(!a)continue;a.setVideoType(n[i].type)}}}),APP.xmpp.addListener(p.CALL_INCOMING,function(e){a.init(e.peerconnection,h)}),APP.UI.addListener(f.SELECTED_ENDPOINT,a.handleSelectedEndpointEvent),APP.UI.addListener(f.PINNED_ENDPOINT,a.handlePinnedEndpointEvent),this.rtcUtils=new o(this),this.rtcUtils.obtainAudioAndVideoPermissions(null,null,n())},muteRemoteVideoStream:function(e,t){var n;return this.remoteStreams[e]&&this.remoteStreams[e][l.VIDEO_TYPE]&&(n=this.remoteStreams[e][l.VIDEO_TYPE]),n?t!=n.muted?(n.setMute(t),!0):!1:!0},switchVideoStreams:function(e){this.localVideo.stream=e,this.localStreams=[],this.localAudio.getOriginalStream()!=e&&this.localStreams.push(this.localAudio),this.localStreams.push(this.localVideo)},changeLocalVideo:function(e,t,n){var i=this.localVideo.getOriginalStream(),o=t?"screen":"video",r=n;this.localVideo.isMuted()&&this.localVideo.videoType!==o&&(r=function(){APP.xmpp.setVideoMute(!1,APP.UI.setVideoMuteButtonsState),n()});var a=this.rtcUtils.createStream(e,!0);this.localVideo=this.createLocalStream(a,"video",!0,o),i.stop(),APP.xmpp.switchStreams(a,i,r)},changeLocalAudio:function(e,t){var n=this.localAudio.getOriginalStream(),i=this.rtcUtils.createStream(e);this.localAudio=this.createLocalStream(i,"audio",!0),n.stop(),APP.xmpp.switchStreams(i,n,t,!0)},isVideoSrcDesktop:function(e){if(!e)return!1;var t=!1,n=null;if(APP.xmpp.myJid()===e)n=this.localVideo;else{var i=this.remoteStreams[e];if(!i)return!1;n=i[l.VIDEO_TYPE]}return n&&(t="screen"===n.videoType),t},setVideoMute:function(e,t,n){this.localVideo&&(e==APP.RTC.localVideo.isMuted()?(APP.xmpp.sendVideoInfoPresence(e),t&&t(e)):(APP.RTC.localVideo.setMute(!e),APP.xmpp.setVideoMute(e,t,n)))},setDeviceAvailability:function(e){e&&((e.audio===!0||e.audio===!1)&&(this.devices.audio=e.audio),(e.video===!0||e.video===!1)&&(this.devices.video=e.video),h.emit(d.AVAILABLE_DEVICES_CHANGED,this.devices))}};t.exports=m},{"../../service/RTC/MediaStreamTypes":64,"../../service/RTC/RTCEvents.js":66,"../../service/RTC/StreamEventTypes.js":68,"../../service/UI/UIEvents":69,"../../service/desktopsharing/DesktopSharingEventTypes":72,"../../service/xmpp/XMPPEvents":75,"./DataChannels":4,"./LocalStream.js":5,"./MediaStream.js":6,"./RTCUtils.js":8,events:77}],8:[function(e,t){function n(e){if(!c[e])return null;var t=c[e].order,n=null,i=null;for(var o in c){var r=c[o];(null==n||n.order<r.order&&r.order<t)&&(i=o,n=r)}return i}function o(e,t,n){(t&&!e.video||n)&&(e.video={mandatory:{},optional:[]}),c[t]?(e.video.mandatory.minWidth=c[t].width,e.video.mandatory.minHeight=c[t].height):n&&(e.video.mandatory.minWidth=320,e.video.mandatory.minHeight=240,e.video.mandatory.maxFrameRate=15),e.video.mandatory.minWidth&&(e.video.mandatory.maxWidth=e.video.mandatory.minWidth),e.video.mandatory.minHeight&&(e.video.mandatory.maxHeight=e.video.mandatory.minHeight)}function r(e,t,n,i,r,a){var s={audio:!1,video:!1};return e.indexOf("video")>=0&&(s.video={mandatory:{},optional:[]}),e.indexOf("audio")>=0&&(s.audio={mandatory:{},optional:[]}),e.indexOf("screen")>=0&&(s.video={mandatory:{chromeMediaSource:"screen",googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[]}),e.indexOf("desktop")>=0&&(s.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[]}),s.audio&&s.audio.optional.push({googEchoCancellation:!0},{googAutoGainControl:!0},{googNoiseSupression:!0},{googHighpassFilter:!0},{googNoisesuppression2:!0},{googEchoCancellation2:!0},{googAutoGainControl2:!0}),s.video&&(s.video.optional.push({googNoiseReduction:!1}),e.indexOf("video")>=0&&s.video.optional.push({googLeakyBucket:!0})),e.indexOf("video")>=0&&o(s,t,a),n&&(s.video||(s.video={mandatory:{},optional:[]}),s.video.optional.push({bandwidth:n})),i&&(s.video||(s.video={mandatory:{},optional:[]}),s.video.mandatory.minFrameRate=i),s}function a(e){if(this.service=e,navigator.mozGetUserMedia){console.log("This appears to be Firefox");var t=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10);if(!(t>=38&&!config.enableSimulcast&&config.useBundle&&config.useRtcpMux))return void(window.location.href="unsupported_browser.html");this.peerconnection=mozRTCPeerConnection,this.browser=s.RTC_BROWSER_FIREFOX,this.getUserMedia=navigator.mozGetUserMedia.bind(navigator),this.pc_constraints={},this.attachMediaStream=function(e,t){e[0]&&(e[0].mozSrcObject=t,e[0].play())},this.getStreamID=function(e){var t=e.getVideoTracks();return t&&0!=t.length||(t=e.getAudioTracks()),t[0].id.replace(/[\{,\}]/g,"")},this.getVideoSrc=function(e){return e?e.mozSrcObject:null},this.setVideoSrc=function(e,t){e&&(e.mozSrcObject=t)},RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate}else{if(!navigator.webkitGetUserMedia){try{console.log("Browser does not appear to be WebRTC-capable")}catch(n){}return void(window.location.href="unsupported_browser.html")}console.log("This appears to be Chrome"),this.peerconnection=webkitRTCPeerConnection,this.browser=s.RTC_BROWSER_CHROME,this.getUserMedia=navigator.webkitGetUserMedia.bind(navigator),this.attachMediaStream=function(e,t){e.attr("src",webkitURL.createObjectURL(t))},this.getStreamID=function(e){return e.id.replace(/[\{,\}]/g,"")},this.getVideoSrc=function(e){return e?e.getAttribute("src"):null},this.setVideoSrc=function(e,t){e&&e.setAttribute("src",t)},this.pc_constraints={optional:[{DtlsSrtpKeyAgreement:"true"}]},-1!=navigator.userAgent.indexOf("Android")&&(this.pc_constraints={}),webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks}),webkitMediaStream.prototype.getAudioTracks||(webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks})}}var s=e("../../service/RTC/RTCBrowserType.js"),c=e("../../service/RTC/Resolutions"),l=null;a.prototype.getUserMediaWithConstraints=function(e,t,n,i,o,a,s){l=i;var c=-1!=navigator.userAgent.indexOf("Android"),u=r(e,i,o,a,s,c),d=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,p=this;try{config.enableSimulcast&&u.video&&"screen"!==u.video.chromeMediaSource&&"desktop"!==u.video.chromeMediaSource&&!c&&!d?APP.simulcast.getUserMedia(u,function(n){console.log("onUserMediaSuccess"),p.setAvailableDevices(e,!0),t(n)},function(t){console.warn("Failed to get access to local media. Error ",t),p.setAvailableDevices(e,!1),n&&n(t)}):this.getUserMedia(u,function(n){console.log("onUserMediaSuccess"),p.setAvailableDevices(e,!0),t(n)},function(t){p.setAvailableDevices(e,!1),console.warn("Failed to get access to local media. Error ",t,u),n&&n(t)})}catch(f){console.error("GUM failed: ",f),n&&n(f)}},a.prototype.setAvailableDevices=function(e,t){var n={};-1!=e.indexOf("video")&&(n.video=t),-1!=e.indexOf("audio")&&(n.audio=t),this.service.setDeviceAvailability(n)},a.prototype.obtainAudioAndVideoPermissions=function(e,t,n){var i=this,o=function(e){t?t(e,n):i.successCallback(e,n)};e||(e=["audio","video"]);var r=[];if(n)for(var a=0;a<e.length;a++){var s=e[a];n[s]===!0&&r.push(s)}else r=e;return 0===r.length?void o():void(navigator.mozGetUserMedia?i.getUserMediaWithConstraints(["audio"],function(e){i.getUserMediaWithConstraints(["video"],function(t){return i.successCallback({audioStream:e,videoStream:t})},function(e){return console.error("failed to obtain video stream - stop",e),i.successCallback(null)},config.resolution||"360")},function(e){return console.error("failed to obtain audio stream - stop",e),i.successCallback(null)}):this.getUserMediaWithConstraints(r,function(e){o(e)},function(e){i.errorCallback(e)},config.resolution||"360"))},a.prototype.successCallback=function(e,t){e&&!navigator.mozGetUserMedia&&console.log("got",e,e.getAudioTracks().length,e.getVideoTracks().length),this.handleLocalStream(e,t)},a.prototype.errorCallback=function(e){var t=this;console.error("failed to obtain audio/video stream - trying audio only",e);var i=n(l);"object"!=typeof e||!e.constraintName||!e.name||"ConstraintNotSatisfiedError"!=e.name&&"OverconstrainedError"!=e.name||"minWidth"!=e.constraintName&&"maxWidth"!=e.constraintName&&"minHeight"!=e.constraintName&&"maxHeight"!=e.constraintName||null==i?t.getUserMediaWithConstraints(["audio"],function(e){return t.successCallback(e)},function(e){return console.error("failed to obtain audio/video stream - stop",e),t.successCallback(null)}):t.getUserMediaWithConstraints(["audio","video"],function(e){return t.successCallback(e)},function(e){return t.errorCallback(e)},i)},a.prototype.handleLocalStream=function(e,t){var n,i;if(window.webkitMediaStream){if(n=new webkitMediaStream,i=new webkitMediaStream,e){for(var o=e.getAudioTracks(),r=0;r<o.length;r++)n.addTrack(o[r]);var a=e.getVideoTracks();for(r=0;r<a.length;r++)i.addTrack(a[r])}}else n=e.audioStream,i=e.videoStream;var s=t&&t.audio===!1,c=t&&t.video===!1,l=!t||t.audio!==!1,u=!t||t.video!==!1;this.service.createLocalStream(n,"audio",null,null,s,l),this.service.createLocalStream(i,"video",null,null,c,u)},a.prototype.createStream=function(e,t){var n=null;if(window.webkitMediaStream){if(n=new webkitMediaStream){var o=t?e.getVideoTracks():e.getAudioTracks();for(i=0;i<o.length;i++)n.addTrack(o[i])}}else n=e;return n},t.exports=a},{"../../service/RTC/RTCBrowserType.js":65,"../../service/RTC/Resolutions":67}],9:[function(e,t){function n(){G.notify(null,"notify.mutedTitle","connected","notify.muted",null,{timeOut:12e4})}function i(){$("#reloadPresentationLink").click(function(){D.reloadPresentation()})}function o(){I.init(),$("#toggle_smileys").click(function(){I.toggleSmileys()})}function r(){N.init(k),N.setupButtonsFromConfig(),O.init()}function a(e,t){switch(e.type){case"audio":R.changeLocalAudio(e,t);break;case"video":R.changeLocalVideo(e,t);break;case"stream":R.changeLocalStream(e,t)}}function s(e){var t,n=APP.translation.generateTranslatonHTML("dialog.error");t=e?APP.translation.generateTranslatonHTML("dialog.connectErrorWithMsg",{msg:e}):APP.translation.generateTranslatonHTML("dialog.connectError"),G.openDialog(n,t,!0,{},function(){return!1})}function c(){N.showAuthenticateButton(!1)}function l(e,t){V.onDisplayNameChange(e,t),H.onDisplayNameChange(e,t),R.onDisplayNameChanged(e,t)}function u(){APP.RTC.addStreamListener(a,Z.EVENT_TYPE_LOCAL_CREATED),APP.RTC.addStreamListener(a,Z.EVENT_TYPE_LOCAL_CHANGED),APP.RTC.addStreamListener(function(e){R.onRemoteStreamAdded(e)},Z.EVENT_TYPE_REMOTE_CREATED),APP.RTC.addStreamListener(function(e){R.onVideoTypeChanged(e)},Z.EVENT_TYPE_REMOTE_CHANGED),APP.RTC.addListener(Q.LASTN_CHANGED,C),APP.RTC.addListener(Q.DOMINANTSPEAKER_CHANGED,function(e){R.onDominantSpeakerChanged(e)}),APP.RTC.addListener(Q.LASTN_ENDPOINT_CHANGED,function(e,t,n){R.onLastNEndpointsChanged(e,t,n)}),APP.RTC.addListener(Q.SIMULCAST_LAYER_CHANGED,function(e){R.onSimulcastLayersChanged(e)}),APP.RTC.addListener(Q.SIMULCAST_LAYER_CHANGING,function(e){R.onSimulcastLayersChanging(e)}),APP.RTC.addListener(Q.AVAILABLE_DEVICES_CHANGED,function(e){R.setDeviceAvailabilityIcons(null,e)}),APP.statistics.addAudioLevelListener(function(e,t){var n;e===APP.statistics.LOCAL_JID?(n=L.LOCAL_LEVEL,APP.RTC.localAudio.isMuted()&&(t=0)):n=Strophe.getResourceFromJid(e),L.updateAudioLevel(n,t,k.getLargeVideoState().userResourceJid)}),APP.desktopsharing.addListener(function(){j.showDesktopSharingButton()},X.INIT),APP.desktopsharing.addListener(N.changeDesktopSharingButtonState,X.SWITCHING_DONE),APP.connectionquality.addListener(K.LOCALSTATS_UPDATED,R.updateLocalConnectionStats),APP.connectionquality.addListener(K.REMOTESTATS_UPDATED,R.updateConnectionStats),APP.connectionquality.addListener(K.STOP,R.onStatsStop),APP.xmpp.addListener(et.CONNECTION_FAILED,s),APP.xmpp.addListener(et.DISPOSE_CONFERENCE,c),APP.xmpp.addListener(et.GRACEFUL_SHUTDOWN,function(){G.openMessageDialog("dialog.serviceUnavailable","dialog.gracefulShutdown")}),APP.xmpp.addListener(et.RESERVATION_ERROR,function(e,t){var n=APP.translation.generateTranslatonHTML("dialog.reservationError"),i=APP.translation.generateTranslatonHTML("dialog.reservationErrorMsg",{code:e,msg:t});G.openDialog(n,i,!0,{},function(){return!1})}),APP.xmpp.addListener(et.KICKED,function(){G.openMessageDialog("dialog.sessTerminated","dialog.kickMessage")}),APP.xmpp.addListener(et.MUC_DESTROYED,function(e){var t=APP.translation.generateTranslatonHTML("dialog.sessTerminated");G.openDialog(t,e,!0,{},function(){return!1})}),APP.xmpp.addListener(et.BRIDGE_DOWN,function(){G.showError("dialog.error","dialog.bridgeUnavailable")}),APP.xmpp.addListener(et.USER_ID_CHANGED,function(e,t){U.setUserAvatar(e,t)}),APP.xmpp.addListener(et.STREAMS_CHANGED,function(e,t){for(stream in t)if("video"===stream.type||"screen"===stream.type){var n=$("#participant_"+Strophe.getResourceFromJid(e)+">video");switch(stream.direction){case"sendrecv":n.show();break;case"recvonly":n.hide()}}}),APP.xmpp.addListener(et.DISPLAY_NAME_CHANGED,l),APP.xmpp.addListener(et.MUC_JOINED,g),APP.xmpp.addListener(et.LOCAL_ROLE_CHANGED,b),APP.xmpp.addListener(et.MUC_MEMBER_JOINED,A),APP.xmpp.addListener(et.MUC_ROLE_CHANGED,P),APP.xmpp.addListener(et.PRESENCE_STATUS,x),APP.xmpp.addListener(et.SUBJECT_CHANGED,h),APP.xmpp.addListener(et.MESSAGE_RECEIVED,m),APP.xmpp.addListener(et.MUC_MEMBER_LEFT,y),APP.xmpp.addListener(et.PASSWORD_REQUIRED,_),APP.xmpp.addListener(et.CHAT_ERROR_RECEIVED,f),APP.xmpp.addListener(et.ETHERPAD,v),APP.xmpp.addListener(et.AUTHENTICATION_REQUIRED,T),APP.xmpp.addListener(et.DEVICE_AVAILABLE,function(e,t){R.setDeviceAvailabilityIcons(e,t)}),APP.members.addListener(tt.DTMF_SUPPORT_CHANGED,w),APP.xmpp.addListener(et.START_MUTED,function(e,t){H.setStartMuted(e,t)})}function d(e,t){APP.RTC.setVideoMute(e,k.setVideoMuteButtonsState,t)}function p(){$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){R.resizeLargeVideoContainer(),R.positionLarge()}),$(window).resize(function(){R.resizeLargeVideoContainer(),R.positionLarge()})}function f(e,t){return I.chatAddError(e,t)}function h(e){return I.chatSetSubject(e)}function m(e,t,n){return I.updateChatConversation(e,t,n)}function g(e,t){N.updateRoomUrl(window.location.href);var n=APP.translation.generateTranslatonHTML("me");$("#localNick").html(Strophe.getResourceFromJid(e)+" ("+n+")");var i=B.getSettings();V.addContact(e,i.email||i.uid),j.showToolbar();var o=config.displayJids?Strophe.getResourceFromJid(e):t.displayName;o&&l("localVideoContainer",o),R.mucJoined()}function v(e){M.init(e)}function y(e){console.log("left.muc",e);var t=$("#participant_"+Strophe.getResourceFromJid(e)+">.displayname").html();G.notify(t,"notify.somebody","disconnected","notify.disconnected"),window.setTimeout(function(){var t=document.getElementById("participant_"+Strophe.getResourceFromJid(e));t&&(V.removeContact(e),R.removeConnectionIndicator(e),$(t).hide(),R.resizeThumbnails())},10),R.participantLeft(e)}function b(e,t,n,i){console.info("My role changed, new role: "+t.role),S(i),R.showModeratorIndicator(),H.onRoleChanged(),i&&(q.closeAuthenticationWindow(),G.notify(null,"notify.me","connected","notify.moderator"))}function S(e){N.showSipCallButton(e),N.showRecordingButton(e),e&&config.etherpad_base&&M.init()}function _(e){N.lockLockButton();var t='<h2 data-i18n="dialog.passwordRequired">';t+=APP.translation.translateString("dialog.passwordRequired"),t+='</h2><input name="lockKey" type="text" data-i18n="[placeholder]dialog.password" placeholder="'+APP.translation.translateString("dialog.password")+'" autofocus>',G.openTwoButtonDialog(null,null,null,t,!0,"dialog.Ok",function(){},null,function(t,n,i,o){if(n){var r=o.lockKey;r&&(N.setSharedKey(r),e(r))}},":input:first")}function w(){}function A(e,t,n){G.notify(n,"notify.somebody","connected","notify.connected"),R.ensurePeerContainerExists(e,t)}function x(e,t){R.setPresenceStatus("participant_"+Strophe.getResourceFromJid(e),t.status)}function P(e,t){if(R.showModeratorIndicator(),"moderator"===e){var n,i={};t?(n="notify.grantedTo",i={to:t}):n="notify.grantedToUnknown",G.notify(t,"notify.somebody","connected",n,i)}}function T(e){q.openAuthenticationDialog(it,e,function(){N.authenticateClicked()})}function C(e,t){config.muteLocalVideoIfNotInLastN&&d(!t,{byUser:!1})}function E(e,t){e=e.parentNode,e.download=t||"meetlog.json",e.href="data:application/json;charset=utf-8,\n";var n=APP.xmpp.populateData(),i={};i.time=new Date,i.url=window.location.href,i.ua=navigator.userAgent;var o=APP.xmpp.getLogger();return o&&(i.xmpp=o),n.metadata=i,e.href+=encodeURIComponent(JSON.stringify(n,null,"  ")),!1}var k={},R=e("./videolayout/VideoLayout.js"),L=e("./audio_levels/AudioLevels.js"),D=e("./prezi/Prezi.js"),M=e("./etherpad/Etherpad.js"),I=e("./side_pannels/chat/Chat.js"),N=e("./toolbars/Toolbar"),j=e("./toolbars/ToolbarToggler"),O=e("./toolbars/BottomToolbar"),V=e("./side_pannels/contactlist/ContactList"),U=e("./avatar/Avatar"),F=e("events"),H=e("./side_pannels/settings/SettingsMenu"),B=e("./../settings/Settings"),z=e("./side_pannels/SidePanelToggler"),J=e("./welcome_page/RoomnameGenerator");k.messageHandler=e("./util/MessageHandler");var G=k.messageHandler,q=e("./authentication/Authentication"),W=e("./util/UIUtil"),Y=e("./util/NicknameHandler"),K=e("../../service/connectionquality/CQEvents"),X=e("../../service/desktopsharing/DesktopSharingEventTypes"),Q=e("../../service/RTC/RTCEvents"),Z=e("../../service/RTC/StreamEventTypes"),et=e("../../service/xmpp/XMPPEvents"),tt=e("../../service/members/Events"),nt=new F,it=null;k.start=function(t){if(document.title=interfaceConfig.APP_NAME,config.enableWelcomePage&&"/"==window.location.pathname&&(!window.localStorage.welcomePageDisabled||"false"==window.localStorage.welcomePageDisabled)){$("#videoconference_page").hide();var n=e("./welcome_page/WelcomePage");return void n()}if(interfaceConfig.SHOW_JITSI_WATERMARK){var a=$("#largeVideoContainer div[class='watermark leftwatermark']");a.css({display:"block"}),a.parent().get(0).href=interfaceConfig.JITSI_WATERMARK_LINK}if(interfaceConfig.SHOW_BRAND_WATERMARK){var s=$("#largeVideoContainer div[class='watermark rightwatermark']");s.css({display:"block"}),s.parent().get(0).href=interfaceConfig.BRAND_WATERMARK_LINK,s.get(0).style.backgroundImage="url(images/rightwatermark.png)"}if(interfaceConfig.SHOW_POWERED_BY&&$("#largeVideoContainer>a[class='poweredby']").css({display:"block"}),$("#welcome_page").hide(),R.resizeLargeVideoContainer(),$("#videospace").mousemove(function(){return j.showToolbar()}),jQuery.prompt.setDefaults({persistent:!1}),R.init(nt),L.init(),Y.init(nt),u(),p(),i(),r(),o(),document.title=interfaceConfig.APP_NAME,$("#downloadlog").click(function(e){E(e.target)}),config.enableWelcomePage&&"/"==window.location.pathname&&(!window.localStorage.welcomePageDisabled||"false"==window.localStorage.welcomePageDisabled)){$("#videoconference_page").hide();var n=e("./welcome_page/WelcomePage");return void n()}$("#welcome_page").hide(),config.noticeMessage&&($("#noticeText").text(config.noticeMessage),$("#notice").css({display:"block"})),document.getElementById("largeVideo").volume=0,$("#settings").is(":visible")?loginInfo.onsubmit=function(e){e.preventDefault&&e.preventDefault(),$("#settings").hide(),t()}:(console.log("init"),t()),toastr.options={closeButton:!0,debug:!1,positionClass:"notification-bottom-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"2000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",reposition:function(){z.isVisible()?$("#toast-container").addClass("notification-bottom-right-center"):$("#toast-container").removeClass("notification-bottom-right-center")},newestOnTop:!1},H.init()},k.toggleSmileys=function(){I.toggleSmileys()},k.getSettings=function(){return B.getSettings()},k.toggleFilmStrip=function(){return O.toggleFilmStrip()},k.toggleChat=function(){return O.toggleChat()},k.toggleContactList=function(){return O.toggleContactList()},k.inputDisplayNameHandler=function(e){R.inputDisplayNameHandler(e)},k.getLargeVideoState=function(){return R.getLargeVideoState()},k.generateRoomName=function(){if(it)return it;var e=null,t=window.location.pathname;if(config.getroomnode&&"function"==typeof config.getroomnode)e=config.getroomnode(t);else if(t.length>1)e=t.substr(1).toLowerCase();
else{var n=J.generateRoomWithoutSeparator();e=n.toLowerCase(),window.history.pushState("VideoChat","Room: "+n,window.location.pathname+n)}return it=e+"@"+config.hosts.muc},k.connectionIndicatorShowMore=function(e){return R.connectionIndicators[e].showMore()},k.showLoginPopup=function(e){console.log("password is required");var t='<h2 data-i18n="dialog.passwordRequired">';t+=APP.translation.translateString("dialog.passwordRequired"),t+='</h2><input name="username" type="text" placeholder="user@domain.net" autofocus><input name="password" type="password" data-i18n="[placeholder]dialog.userPassword" placeholder="user password">',k.messageHandler.openTwoButtonDialog(null,null,null,t,!0,"dialog.Ok",function(t,n,i,o){n&&null!==o.username&&null!=o.password&&e(o.username,o.password)},null,null,":input:first")},k.checkForNicknameAndJoin=function(){q.closeAuthenticationDialog(),q.stopInterval();var e=null;config.useNicks&&(e=window.prompt("Your nickname (optional)")),APP.xmpp.joinRoom(it,config.useNicks,e)},k.getRoomName=function(){return it},k.setInitialMuteFromFocus=function(e,t){(e||t)&&n(),e&&k.setAudioMuted(!0),t&&k.setVideoMute(!0)},k.toggleVideo=function(){d(!APP.RTC.localVideo.isMuted())},k.toggleAudio=function(){k.setAudioMuted(!APP.RTC.localAudio.isMuted())},k.setAudioMuted=function(e,t){var n=null;return n=t?function(e,t){return APP.xmpp.sendAudioInfoPresence(e,t)}:function(e,t){return APP.xmpp.setAudioMute(e,t)},n(e,function(){R.showLocalAudioIndicator(e),W.buttonClick("#mute","icon-microphone icon-mic-disabled")})?void 0:void W.buttonClick("#mute","icon-microphone icon-mic-disabled")},k.addListener=function(e,t){nt.on(e,t)},k.clickOnVideo=function(e){var t=$(".videocontainer:not(#mixedstream)");t.length>e&&t[e].click()},k.showToolbar=function(){return j.showToolbar()},k.dockToolbar=function(e){return j.dockToolbar(e)},k.setVideoMuteButtonsState=function(e){var t=$("#video"),n="icon-camera",i="icon-camera icon-camera-disabled";e?(t.removeClass(n),t.addClass(i)):(t.removeClass(i),t.addClass(n))},k.setVideoMute=d,t.exports=k},{"../../service/RTC/RTCEvents":66,"../../service/RTC/StreamEventTypes":68,"../../service/connectionquality/CQEvents":71,"../../service/desktopsharing/DesktopSharingEventTypes":72,"../../service/members/Events":73,"../../service/xmpp/XMPPEvents":75,"./../settings/Settings":40,"./audio_levels/AudioLevels.js":10,"./authentication/Authentication":12,"./avatar/Avatar":14,"./etherpad/Etherpad.js":15,"./prezi/Prezi.js":16,"./side_pannels/SidePanelToggler":18,"./side_pannels/chat/Chat.js":19,"./side_pannels/contactlist/ContactList":23,"./side_pannels/settings/SettingsMenu":24,"./toolbars/BottomToolbar":25,"./toolbars/Toolbar":26,"./toolbars/ToolbarToggler":27,"./util/MessageHandler":29,"./util/NicknameHandler":30,"./util/UIUtil":31,"./videolayout/VideoLayout.js":33,"./welcome_page/RoomnameGenerator":34,"./welcome_page/WelcomePage":35,events:77}],10:[function(e,t){function n(){var e=interfaceConfig.ACTIVE_SPEAKER_AVATAR_SIZE/2,t=(interfaceConfig.ACTIVE_SPEAKER_AVATAR_SIZE+e)/2;o.arc(t,t,e,0,2*Math.PI),o.shadowColor=interfaceConfig.SHADOW_COLOR,o.shadowOffsetX=0,o.shadowOffsetY=0}var i=e("./CanvasUtils"),o=$("#activeSpeakerAudioLevel")[0].getContext("2d"),r=function(e){function t(e,t,n){e.width=t+interfaceConfig.CANVAS_EXTRA,e.height=n+interfaceConfig.CANVAS_EXTRA}function a(e,t){if(!l[e]){var n=c(e),o=$("#"+n+">canvas").get(0);o&&(l[e]=i.cloneCanvas(o))}var r=l[e];if(r){var a=r.getContext("2d");a.clearRect(0,0,r.width,r.height);var u=s(t);u>0&&i.drawRoundRectGlow(a,interfaceConfig.CANVAS_EXTRA/2,interfaceConfig.CANVAS_EXTRA/2,r.width-interfaceConfig.CANVAS_EXTRA,r.height-interfaceConfig.CANVAS_EXTRA,interfaceConfig.CANVAS_RADIUS,interfaceConfig.SHADOW_COLOR,u)}}function s(e){var t=0;return t=Math.round(.3>=e?interfaceConfig.CANVAS_EXTRA/2*(e/.3):.6>=e?interfaceConfig.CANVAS_EXTRA/2*((e-.3)/.3):interfaceConfig.CANVAS_EXTRA/2*((e-.6)/.4))}function c(e){var t=null;return t=e===r.LOCAL_LEVEL||APP.xmpp.myResource()&&e===APP.xmpp.myResource()?"localVideoContainer":"participant_"+e}var l={};return e.LOCAL_LEVEL="local",e.init=function(){n()},e.updateAudioLevelCanvas=function(e,n){var i=null,o=null;e?(i=Strophe.getResourceFromJid(e),o="participant_"+i):o="localVideoContainer";var r=document.getElementById(o);if(!r)return void(i?console.error("No video element for jid",i):console.error("No video element for local video."));var a=$("#"+o+">canvas"),s=$("#remoteVideos").width(),c=n.calculateThumbnailSize(s),l=c[0],u=c[1];a&&0!==a.length?(a=a.get(0),t(a,l,u)):(a=document.createElement("canvas"),a.className="audiolevel",a.style.bottom="-"+interfaceConfig.CANVAS_EXTRA/2+"px",a.style.left="-"+interfaceConfig.CANVAS_EXTRA/2+"px",t(a,l,u),r.appendChild(a))},e.updateAudioLevel=function(e,t,n){a(e,t);var i=c(e),o=$("#"+i+">canvas").get(0);if(o){var s=o.getContext("2d"),u=l[e];if(s.clearRect(0,0,o.width,o.height),s.drawImage(u,0,0),e===r.LOCAL_LEVEL){if(!APP.xmpp.myJid())return;e=APP.xmpp.myResource()}e===n&&window.requestAnimationFrame(function(){r.updateActiveSpeakerAudioLevel(t)})}},e.updateActiveSpeakerAudioLevel=function(e){"hidden"!=$("#activeSpeaker").css("visibility")&&(o.clearRect(0,0,300,300),0!=e&&(o.shadowBlur=s(e),o.fill()))},$(document).bind("remotevideo.resized",function(e,t,n){var i=!1;$("#remoteVideos>span>canvas").each(function(){var e=$(this).get(0);e.width!==t+interfaceConfig.CANVAS_EXTRA&&(e.width=t+interfaceConfig.CANVAS_EXTRA,i=!0),e.heigh!==n+interfaceConfig.CANVAS_EXTRA&&(e.height=n+interfaceConfig.CANVAS_EXTRA,i=!0)}),i&&Object.keys(l).forEach(function(e){l[e].width=t+interfaceConfig.CANVAS_EXTRA,l[e].height=n+interfaceConfig.CANVAS_EXTRA})}),e}(r||{});t.exports=r},{"./CanvasUtils":11}],11:[function(e,t){var n=function(e){return e.drawRoundRectGlow=function(e,t,n,i,o,r,a,s){e.save(),2*r>i&&(r=i/2),2*r>o&&(r=o/2),e.beginPath(),e.moveTo(t+r,n),e.arcTo(t+i,n,t+i,n+o,r),e.arcTo(t+i,n+o,t,n+o,r),e.arcTo(t,n+o,t,n,r),e.arcTo(t,n,t+i,n,r),e.closePath(),e.shadowColor=a,e.shadowBlur=s,e.shadowOffsetX=0,e.shadowOffsetY=0,e.fill(),e.save(),e.restore(),e.beginPath(),e.moveTo(t+r,n),e.arcTo(t+i,n,t+i,n+o,r),e.arcTo(t+i,n+o,t,n+o,r),e.arcTo(t,n+o,t,n,r),e.arcTo(t,n,t+i,n,r),e.closePath(),e.clip(),e.clearRect(0,0,277,200),e.restore()},e.cloneCanvas=function(e){if(!e)return e;var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t},e}(n||{});t.exports=n},{}],12:[function(e,t){var n=e("./LoginDialog"),i=e("../../xmpp/moderator"),o=null,r=null,a=null,s={openAuthenticationDialog:function(e,t,n){if(r=window.setTimeout(t,5e3),null===o){var i=e.substr(0,e.indexOf("@")),a=APP.translation.generateTranslatonHTML("dialog.WaitingForHost"),s=APP.translation.generateTranslatonHTML("dialog.WaitForHostMsg",{room:i}),c=APP.translation.generateTranslatonHTML("dialog.IamHost"),l=[];l.push({title:c,value:"authNow"}),o=APP.UI.messageHandler.openDialog(a,s,!0,l,function(e,t){e.preventDefault(),"authNow"===t&&n()})}},closeAuthenticationWindow:function(){a&&(a.close(),a=null)},xmppAuthenticate:function(){var e=n.show(function(t,n){if(!n)return void e.close();if(n==APP.xmpp.Status.CONNECTED){e.close(),s.stopInterval(),s.closeAuthenticationDialog(),t.disconnect();var o=APP.UI.generateRoomName();i.allocateConferenceFocus(o,function(){APP.xmpp.getMUCJoined()||APP.UI.checkForNicknameAndJoin()})}},!0)},focusAuthenticationWindow:function(){return a?void a.focus():void 0},closeAuthenticationDialog:function(){o&&(o.close(),o=null)},createAuthenticationWindow:function(e,t){return a=APP.UI.messageHandler.openCenteredPopup(t,910,660,function(){s.closeAuthenticationDialog(),e(),a=null})},stopInterval:function(){r&&(window.clearTimeout(r),r=null)}};t.exports=s},{"../../xmpp/moderator":55,"./LoginDialog":13}],13:[function(e,t){function n(e,t){var n=this,r=!1,a=APP.xmpp.createConnection(),s='<h2 data-i18n="dialog.passwordRequired">';s+=APP.translation.translateString("dialog.passwordRequired"),s+='</h2><input name="username" type="text" placeholder="user@domain.net" autofocus><input name="password" type="password" data-i18n="[placeholder]dialog.userPassword" placeholder="user password">';var c=APP.translation.generateTranslatonHTML("dialog.Ok"),l=APP.translation.generateTranslatonHTML("dialog.Cancel"),u={login:{html:s,buttons:[{title:c,value:!0},{title:l,value:!1}],focus:":input:first",submit:function(t,n,i,o){if(t.preventDefault(),n){var s=o.username,c=o.password;s&&c&&(r=!1,a.reset(),d.goToState("connecting"),a.connect(s,c,p))}else r=!0,e()}},connecting:{title:APP.translation.translateString("dialog.connecting"),html:'<div id="connectionStatus"></div>',buttons:[],defaultButton:0},finished:{title:APP.translation.translateString("dialog.error"),html:'<div id="errorMessage"></div>',buttons:[{title:APP.translation.translateString("dialog.retry"),value:"retry"},{title:APP.translation.translateString("dialog.Cancel"),value:"cancel"}],defaultButton:0,submit:function(t,n){t.preventDefault(),"retry"===n?d.goToState("login"):e()}}},d=APP.UI.messageHandler.openDialogWithStates(u,{persistent:!0,closeText:""},null),p=function(s,c){if(!r){var l="connection."+i.getStatusString(s),u=APP.translation.translateString(l),p=d.getState("connecting").find("#connectionStatus");switch(p.text(u),s){case i.Status.CONNECTED:if(r=!0,!t)return void e(a,s);p.text(APP.translation.translateString("connection.FETCH_SESSION_ID"));var f=APP.UI.generateRoomName();a.sendIQ(o.createConferenceIq(f),function(t){p.text(APP.translation.translateString("connection.GOT_SESSION_ID")),r=!0,o.parseSessionId(t),e(a,s)},function(e){console.error("Auth on the fly failed",e),r=!0;var t=APP.translation.translateString("connection.GET_SESSION_ID_ERROR")+$(e).find(">error").attr("code");n.displayError(t),a.disconnect()});break;case i.Status.AUTHFAIL:case i.Status.CONNFAIL:case i.Status.DISCONNECTED:r=!0,e(a,s);var h=u;c&&(h+=": "+c),n.displayError(h)}}};this.displayError=function(e){var t=d.getState("finished"),n=t.find("#errorMessage");n.text(e),d.goToState("finished")},this.close=function(){r=!0,d.close()}}var i=e("../../xmpp/xmpp"),o=e("../../xmpp/moderator"),r={show:function(e,t){return new n(e,t)}};t.exports=r},{"../../xmpp/moderator":55,"../../xmpp/xmpp":63}],14:[function(e,t){function n(e,t){e&&e.length>0&&e.css("visibility",t?"visible":"hidden")}function i(t){if(t&&t!=APP.xmpp.myJid()){var n=Strophe.getResourceFromJid(t);if(!e("../videolayout/VideoLayout").isInLastN(n))return!0}if(t&&t==APP.xmpp.myJid()){var i=APP.RTC.localVideo;return!i||i.isMuted()}return APP.RTC.remoteStreams[t]&&APP.RTC.remoteStreams[t][s.VIDEO_TYPE]?APP.RTC.remoteStreams[t][s.VIDEO_TYPE].muted:null}function o(e,t){return e!==APP.xmpp.myJid()&&e||(e=a.getSettings().uid),"https://www.gravatar.com/avatar/"+MD5.hexdigest(e.trim().toLowerCase())+"?d=wavatar&size="+(t||"30")}var r,a=e("../../settings/Settings"),s=e("../../../service/RTC/MediaStreamTypes"),c={},l={setUserAvatar:function(e,t){if(t){if(c[e]===t)return;c[e]=t}var n=o(c[e]||e,100),i=o(c[e]||e),a=Strophe.getResourceFromJid(e),s=$("#participant_"+a),l=$("#avatar_"+a);e===APP.xmpp.myJid()&&($("#avatar").get(0).src=n,s=$("#localVideoContainer"));var u=$("#"+a+">img");u&&u.length>0&&(u.get(0).src=i),l&&l.length>0?l[0].src=n:s&&s.length>0&&(l=document.createElement("img"),l.id="avatar_"+a,l.className="userAvatar",l.src=n,s.append(l)),e===r&&this.updateActiveSpeakerAvatarSrc(e)},showUserAvatar:function(t,o){if(c[t]){var a=Strophe.getResourceFromJid(t),s=$("#participant_"+a+">video"),l=$("#avatar_"+a);t===APP.xmpp.myJid()&&(s=$("#localVideoWrapper>video")),(void 0===o||null===o)&&(o=i(t)),r===t&&e("../videolayout/VideoLayout").isLargeVideoOnTop()?(n($("#largeVideo"),!o),n($("#activeSpeaker"),o),n(l,!1),n(s,!1)):(s&&s.length>0&&n(s,!o),n(l,o))}},updateActiveSpeakerAvatarSrc:function(t){t||(t=APP.xmpp.findJidFromResource(e("../videolayout/VideoLayout").getLargeVideoState().userResourceJid));var a=$("#activeSpeakerAvatar")[0],s=o(c[t],interfaceConfig.ACTIVE_SPEAKER_AVATAR_SIZE);if(t!==r||a.src!==s){r=t;var u=i(t);t&&null!==u&&(a.src=s,n($("#largeVideo"),!u),l.showUserAvatar(t,u))}}};t.exports=l},{"../../../service/RTC/MediaStreamTypes":64,"../../settings/Settings":40,"../videolayout/VideoLayout":33}],15:[function(e,t){function n(){if($("#etherpad>iframe").length){var e=$("#remoteVideos"),t=window.innerHeight-e.outerHeight(),n=l.getAvailableVideoWidth();$("#etherpad>iframe").width(n),$("#etherpad>iframe").height(t)}}function i(){APP.xmpp.addToPresence("etherpad",u)}function o(){$("#etherpadButton").is(":visible")||$("#etherpadButton").css({display:"inline-block"})}function r(){d=document.createElement("iframe"),d.src=p+u+f,d.frameBorder=0,d.scrolling="no",d.width=$("#largeVideoContainer").width()||640,d.height=$("#largeVideoContainer").height()||480,d.setAttribute("style","visibility: hidden;"),document.getElementById("etherpad").appendChild(d),d.onload=function(){document.domain=document.domain,a(d),setTimeout(function(){var e=d.contentDocument.getElementsByName("ace_outer")[0];a(e);var t=e.contentDocument.getElementsByName("ace_inner")[0];a(t)},2e3)}}function a(e){var t=e.contentWindow.onmousemove;e.contentWindow.onmousemove=function(n){t&&t(n);var i=document.createEvent("MouseEvents"),o=e.getBoundingClientRect();i.initMouseEvent("mousemove",!0,!1,window,n.detail,n.screenX,n.screenY,n.clientX+o.left,n.clientY+o.top,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,null),e.dispatchEvent(i)}}var s=e("../videolayout/VideoLayout"),c=e("../prezi/Prezi"),l=e("../util/UIUtil"),u=null,d=null,p=null,f="?showControls=true&showChat=false&showLineNumbers=true&useMonospaceFont=false";$(document).bind("video.selected",function(e,t){config.etherpad_base&&d&&"hidden"!==d.style.visibility&&h.toggleEtherpad(t)});var h={init:function(e){config.etherpad_base&&!u&&(p=config.etherpad_base,e?u=e:(u=Math.random().toString(36).substring(7)+"_"+(new Date).getTime().toString(),i()),o(),$(window).resize(function(){n()}))},toggleEtherpad:function(e){d||r();var t=null;t=$(c.isPresentationVisible()?"#presentation>iframe":"#largeVideo"),"hidden"===$("#etherpad>iframe").css("visibility")?($("#activeSpeaker").css("visibility","hidden"),t.fadeOut(300,function(){c.isPresentationVisible()?t.css({opacity:"0"}):s.setLargeVideoVisible(!1)}),$("#etherpad>iframe").fadeIn(300,function(){document.body.style.background="#eeeeee",$("#etherpad>iframe").css({visibility:"visible"}),$("#etherpad").css({zIndex:2})})):$("#etherpad>iframe")&&($("#etherpad>iframe").fadeOut(300,function(){$("#etherpad>iframe").css({visibility:"hidden"}),$("#etherpad").css({zIndex:0}),document.body.style.background="black"}),e||$("#largeVideo").fadeIn(300,function(){s.setLargeVideoVisible(!0)})),n()},isVisible:function(){var e=$("#etherpad>iframe");return e&&e.is(":visible")}};t.exports=h},{"../prezi/Prezi":16,"../util/UIUtil":31,"../videolayout/VideoLayout":33}],16:[function(e,t){function n(e,t,n,i){console.log("presentation added",n);var o=r(n),c="participant_"+Strophe.getResourceFromJid(t)+"_"+o;p.addRemoteVideoContainer(null,c),p.resizeThumbnails();var u=!1;t===APP.xmpp.myJid()&&(u=!0),l(!0),$("#largeVideoContainer").hover(function(){if(g.isPresentationVisible()){var e=window.innerWidth-$("#presentation>iframe").offset().left-$("#presentation>iframe").width();$("#reloadPresentation").css({right:e,display:"inline-block"})}},function(e){if(g.isPresentationVisible()){var t=e.toElement||e.relatedTarget;t&&"reloadPresentation"!=t.id&&"header"!=t.id&&$("#reloadPresentation").css({display:"none"})}else $("#reloadPresentation").css({display:"none"})}),m=new h("presentation",{preziId:o,width:a(),height:s(),controls:u,debug:!0}),$("#presentation>iframe").attr("id",m.options.preziId),m.on(h.EVENT_STATUS,function(e){console.log("prezi status",e.value),e.value==h.STATUS_CONTENT_READY&&t!=APP.xmpp.myJid()&&m.flyToStep(i)}),m.on(h.EVENT_CURRENT_STEP,function(e){console.log("event value",e.value),APP.xmpp.addToPresence("preziSlide",e.value)}),$("#"+c).css("background-image","url(../images/avatarprezi.png)"),$("#"+c).click(function(){l(!0)})}function i(e,t,n){console.log("presentation removed",n);var i=r(n);l(!1),$("#participant_"+Strophe.getResourceFromJid(t)+"_"+i).remove(),$("#presentation>iframe").remove(),null!=m&&(m.destroy(),m=null)}function o(e){var t=/^[a-z0-9-_\/&\?=;]+$/i;return t.test(e)}function r(e){var t=e.substring(e.indexOf("prezi.com/")+10);return t.substring(0,t.indexOf("/"))}function a(){var e=d.getAvailableVideoWidth(),t=s(),n=16/9;return e/n>t&&(e=Math.floor(t*n)),e}function s(){var e=$("#remoteVideos");return window.innerHeight-e.outerHeight()}function c(){$("#presentation>iframe")&&($("#presentation>iframe").width(a()),$("#presentation>iframe").height(s()))}function l(e){var t=$("#presentation>iframe");e?($(document).trigger("video.selected",[!0]),$("#largeVideo").fadeOut(300),t.fadeIn(300,function(){t.css({opacity:"1"}),u.dockToolbar(!0),p.setLargeVideoVisible(!1)}),$("#activeSpeaker").css("visibility","hidden")):"1"==t.css("opacity")&&t.fadeOut(300,function(){t.css({opacity:"0"}),$("#reloadPresentation").css({display:"none"}),$("#largeVideo").fadeIn(300,function(){p.setLargeVideoVisible(!0),u.dockToolbar(!1)})})}var u=e("../toolbars/ToolbarToggler"),d=e("../util/UIUtil"),p=e("../videolayout/VideoLayout"),f=e("../util/MessageHandler"),h=e("./PreziPlayer"),m=null,g={reloadPresentation:function(){var e=document.getElementById(m.options.preziId);e.src=e.src},isPresentationVisible:function(){return null!=$("#presentation>iframe")&&1==$("#presentation>iframe").css("opacity")},openPreziDialog:function(){var e=APP.xmpp.getPrezi();if(e)f.openTwoButtonDialog("dialog.removePreziTitle",null,"dialog.removePreziMsg",null,!1,"dialog.Remove",function(e,t){t&&APP.xmpp.removePreziFromPresence()});else if(null!=m)f.openTwoButtonDialog("dialog.sharePreziTitle",null,"dialog.sharePreziMsg",null,!1,"dialog.Ok",function(){$.prompt.close()});else{var t=APP.translation.generateTranslatonHTML("dialog.sharePreziTitle"),n=APP.translation.generateTranslatonHTML("dialog.Cancel"),i=APP.translation.generateTranslatonHTML("dialog.Share"),r=APP.translation.generateTranslatonHTML("dialog.Back"),a=[],s=[];a.push({title:n,value:!1}),s.push({title:n,value:!1}),a.push({title:i,value:!0}),s.push({title:r,value:!0});var c=APP.translation.generateTranslatonHTML("dialog.preziLinkError"),l=APP.translation.translateString("defaultPreziLink",{url:"http://prezi.com/wz7vhjycl7e6/my-prezi"}),u={state0:{html:"<h2>"+t+'</h2><input name="preziUrl" type="text" data-i18n="[placeholder]defaultPreziLink" data-i18n-options=\''+JSON.stringify({url:"http://prezi.com/wz7vhjycl7e6/my-prezi"})+"' placeholder=\""+l+'" autofocus>',persistent:!1,buttons:a,focus:":input:first",defaultButton:0,submit:function(e,t,n,i){if(e.preventDefault(),t){var r=i.preziUrl;if(r){var a=encodeURI(d.escapeHtml(r));if(0!=a.indexOf("http://prezi.com/")&&0!=a.indexOf("https://prezi.com/"))return $.prompt.goToState("state1"),!1;var s=a.substring(a.indexOf("prezi.com/")+10);if(!o(s)||s.indexOf("/")<2)return $.prompt.goToState("state1"),!1;APP.xmpp.addToPresence("prezi",a),$.prompt.close()}}else $.prompt.close()}},state1:{html:"<h2>"+t+"</h2>"+c,persistent:!1,buttons:s,focus:":input:first",defaultButton:1,submit:function(e,t){e.preventDefault(),0===t?$.prompt.close():$.prompt.goToState("state0")}}};f.openDialogWithStates(u)}}};$(document).bind("presentationremoved.muc",i),$(document).bind("presentationadded.muc",n),$(document).bind("gotoslide.muc",function(e,t,n,i){if(m&&m.getCurrentStep()!=i){m.flyToStep(i);for(var o=m.getAnimationCountOnSteps(),r=0;r<parseInt(o[i]);r++)m.flyToStep(i,r)}}),$(document).bind("video.selected",function(e,t){!t&&$("#presentation>iframe")&&l(!1)}),$(window).resize(function(){c()}),t.exports=g},{"../toolbars/ToolbarToggler":27,"../util/MessageHandler":29,"../util/UIUtil":31,"../videolayout/VideoLayout":33,"./PreziPlayer":17}],17:[function(e,t){!function(){"use strict";var e=function(e,t){return function(){return e.apply(t,arguments)}};window.PreziPlayer=function(){function t(n,i){var o,r="",a=this;t.players[n]&&t.players[n].destroy();for(var s=0;s<t.binded_methods.length;s++){var c=t.binded_methods[s];a[c]=e(a[c],a)}if(i=i||{},this.options=i,this.values={status:t.STATUS_LOADING},this.values[t.CURRENT_STEP]=0,this.values[t.CURRENT_ANIMATION_STEP]=0,this.values[t.CURRENT_OBJECT]=null,this.callbacks=[],this.id=n,this.embedTo=document.getElementById(n),!this.embedTo)throw"The element id is not available.";this.iframe=document.createElement("iframe"),o=[{name:"oid",value:i.preziId},{name:"explorable",value:i.explorable?1:0},{name:"controls",value:i.controls?1:0}];for(var s=0;s<o.length;s++){var l=o[s];r+=(0===s?"?":"&")+l.name+"="+l.value}this.iframe.src=t.domain+t.path+r,this.iframe.frameBorder=0,this.iframe.scrolling="no",this.iframe.width=i.width||640,this.iframe.height=i.height||480,this.embedTo.innerHTML="";try{this.embedTo.appendChild(this.iframe)}catch(u){console.log("CATCH ERROR")}this.initPollInterval=setInterval(function(){a.sendMessage({action:"init"})},500),t.players[n]=this}return t.API_VERSION=1,t.CURRENT_STEP="currentStep",t.CURRENT_ANIMATION_STEP="currentAnimationStep",t.CURRENT_OBJECT="currentObject",t.STATUS_LOADING="loading",t.STATUS_READY="ready",t.STATUS_CONTENT_READY="contentready",t.EVENT_CURRENT_STEP="currentStepChange",t.EVENT_CURRENT_ANIMATION_STEP="currentAnimationStepChange",t.EVENT_CURRENT_OBJECT="currentObjectChange",t.EVENT_STATUS="statusChange",t.EVENT_PLAYING="isAutoPlayingChange",t.EVENT_IS_MOVING="isMovingChange",t.domain="https://prezi.com",t.path="/player/",t.players={},t.binded_methods=["changesHandler"],t.createMultiplePlayers=function(e){for(var n=0;n<e.length;n++){var i=e[n];new t(i.id,i)}},t.messageReceived=function(e){var n,i,o;try{if(n=JSON.parse(e.data),n.id&&(o=t.players[n.id])){o.options.debug===!0&&console&&console.log&&console.log("received",n),"changes"===n.type&&o.changesHandler(n);for(var r=0;r<o.callbacks.length;r++)i=o.callbacks[r],i&&n.type===i.event&&i.callback(n)}}catch(a){}},t.prototype.changesHandler=function(e){var t,n,i,o;this.initPollInterval&&(clearInterval(this.initPollInterval),this.initPollInterval=!1);for(t in e.data)if(e.data.hasOwnProperty(t))for(n=e.data[t],this.values[t]=n,i=0;i<this.callbacks.length;i++)o=this.callbacks[i],o&&o.event===t+"Change"&&o.callback({type:o.event,value:n})},t.prototype.destroy=function(){this.initPollInterval&&(clearInterval(this.initPollInterval),this.initPollInterval=!1),this.embedTo.innerHTML=""},t.prototype.sendMessage=function(e){return this.options.debug===!0&&console&&console.log&&console.log("sent",e),e.version=t.API_VERSION,e.id=this.id,this.iframe.contentWindow.postMessage(JSON.stringify(e),"*")},t.prototype.nextStep=t.prototype.flyToNextStep=function(){return this.sendMessage({action:"present",data:["moveToNextStep"]})},t.prototype.previousStep=t.prototype.flyToPreviousStep=function(){return this.sendMessage({action:"present",data:["moveToPrevStep"]})},t.prototype.toStep=t.prototype.flyToStep=function(e,t){function n(){if(1==i.values.isMoving)return void setTimeout(n,100);for(;t-->0;)i.flyToNextStep()}var i=this;return t>0&&i.values.animationCountOnSteps&&i.values.animationCountOnSteps[e]<=t&&(t=i.values.animationCountOnSteps[e]),setTimeout(n,200),this.sendMessage({action:"present",data:["moveToStep",e]})},t.prototype.toObject=t.prototype.flyToObject=function(e){return this.sendMessage({action:"present",data:["moveToObject",e]})},t.prototype.play=function(e){return this.sendMessage({action:"present",data:["startAutoPlay",e]})},t.prototype.stop=function(){return this.sendMessage({action:"present",data:["stopAutoPlay"]})},t.prototype.pause=function(e){return this.sendMessage({action:"present",data:["pauseAutoPlay",e]})},t.prototype.getCurrentStep=function(){return this.values.currentStep},t.prototype.getCurrentAnimationStep=function(){return this.values.currentAnimationStep},t.prototype.getCurrentObject=function(){return this.values.currentObject},t.prototype.getStatus=function(){return this.values.status},t.prototype.isPlaying=function(){return this.values.isAutoPlaying},t.prototype.getStepCount=function(){return this.values.stepCount},t.prototype.getAnimationCountOnSteps=function(){return this.values.animationCountOnSteps},t.prototype.getTitle=function(){return this.values.title},t.prototype.setDimensions=function(e){for(var t in e)this.iframe[t]=e[t]},t.prototype.getDimensions=function(){return{width:parseInt(this.iframe.width,10),height:parseInt(this.iframe.height,10)}},t.prototype.on=function(e,t){this.callbacks.push({event:e,callback:t})},t.prototype.off=function(e,t){var n,i;for(void 0===e&&(this.callbacks=[]),n=this.callbacks.length;n--;)i=this.callbacks[n],!i||i.event!==e||void 0!==t&&i.callback!==t||this.callbacks.splice(n,1)},window.addEventListener?window.addEventListener("message",t.messageReceived,!1):window.attachEvent("onmessage",t.messageReceived),t}()}(),t.exports=PreziPlayer},{}],18:[function(e,t){var n=e("./chat/Chat"),i=e("./contactlist/ContactList"),o=e("./../../settings/Settings"),r=e("./settings/SettingsMenu"),a=e("../videolayout/VideoLayout"),s=e("../toolbars/ToolbarToggler"),c=e("../util/UIUtil"),l=function(e){var t=null,u={"#chatspace":"#chatBottomButton","#contactlist":"#contactListButton","#settingsmenu":"#settingsButton"},d=function(e,t){var n=$("#videospace"),i=e?[0,0]:l.getPanelSize(),o=window.innerWidth-i[0],r=window.innerHeight,s=a.getVideoSize(null,null,o,r),c=s[0],u=s[1],d=a.getVideoPosition(c,u,o,r),p=d[0],f=d[1],h=a.calculateThumbnailSize(o),m=h[0],g=h[1];n.animate({right:i[0],width:o,height:r},{queue:!1,duration:500,complete:t}),$("#remoteVideos").animate({height:g},{queue:!1,duration:500}),$("#remoteVideos>span").animate({height:g,width:m},{queue:!1,duration:500,complete:function(){$(document).trigger("remotevideo.resized",[m,g])}}),$("#largeVideoContainer").animate({width:o,height:r},{queue:!1,duration:500}),$("#largeVideo").animate({width:c,height:u,top:f,bottom:f,left:p,right:p},{queue:!1,duration:500})},p=function(e,n,i,o,r){if(c.buttonClick(u[n],"active"),e.isVisible())$("#toast-container").animate({right:"5px"},{queue:!1,duration:500}),$(n).hide("slide",{direction:"right",queue:!1,duration:500}),"function"==typeof r&&r(),t=null;else{if(a.isLargeVideoVisible()&&s.dockToolbar(!1),t){var d=$(t);c.buttonClick(u[t],"active"),d.css("z-index",4),setTimeout(function(){d.css("display","none"),d.css("z-index",5)},500)}$("#toast-container").animate({right:l.getPanelSize()[0]+5+"px"},{queue:!1,duration:500}),$(n).show("slide",{direction:"right",queue:!1,duration:500,complete:i}),"function"==typeof o&&o(),t=n}};return e.toggleChat=function(){var e=n.isVisible()?function(){}:function(){n.scrollChatToBottom(),$("#chatspace").trigger("shown")};d(n.isVisible(),e),p(n,"#chatspace",function(){"visible"===$("#nickname").css("visibility")?$("#nickinput").focus():$("#usermsg").focus()},null,n.resizeChat,null)},e.toggleContactList=function(){var e=i.isVisible()?function(){}:function(){$("#contactlist").trigger("shown")};d(i.isVisible(),e),p(i,"#contactlist",null,function(){i.setVisualNotification(!1)},null)},e.toggleSettingsMenu=function(){d(r.isVisible(),function(){}),p(r,"#settingsmenu",null,function(){var e=o.getSettings();$("#setDisplayName").get(0).value=e.displayName,$("#setEmail").get(0).value=e.email},null)},e.getPanelSize=function(){var e=window.innerHeight,t=window.innerWidth,n=200;return 200>.2*t&&(n=.2*t),[n,e]},e.isVisible=function(){return n.isVisible()||i.isVisible()||r.isVisible()},e}(l||{});t.exports=l},{"../toolbars/ToolbarToggler":27,"../util/UIUtil":31,"../videolayout/VideoLayout":33,"./../../settings/Settings":40,"./chat/Chat":19,"./contactlist/ContactList":23,"./settings/SettingsMenu":24}],19:[function(e,t){function n(e){var t=document.getElementById("unreadMessages"),n=document.getElementById("bottomUnreadMessages"),i=$("#chatButton"),o=$("#chatBottomButton");if(g){t.innerHTML=g.toString(),n.innerHTML=g.toString(),u.dockToolbar(!0);var r=document.getElementById("chatButton").parentNode,a=(f.getTextWidth(r)-f.getTextWidth(t))/2,s=(f.getTextHeight(r)-f.getTextHeight(t))/2-3;t.setAttribute("style","top:"+s+"; left:"+a+";");var c=document.getElementById("chatBottomButton").parentNode,l=(f.getTextWidth(c)-f.getTextWidth(n))/2,d=(f.getTextHeight(c)-f.getTextHeight(n))/2-2;n.setAttribute("style","top:"+d+"; left:"+l+";"),i.hasClass("icon-chat-simple")||(i.removeClass("icon-chat"),i.addClass("icon-chat-simple"))}else t.innerHTML="",n.innerHTML="",i.removeClass("icon-chat-simple"),i.addClass("icon-chat");e&&!m?m=window.setInterval(function(){i.toggleClass("active"),o.toggleClass("active glowing")},800):!e&&m&&(window.clearInterval(m),m=!1,i.removeClass("active"),o.removeClass("glowing"),o.addClass("active"))}function i(){var e=new Date,t=e.getHours(),n=e.getMinutes(),i=e.getSeconds();return 1===t.toString().length&&(t="0"+t),1===n.toString().length&&(n="0"+n),1===i.toString().length&&(i="0"+i),t+":"+n+":"+i}function o(){var e=$("#smileysContainer");e.is(":visible")?e.hide("slide",{direction:"down",duration:300}):e.show("slide",{direction:"down",duration:300}),$("#usermsg").focus()}function r(e,t){e.onclick=function(){var e=$("#usermsg"),n=e.val();n+=d["smiley"+t],e.val(n),e.get(0).setSelectionRange(n.length,n.length),o(),e.focus()}}function a(){var e=document.createElement("div");e.id="smileysContainer";for(var t=1;21>=t;t++){var n=document.createElement("div");n.id="smiley"+t,n.className="smileyContainer";var i=document.createElement("img");i.src="images/smileys/smiley"+t+".svg",i.className="smiley",r(i,t),n.appendChild(i),e.appendChild(n)}$("#chatspace").append(e)}function s(){var e=$("#usermsg").outerHeight(),t=$("#chatspace"),n=t.width(),i=$("#chatconversation"),o=$("#smileysarea");o.height(e),$("#smileys").css("bottom",(e-26)/2),$("#smileysContainer").css("bottom",e),i.width(n-10),i.height(window.innerHeight-15-e)}var c=e("./Replacement"),l=e("./Commands"),u=e("../../toolbars/ToolbarToggler"),d=e("./smileys.json").smileys,p=e("../../util/NicknameHandler"),f=e("../../util/UIUtil"),h=e("../../../../service/UI/UIEvents"),m=!1,g=0,v=function(t){return t.init=function(){p.getNickname()&&v.setChatConversationMode(!0),p.addListener(h.NICKNAME_CHANGED,function(){v.setChatConversationMode(!0)}),$("#nickinput").keydown(function(e){if(13===e.keyCode){e.preventDefault();var t=f.escapeHtml(this.value);if(this.value="",!p.getNickname())return void p.setNickname(t)}}),$("#usermsg").keydown(function(e){if(13===e.keyCode){e.preventDefault();var t=this.value;$("#usermsg").val("").trigger("autosize.resize"),this.focus();var n=new l(t);if(n.isCommand())n.processCommand();else{var i=f.escapeHtml(t);APP.xmpp.sendChatMessage(i,p.getNickname())}}});var e=function(){s(),v.scrollChatToBottom()};$("#usermsg").autosize({callback:e}),$("#chatspace").bind("shown",function(){g=0,n(!1)}),a()},t.updateChatConversation=function(e,t,o){var r="";APP.xmpp.myJid()===e?r="localuser":(r="remoteuser",v.isVisible()||(g++,f.playSoundNotification("chatNotification"),n(!0)));var a=o.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"),s=f.escapeHtml(t);o=c.processReplacements(a);var l='<div class="chatmessage"><img src="../images/chatArrow.svg" class="chatArrow"><div class="username '+r+'">'+s+'</div><div class="timestamp">'+i()+'</div><div class="usermessage">'+o+"</div></div>";$("#chatconversation").append(l),$("#chatconversation").animate({scrollTop:$("#chatconversation")[0].scrollHeight},1e3)},t.chatAddError=function(e,t){e=f.escapeHtml(e),t=f.escapeHtml(t),$("#chatconversation").append('<div class="errorMessage"><b>Error: </b>Your message'+(t?' "'+t+'"':"")+" was not sent."+(e?" Reason: "+e:"")+"</div>"),$("#chatconversation").animate({scrollTop:$("#chatconversation")[0].scrollHeight},1e3)},t.chatSetSubject=function(e){e&&(e=e.trim()),$("#subject").html(c.linkify(f.escapeHtml(e))),$("#subject").css(""===e?{display:"none"}:{display:"block"})},t.setChatConversationMode=function(e){e&&($("#nickname").css({visibility:"hidden"}),$("#chatconversation").css({visibility:"visible"}),$("#usermsg").css({visibility:"visible"}),$("#smileysarea").css({visibility:"visible"}),$("#usermsg").focus())
},t.resizeChat=function(){var t=e("../SidePanelToggler").getPanelSize();$("#chatspace").width(t[0]),$("#chatspace").height(t[1]),s()},t.isVisible=function(){return $("#chatspace").is(":visible")},t.toggleSmileys=o,t.scrollChatToBottom=function(){setTimeout(function(){$("#chatconversation").scrollTop($("#chatconversation")[0].scrollHeight)},5)},t}(v||{});t.exports=v},{"../../../../service/UI/UIEvents":69,"../../toolbars/ToolbarToggler":27,"../../util/NicknameHandler":30,"../../util/UIUtil":31,"../SidePanelToggler":18,"./Commands":20,"./Replacement":21,"./smileys.json":22}],20:[function(e,t){function n(e){if(e)for(var t in a)if(0==e.indexOf("/"+t))return t;return""}function i(e){var t=r.escapeHtml(e);APP.xmpp.setSubject(t)}function o(e){var t=n(e);this.getCommand=function(){return t};var i=e.substr(t.length+2);this.getArgument=function(){return i}}var r=e("../../util/UIUtil"),a={topic:i};o.prototype.isCommand=function(){return this.getCommand()?!0:!1},o.prototype.processCommand=function(){this.isCommand()&&a[this.getCommand()](this.getArgument())},t.exports=o},{"../../util/UIUtil":31}],21:[function(e,t){function n(e){return e=i(e),e=o(e)}function i(e){var t,n,i,o;return n=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,t=e.replace(n,'<a href="$1" target="_blank">$1</a>'),i=/(^|[^\/])(www\.[\S]+(\b|$))/gim,t=t.replace(i,'$1<a href="http://$2" target="_blank">$2</a>'),o=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,t=t.replace(o,'<a href="mailto:$1">$1</a>')}function o(e){if(!e)return e;var t=r.regexs;for(var n in t)t.hasOwnProperty(n)&&(e=e.replace(t[n],'<img class="smiley" src="images/smileys/'+n+'.svg">'));return e}var r=e("./smileys.json");t.exports={processReplacements:n,linkify:i}},{"./smileys.json":22}],22:[function(e,t){t.exports={smileys:{smiley1:":)",smiley2:":(",smiley3:":D",smiley4:"(y)",smiley5:" :P",smiley6:"(wave)",smiley7:"(blush)",smiley8:"(chuckle)",smiley9:"(shocked)",smiley10:":*",smiley11:"(n)",smiley12:"(search)",smiley13:" <3",smiley14:"(oops)",smiley15:"(angry)",smiley16:"(angel)",smiley17:"(sick)",smiley18:";(",smiley19:"(bomb)",smiley20:"(clap)",smiley21:" ;)"},regexs:{smiley2:/(:-\(\(|:-\(|:\(\(|:\(|\(sad\))/gi,smiley3:/(:-\)\)|:\)\)|\(lol\)|:-D|:D)/gi,smiley1:/(:-\)|:\))/gi,smiley4:/(\(y\)|\(Y\)|\(ok\))/gi,smiley5:/(:-P|:P|:-p|:p)/gi,smiley6:/(\(wave\))/gi,smiley7:/(\(blush\))/gi,smiley8:/(\(chuckle\))/gi,smiley9:/(:-0|\(shocked\))/gi,smiley10:/(:-\*|:\*|\(kiss\))/gi,smiley11:/(\(n\))/gi,smiley12:/(\(search\))/g,smiley13:/(<3|&lt;3|&amp;lt;3|\(L\)|\(l\)|\(H\)|\(h\))/gi,smiley14:/(\(oops\))/gi,smiley15:/(\(angry\))/gi,smiley16:/(\(angel\))/gi,smiley17:/(\(sick\))/gi,smiley18:/(;-\(\(|;\(\(|;-\(|;\(|:"\(|:"-\(|:~-\(|:~\(|\(upset\))/gi,smiley19:/(\(bomb\))/gi,smiley20:/(\(clap\))/gi,smiley21:/(;-\)|;\)|;-\)\)|;\)\)|;-D|;D|\(wink\))/gi}}},{}],23:[function(e,t){function n(e){0===s?($("#numberOfParticipants").text(""),s+=e):0===s||c.isVisible()||(c.setVisualNotification(!0),s+=e,$("#numberOfParticipants").text(s))}function i(e){var t=document.createElement("img");return t.className="icon-avatar avatar",t.src="https://www.gravatar.com/avatar/"+e+"?d=wavatar&size=30",t}function o(e,t){var n=document.createElement("p");return t?n.innerText=t:e&&(n.setAttribute("data-i18n",e),n.innerText=APP.translation.translateString(e)),n}function r(e){window.clearInterval(a),a=!1,e.removeClass("glowing"),c.isVisible()||e.removeClass("active")}var a,s=0,c={isVisible:function(){return $("#contactlist").is(":visible")},ensureAddContact:function(e,t){var n=Strophe.getResourceFromJid(e),i=$('#contactlist>ul>li[id="'+n+'"]');(!i||i.length<=0)&&c.addContact(e,t)},addContact:function(e,t){var r=Strophe.getResourceFromJid(e),a=$("#contactlist>ul"),s=document.createElement("li");s.id=r,s.className="clickable",s.onclick=function(t){"clickable"===t.currentTarget.className&&$(c).trigger("contactclicked",[e])},s.appendChild(i(t)),s.appendChild(o("participant"));var l=a.get(0);r===APP.xmpp.myResource()&&$("#contactlist>ul .title")[0].nextSibling.nextSibling?l.insertBefore(s,$("#contactlist>ul .title")[0].nextSibling.nextSibling):l.appendChild(s),n(1)},removeContact:function(e){var t=Strophe.getResourceFromJid(e),i=$('#contactlist>ul>li[id="'+t+'"]');if(i&&i.length>0){var o=$("#contactlist>ul");o.get(0).removeChild(i.get(0)),n(-1)}},setVisualNotification:function(e,t){var n=$("#contactListButton");e&&!a?a=window.setInterval(function(){n.toggleClass("active glowing")},800):!e&&a&&r(n),t&&setTimeout(function(){r(n)},t)},setClickable:function(e,t){var n=$('#contactlist>ul>li[id="'+e+'"]');t?n.addClass("clickable"):n.removeClass("clickable")},onDisplayNameChange:function(e,t){"localVideoContainer"===e&&(e=APP.xmpp.myJid());var n=Strophe.getResourceFromJid(e),i=$("#contactlist #"+n+">p");i&&t&&t.length>0&&i.html(t)}};t.exports=c},{}],24:[function(e,t){function n(){for(var e=APP.translation.getCurrentLanguage(),t='<select id="languages_selectbox">',n=a.getLanguages(),i=0;i<n.length;i++){var o=n[i];t+="<option ",o===e&&(t+="selected "),t+='value="'+o+"\" data-i18n='languages:"+o+"'>",t+="</option>"}return t+"</select>"}var i=e("../../avatar/Avatar"),o=e("./../../../settings/Settings"),r=e("../../util/UIUtil"),a=e("../../../../service/translation/languages"),s={init:function(){$("#startMutedOptions").before(n()),APP.translation.translateElement($("#languages_selectbox")),$("#settingsmenu>input").keyup(function(e){13===e.keyCode&&s.update()}),APP.xmpp.isModerator()?$("#startMutedOptions").css("display","block"):$("#startMutedOptions").css("display","none"),$("#updateSettings").click(function(){s.update()})},onRoleChanged:function(){APP.xmpp.isModerator()?$("#startMutedOptions").css("display","block"):$("#startMutedOptions").css("display","none")},setStartMuted:function(e,t){$("#startAudioMuted").attr("checked",e),$("#startVideoMuted").attr("checked",t)},update:function(){var e=r.escapeHtml($("#setDisplayName").get(0).value),t=r.escapeHtml($("#setEmail").get(0).value);if(e){var n=o.setDisplayName(e);APP.xmpp.addToPresence("displayName",n,!0)}var a=$("#languages_selectbox").val();APP.translation.setLanguage(a),o.setLanguage(a),APP.xmpp.addToPresence("email",t);var s=o.setEmail(t),c=$("#startAudioMuted").is(":checked"),l=$("#startVideoMuted").is(":checked");APP.xmpp.addToPresence("startMuted",[c,l]),i.setUserAvatar(APP.xmpp.myJid(),s)},isVisible:function(){return $("#settingsmenu").is(":visible")},setDisplayName:function(e){var t=o.setDisplayName(e);$("#setDisplayName").get(0).value=t},onDisplayNameChange:function(e,t){("localVideoContainer"===e||e===APP.xmpp.myJid())&&this.setDisplayName(t)}};t.exports=s},{"../../../../service/translation/languages":74,"../../avatar/Avatar":14,"../../util/UIUtil":31,"./../../../settings/Settings":40}],25:[function(e,t){var n=e("../side_pannels/SidePanelToggler"),i={bottom_toolbar_contact_list:function(){o.toggleContactList()},bottom_toolbar_film_strip:function(){o.toggleFilmStrip()},bottom_toolbar_chat:function(){o.toggleChat()}},o=function(e){return e.init=function(){for(var e in i)$("#"+e).click(i[e])},e.toggleChat=function(){n.toggleChat()},e.toggleContactList=function(){n.toggleContactList()},e.toggleFilmStrip=function(){var e=$("#remoteVideos");e.toggleClass("hidden")},$(document).bind("remotevideo.resized",function(e,t,n){var i=(n-$("#bottomToolbar").outerHeight())/2+18;$("#bottomToolbar").css({bottom:i+"px"})}),e}(o||{});t.exports=o},{"../side_pannels/SidePanelToggler":18}],26:[function(e,t){function n(){APP.xmpp.disposeConference(),config.enableWelcomePage&&setTimeout(function(){window.localStorage.welcomePageDisabled=!1,window.location.pathname="/"},1e4);var e=APP.translation.generateTranslatonHTML("dialog.sessTerminated"),t=APP.translation.generateTranslatonHTML("dialog.hungUp"),n=APP.translation.generateTranslatonHTML("dialog.joinAgain"),i=[];i.push({title:n,value:!0}),y.messageHandler.openDialog(e,t,!0,i,function(){return window.location.reload(),!1})}function i(){APP.xmpp.toggleRecording(function(e){var t=APP.translation.generateTranslatonHTML("dialog.recordingToken"),n=APP.translation.translateString("dialog.token");APP.UI.messageHandler.openTwoButtonDialog(null,null,null,"<h2>"+t+'</h2><input name="recordingToken" type="text"  data-i18n="[placeholder]dialog.token" placeholder="'+n+'" autofocus>',!1,"dialog.Save",function(t,n,i,o){if(n){var r=o.recordingToken;r&&e(h.escapeHtml(r))}},null,function(){},":input:first")},S.setRecordingButtonState,S.setRecordingButtonState)}function o(e){var t="";e&&(t=v),APP.xmpp.lockRoom(t,function(){v?(console.log("set room password"),S.lockLockButton()):(console.log("removed room password"),S.unlockLockButton())},function(e){console.warn("setting password failed",e),c.showError("dialog.lockTitle","dialog.lockMessage"),S.setSharedKey("")},function(){console.warn("room passwords not supported"),c.showError("dialog.warning","dialog.passwordNotSupported"),S.setSharedKey("")})}function r(){if(null!==g){var e="";v&&v.length>0&&(e=APP.translation.translateString("email.sharedKey",{sharedKey:v}),e=e.replace(/\n/g,"%0D%0A"));var t="Chromium, Google Chrome "+APP.translation.translateString("email.and")+" Opera",n=g.substring(g.lastIndexOf("/")+1),i=APP.translation.translateString("email.subject",{appName:interfaceConfig.APP_NAME,conferenceName:n}),o=APP.translation.translateString("email.body",{appName:interfaceConfig.APP_NAME,sharedKeyText:e,roomUrl:g,supportedBrowsers:t});o=o.replace(/\n/g,"%0D%0A"),window.localStorage.displayname&&(o+="%0D%0A%0D%0A"+window.localStorage.displayname),interfaceConfig.INVITATION_POWERED_BY&&(o+="%0D%0A%0D%0A--%0D%0Apowered by jitsi.org"),window.open("mailto:?subject="+i+"&body="+o,"_blank")}}function a(){}function s(){var e=config.defaultSipNumber?config.defaultSipNumber:"",t=APP.translation.generateTranslatonHTML("dialog.sipMsg");c.openTwoButtonDialog(null,null,null,"<h2>"+t+'</h2><input name="sipNumber" type="text" value="'+e+'" autofocus>',!1,"dialog.Dial",function(e,t,n,i){if(t){var o=i.sipNumber;o&&APP.xmpp.dial(o,"fromnumber",y.getRoomName(),v)}},null,null,":input:first")}var c=e("../util/MessageHandler"),l=e("./BottomToolbar"),u=e("../prezi/Prezi"),d=e("../etherpad/Etherpad"),p=e("../side_pannels/SidePanelToggler"),f=e("../authentication/Authentication"),h=e("../util/UIUtil"),m=e("../../../service/authentication/AuthenticationEvents"),g=null,v="",y=null,b={toolbar_button_mute:function(){return APP.UI.toggleAudio()},toolbar_button_camera:function(){return APP.UI.toggleVideo()},toolbar_button_record:function(){return i()},toolbar_button_security:function(){return S.openLockDialog()},toolbar_button_link:function(){return S.openLinkDialog()},toolbar_button_chat:function(){return l.toggleChat()},toolbar_button_prezi:function(){return u.openPreziDialog()},toolbar_button_etherpad:function(){return d.toggleEtherpad(0)},toolbar_button_desktopsharing:function(){return APP.desktopsharing.toggleScreenSharing()},toolbar_button_fullScreen:function(){return h.buttonClick("#fullScreen","icon-full-screen icon-exit-full-screen"),S.toggleFullScreen()},toolbar_button_sip:function(){return s()},toolbar_button_dialpad:function(){return a()},toolbar_button_settings:function(){p.toggleSettingsMenu()},toolbar_button_hangup:function(){return n()},toolbar_button_login:function(){S.authenticateClicked()},toolbar_button_logout:function(){c.openTwoButtonDialog("dialog.logoutTitle",null,"dialog.logoutQuestion",null,!1,"dialog.Yes",function(e,t){t&&APP.xmpp.logout(function(e){e?window.location.href=e:n()})})}},S=function(e){return e.init=function(e){for(var t in b)$("#"+t).click(b[t]);y=e,APP.xmpp.addListener(m.IDENTITY_UPDATED,function(e,t){var n=!1;t&&(n=!0),S.showAuthenticateButton(e),e&&(S.setAuthenticatedIdentity(t),S.showLoginButton(!n),S.showLogoutButton(n))})},e.setSharedKey=function(e){v=e},e.authenticateClicked=function(){return f.focusAuthenticationWindow(),APP.xmpp.isExternalAuthEnabled()?void(APP.xmpp.getMUCJoined()?APP.xmpp.getPopupLoginUrl(y.getRoomName(),function(e){var t=f.createAuthenticationWindow(function(){APP.xmpp.allocateConferenceFocus(APP.UI.getRoomName(),function(){console.info("AUTH DONE")})},e);t||c.openMessageDialog(null,"dialog.popupError")}):APP.xmpp.getLoginUrl(y.getRoomName(),function(e){window.location.href=e})):void f.xmppAuthenticate()},e.updateRoomUrl=function(e){g=e;var t=document.getElementById("inviteLinkRef");t&&(t.value=g,t.select(),$("#inviteLinkRef").parent().find("button[value=true]").prop("disabled",!1))},e.setupButtonsFromConfig=function(){config.disablePrezi&&$("#prezi_button").css({display:"none"})},e.openLockDialog=function(){if(APP.xmpp.isModerator())if(v)c.openTwoButtonDialog(null,null,"dialog.passwordCheck",null,!1,"dialog.Remove",function(e,t){t&&(S.setSharedKey(""),o(!1))});else{var e=APP.translation.generateTranslatonHTML("dialog.passwordMsg"),t=APP.translation.translateString("dialog.yourPassword");c.openTwoButtonDialog(null,null,null,"<h2>"+e+'</h2><input name="lockKey" type="text" data-i18n="[placeholder]dialog.yourPassword" placeholder="'+t+'" autofocus>',!1,"dialog.Save",function(e,t,n,i){if(t){var r=i.lockKey;r&&(S.setSharedKey(h.escapeHtml(r)),o(!0))}},null,null,"input:first")}else v?c.openMessageDialog(null,"dialog.passwordError"):c.openMessageDialog(null,"dialog.passwordError2")},e.openLinkDialog=function(){var e;e=null===g?'data-i18n="[value]roomUrlDefaultMsg" value="'+APP.translation.translateString("roomUrlDefaultMsg")+'"':'value="'+encodeURI(g)+'"',c.openTwoButtonDialog("dialog.shareLink",null,null,'<input id="inviteLinkRef" type="text" '+e+' onclick="this.select();" readonly>',!1,"dialog.Invite",function(e,t){t&&g&&r()},function(e){g?document.getElementById("inviteLinkRef").select():e&&e.target&&$(e.target).find("button[value=true]").prop("disabled",!0)})},e.openSettingsDialog=function(){var e=APP.translation.generateTranslatonHTML("dialog.settings1"),t=APP.translation.generateTranslatonHTML("dialog.settings2"),n=APP.translation.generateTranslatonHTML("dialog.settings3"),i=APP.translation.translateString("dialog.yourPassword");c.openTwoButtonDialog(null,"<h2>"+e+'</h2><input type="checkbox" id="initMuted">'+t+'<br/><input type="checkbox" id="requireNicknames">'+n+'<input id="lockKey" type="text" placeholder="'+i+'" data-i18n="[placeholder]dialog.yourPassword" autofocus>',null,null,!1,"dialog.Save",function(){document.getElementById("lockKey").focus()},function(e,t){t&&($("#initMuted").is(":checked"),$("#requireNicknames").is(":checked"))})},e.toggleFullScreen=function(){var e=document.documentElement;document.mozFullScreen||document.webkitIsFullScreen?document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)},e.unlockLockButton=function(){$("#lockIcon").hasClass("icon-security-locked")&&h.buttonClick("#lockIcon","icon-security icon-security-locked")},e.lockLockButton=function(){$("#lockIcon").hasClass("icon-security")&&h.buttonClick("#lockIcon","icon-security icon-security-locked")},e.showAuthenticateButton=function(e){$("#authentication").css(e?{display:"inline"}:{display:"none"})},e.showRecordingButton=function(e){config.enableRecording&&$("#recording").css(e?{display:"inline"}:{display:"none"})},e.setRecordingButtonState=function(e){var t=$("#recordButton");e?(t.removeClass("icon-recEnable"),t.addClass("icon-recEnable active")):(t.removeClass("icon-recEnable active"),t.addClass("icon-recEnable"))},e.showSipCallButton=function(e){$("#sipCallButton").css(APP.xmpp.isSipGatewayEnabled()&&e?{display:"inline-block"}:{display:"none"})},e.showDialPadButton=function(e){$("#dialPadButton").css(e?{display:"inline-block"}:{display:"none"})},e.setAuthenticatedIdentity=function(e){if(e){var t=$("#toolbar_auth_identity");t.css({display:"list-item"}),t.text(e)}else $("#toolbar_auth_identity").css({display:"none"})},e.showLoginButton=function(e){$("#toolbar_button_login").css(e?{display:"list-item"}:{display:"none"})},e.showLogoutButton=function(e){$("#toolbar_button_logout").css(e?{display:"list-item"}:{display:"none"})},e.changeDesktopSharingButtonState=function(e){var t=$("#desktopsharing > a");e?t.addClass("glow"):t.removeClass("glow")},e}(S||{});t.exports=S},{"../../../service/authentication/AuthenticationEvents":70,"../authentication/Authentication":12,"../etherpad/Etherpad":15,"../prezi/Prezi":16,"../side_pannels/SidePanelToggler":18,"../util/MessageHandler":29,"../util/UIUtil":31,"./BottomToolbar":25}],27:[function(e,t){function n(){$("#desktopsharing").css(APP.desktopsharing.isDesktopSharingEnabled()?{display:"inline"}:{display:"none"})}function i(){if(!config.alwaysVisibleToolbar){var e=$("#header"),t=$("#bottomToolbar"),n=!1;e.find("*").each(function(){var e=$(this).attr("id");$("#"+e+":hover").length>0&&(n=!0)}),$("#bottomToolbar:hover").length>0&&(n=!0),clearTimeout(o),o=null,n?o=setTimeout(i,r):(e.hide("slide",{direction:"up",duration:300}),$("#subject").animate({top:"-=40"},300),$("#remoteVideos").hasClass("hidden")&&t.hide("slide",{direction:"right",duration:300}))}}var o,r=interfaceConfig.INITIAL_TOOLBAR_TIMEOUT,a={showToolbar:function(){var e=$("#header"),t=$("#bottomToolbar");e.is(":visible")&&t.is(":visible")||(e.show("slide",{direction:"up",duration:300}),$("#subject").animate({top:"+=40"},300),t.is(":visible")||t.show("slide",{direction:"right",duration:300}),o&&(clearTimeout(o),o=null),o=setTimeout(i,r),r=interfaceConfig.TOOLBAR_TIMEOUT),APP.xmpp.isModerator(),n()},dockToolbar:function(e){e?($("#header").is(":visible")||this.showToolbar(),o&&(clearTimeout(o),o=null)):$("#header").is(":visible")?o=setTimeout(i,r):this.showToolbar()},showDesktopSharingButton:n};t.exports=a},{}],28:[function(e,t){var n=function(){function e(e,t){this.options={skin:"white",content:""},t&&(t.skin&&(this.options.skin=t.skin),t.content&&(this.options.content=t.content)),this.elementIsHovered=!1,this.popoverIsHovered=!1,this.popoverShown=!1,e.data("jitsi_popover",this),this.element=e,this.template=' <div class="jitsipopover '+this.options.skin+'"><div class="arrow"></div><div class="jitsipopover-content"></div><div class="jitsiPopupmenuPadding"></div></div>';var n=this;this.element.on("mouseenter",function(){n.elementIsHovered=!0,n.show()}).on("mouseleave",function(){n.elementIsHovered=!1,setTimeout(function(){n.hide()},10)})}return e.prototype.show=function(){this.createPopover(),this.popoverShown=!0},e.prototype.hide=function(){this.elementIsHovered||this.popoverIsHovered||!this.popoverShown||this.forceHide()},e.prototype.forceHide=function(){$(".jitsipopover").remove(),this.popoverShown=!1},e.prototype.createPopover=function(){$("body").append(this.template),$(".jitsipopover > .jitsipopover-content").html(this.options.content);var e=this;$(".jitsipopover").on("mouseenter",function(){e.popoverIsHovered=!0}).on("mouseleave",function(){e.popoverIsHovered=!1,e.hide()}),this.refreshPosition()},e.prototype.refreshPosition=function(){$(".jitsipopover").position({my:"bottom",at:"top",collision:"fit",of:this.element,using:function(e,t){var n=t.target.left-t.element.left+t.target.width/2;$(".jitsipopover").css({top:e.top,left:e.left,display:"table"}),$(".jitsipopover > .arrow").css({left:n}),$(".jitsipopover > .jitsiPopupmenuPadding").css({left:n-50})}})},e.prototype.updateContent=function(e){this.options.content=e,this.popoverShown&&($(".jitsipopover").remove(),this.createPopover())},e}();t.exports=n},{}],29:[function(e,t){var n=function(e){return e.openMessageDialog=function(e,t){var n=null;e&&(n=APP.translation.generateTranslatonHTML(e));var i=APP.translation.generateTranslatonHTML(t);$.prompt(i,{title:n,persistent:!1})},e.openTwoButtonDialog=function(e,t,n,i,o,r,a,s,c,l,u){var d=[],p=APP.translation.generateTranslatonHTML(r);d.push({title:p,value:!0});var f=APP.translation.generateTranslatonHTML("dialog.Cancel");d.push({title:f,value:!1});var h=i,m=t;e&&(m=APP.translation.generateTranslatonHTML(e)),n&&(h=APP.translation.generateTranslatonHTML(n)),$.prompt(h,{title:m,persistent:!1,buttons:d,defaultButton:u,focus:l,loaded:s,submit:a,close:c})},e.openDialog=function(e,t,n,i,o,r){var a={title:e,persistent:n,buttons:i,defaultButton:1,loaded:r,submit:o};return n&&(a.closeText=""),new Impromptu(t,a)},e.closeDialog=function(){$.prompt.close()},e.openDialogWithStates=function(e,t){return new Impromptu(e,t)},e.openCenteredPopup=function(e,t,n,i){var o=window.screenX+window.innerWidth/2-t/2,r=window.screenY+window.innerHeight/2-n/2,a=window.open(e,"_blank","top="+r+", left="+o+", width="+t+", height="+n);if(a&&i)var s=window.setInterval(function(){a.closed!==!1&&(window.clearInterval(s),i())},200);return a},e.openReportDialog=function(t,n,i){e.openMessageDialog(t,n),console.log(i)},e.showError=function(e,t){e||(e="dialog.oops"),t||(t="dialog.defaultError"),n.openMessageDialog(e,t)},e.notify=function(e,t,n,i,o,r){var a='<span class="nickname" ';a+=e?">"+e:"data-i18n='"+t+"'>"+APP.translation.translateString(t),a+="</span>",toastr.info(a+"<br><span class="+n+' data-i18n="'+i+'"'+(o?" data-i18n-options='"+JSON.stringify(o)+"'":"")+">"+APP.translation.translateString(i,o)+"</span>",null,r)},e}(n||{});t.exports=n},{}],30:[function(e,t){var n=e("../../../service/UI/UIEvents"),i=null,o=null,r={init:function(e){o=e;var t=window.localStorage.displayname;t&&(i=t)},setNickname:function(e){e&&i!==e&&(i=e,window.localStorage.displayname=i,o.emit(n.NICKNAME_CHANGED,e))},getNickname:function(){return i},addListener:function(e,t){o.on(e,t)}};t.exports=r},{"../../../service/UI/UIEvents":69}],31:[function(e,t){t.exports={getAvailableVideoWidth:function(){var t=e("../side_pannels/SidePanelToggler"),n=t.isVisible()?t.getPanelSize()[0]:0;return window.innerWidth-n},buttonClick:function(e,t){$(e).toggleClass(t)},getTextWidth:function(e){return e.clientWidth+1},getTextHeight:function(e){return e.clientHeight+1},playSoundNotification:function(e){document.getElementById(e).play()},escapeHtml:function(e){return $("<div/>").text(e).html()},imageToGrayScale:function(e){for(var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),i=n.data,o=0,r=i.length;r>o;o+=4){var a=.3*i[o]+.59*i[o+1]+.11*i[o+2];i[o]=a,i[o+1]=a,i[o+2]=a}t.putImageData(n,0,0)},setTooltip:function(e,t,n){e.setAttribute("data-i18n","[data-content]"+t),e.setAttribute("data-toggle","popover"),e.setAttribute("data-placement",n),e.setAttribute("data-html",!0),e.setAttribute("data-container","body")}}},{"../side_pannels/SidePanelToggler":18}],32:[function(e,t){function n(e,t,n){this.videoContainer=e,this.bandwidth=null,this.packetLoss=null,this.bitrate=null,this.showMoreValue=!1,this.resolution=null,this.transport=[],this.popover=null,this.jid=t,this.create(),this.videoLayout=n}function i(e){var t=document.createElement("span");for(var n in e)t.classList.add(e[n]);return t.appendChild(document.createElement("i")).classList.add("icon-connection"),t}var o=e("../util/JitsiPopover");n.connectionQualityValues={98:"18px",81:"15px",64:"11px",47:"7px",30:"3px",0:"0px"},n.getIP=function(e){return e.substring(0,e.lastIndexOf(":"))},n.getPort=function(e){return e.substring(e.lastIndexOf(":")+1,e.length)},n.getStringFromArray=function(e){for(var t="",n=0;n<e.length;n++)t+=(0===n?"":", ")+e[n];return t},n.prototype.generateText=function(){var e,t,i,o,r,a=APP.translation.translateString;null===this.bitrate?(e="N/A",t="N/A"):(e=this.bitrate.download?this.bitrate.download+" Kbps":"N/A",t=this.bitrate.upload?this.bitrate.upload+" Kbps":"N/A"),i=null===this.packetLoss?"N/A":"<span class='jitsipopover_green'>&darr;</span>"+(null!==this.packetLoss.download?this.packetLoss.download:"N/A")+"% <span class='jitsipopover_orange'>&uarr;</span>"+(null!==this.packetLoss.upload?this.packetLoss.upload:"N/A")+"%";var s=null;if(this.resolution&&null!=this.jid){var c=Object.keys(this.resolution);if(1==c.length)for(var l in this.resolution)s=this.resolution[l];else if(c.length>1){var u=APP.simulcast.getReceivingSSRC(this.jid);s=this.resolution[u]}}if(null===this.jid)if(o="",null!==this.resolution&&Object.keys(this.resolution)&&0!==Object.keys(this.resolution).length)for(r in this.resolution)s=this.resolution[r],s&&s.height&&s.width&&(o+=(""===o?"":", ")+s.width+"x"+s.height);else o="N/A";else o=s&&s.height&&s.width?s.width+"x"+s.height:"N/A";var d="<table style='width:100%'><tr><td><span class='jitsipopover_blue' data-i18n='connectionindicator.bitrate'>"+a("connectionindicator.bitrate")+"</span></td><td><span class='jitsipopover_green'>&darr;</span>"+e+" <span class='jitsipopover_orange'>&uarr;</span>"+t+"</td></tr><tr><td><span class='jitsipopover_blue' data-i18n='connectionindicator.packetloss'>"+a("connectionindicator.packetloss")+"</span></td><td>"+i+"</td></tr><tr><td><span class='jitsipopover_blue' data-i18n='connectionindicator.resolution'>"+a("connectionindicator.resolution")+"</span></td><td>"+o+"</td></tr></table>";if("localVideoContainer"==this.videoContainer.id&&(d+='<div class="jitsipopover_showmore" onclick = "APP.UI.connectionIndicatorShowMore(\''+this.videoContainer.id+"')\"  data-i18n='connectionindicator."+(this.showMoreValue?"less":"more")+"'>"+a("connectionindicator."+(this.showMoreValue?"less":"more"))+"</div><br />"),this.showMoreValue){var p,f,h;if(null===this.bandwidth?(p="N/A",f="N/A"):(p=this.bandwidth.download?this.bandwidth.download+" Kbps":"N/A",f=this.bandwidth.upload?this.bandwidth.upload+" Kbps":"N/A"),this.transport&&0!==this.transport.length){var m={remoteIP:[],localIP:[],remotePort:[],localPort:[]};for(r=0;r<this.transport.length;r++){var g=n.getIP(this.transport[r].ip),v=n.getPort(this.transport[r].ip),y=n.getIP(this.transport[r].localip),b=n.getPort(this.transport[r].localip);-1==m.remoteIP.indexOf(g)&&m.remoteIP.push(g),-1==m.remotePort.indexOf(v)&&m.remotePort.push(v),-1==m.localIP.indexOf(y)&&m.localIP.push(y),-1==m.localPort.indexOf(b)&&m.localPort.push(b)}var S="connectionindicator.localaddress",_="connectionindicator.remoteaddress",w="<tr><td><span class='jitsipopover_blue' data-i18n='"+S+"' data-i18n-options='"+JSON.stringify({count:m.localIP.length})+"'>"+a(S,{count:m.localIP.length})+"</span></td><td> "+n.getStringFromArray(m.localIP)+"</td></tr>";h="<tr><td><span class='jitsipopover_blue' data-i18n='"+_+"' data-i18n-options='"+JSON.stringify({count:m.remoteIP.length})+"'>"+a(_,{count:m.remoteIP.length})+"</span></td><td> "+n.getStringFromArray(m.remoteIP)+"</td></tr>";var A="connectionindicator.remoteport",x="connectionindicator.localport";h+="<tr><td><span class='jitsipopover_blue' data-i18n='"+A+"' data-i18n-options='"+JSON.stringify({count:this.transport.length})+"'>"+a(A,{count:this.transport.length})+"</span></td><td>",w+="<tr><td><span class='jitsipopover_blue' data-i18n='"+x+"' data-i18n-options='"+JSON.stringify({count:this.transport.length})+"'>"+a(x,{count:this.transport.length})+"</span></td><td>",h+=n.getStringFromArray(m.remotePort),w+=n.getStringFromArray(m.localPort),h+="</td></tr>",h+=w+"</td></tr>",h+="<tr><td><span class='jitsipopover_blue' data-i18n='connectionindicator.transport'>"+a("connectionindicator.transport")+"</span></td><td>"+this.transport[0].type+"</td></tr>"}else h="<tr><td><span class='jitsipopover_blue' data-i18n='connectionindicator.address'>"+a("connectionindicator.address")+"</span></td><td> N/A</td></tr>";d+="<table  style='width:100%'><tr><td><span class='jitsipopover_blue' data-i18n='connectionindicator.bandwidth'>"+a("connectionindicator.bandwidth")+"</span></td><td><span class='jitsipopover_green'>&darr;</span>"+p+" <span class='jitsipopover_orange'>&uarr;</span>"+f+"</td></tr>",d+=h+"</table>"}return d},n.prototype.showMore=function(){this.showMoreValue=!this.showMoreValue,this.updatePopoverData()},n.prototype.create=function(){this.connectionIndicatorContainer=document.createElement("div"),this.connectionIndicatorContainer.className="connectionindicator",this.connectionIndicatorContainer.style.display="none",this.videoContainer.appendChild(this.connectionIndicatorContainer),this.popover=new o($("#"+this.videoContainer.id+" > .connectionindicator"),{content:"<div class=\"connection_info\" data-i18n='connectionindicator.na'>"+APP.translation.translateString("connectionindicator.na")+"</div>",skin:"black"}),this.emptyIcon=this.connectionIndicatorContainer.appendChild(i(["connection","connection_empty"])),this.fullIcon=this.connectionIndicatorContainer.appendChild(i(["connection","connection_full"]))},n.prototype.remove=function(){this.connectionIndicatorContainer.remove(),this.popover.forceHide()},n.prototype.updateConnectionQuality=function(e,t){if(null===e)return this.connectionIndicatorContainer.style.display="none",void this.popover.forceHide();"none"==this.connectionIndicatorContainer.style.display&&(this.connectionIndicatorContainer.style.display="block",this.videoLayout.updateMutePosition(this.videoContainer.id)),this.bandwidth=t.bandwidth,this.bitrate=t.bitrate,this.packetLoss=t.packetLoss,this.transport=t.transport,t.resolution&&(this.resolution=t.resolution);for(var i in n.connectionQualityValues)e>=i&&(this.fullIcon.style.width=n.connectionQualityValues[i]);this.updatePopoverData()},n.prototype.updateResolution=function(e){this.resolution=e,this.updatePopoverData()},n.prototype.updatePopoverData=function(){this.popover.updateContent('<div class="connection_info">'+this.generateText()+"</div>"),APP.translation.translateElement($(".connection_info"))},n.prototype.hide=function(){this.popover.forceHide()},n.prototype.hideIndicator=function(){this.connectionIndicatorContainer.style.display="none",this.popover&&this.popover.forceHide()},t.exports=n},{"../util/JitsiPopover":28}],33:[function(e,t){function n(t){if(-1===t.attr("id").indexOf("mixedmslabel")){t.show(),U.resizeThumbnails();var n=t.parent(),i=null;n&&(i=U.getPeerContainerResourceJid(n[0])),(!M&&!U.getDominantSpeakerResourceJid()&&!e("../prezi/Prezi").isPresentationVisible()||i&&U.getDominantSpeakerResourceJid()===i)&&U.updateLargeVideo(APP.RTC.getVideoSrc(t[0]),1,i),U.showModeratorIndicator()}}function i(e,t,o,r){if(e.removed||!e.parent().is(":visible"))return void console.warn("Media removed before had started",e);if("mixedmslabel"!==o.id)if(e[0].currentTime>0){var a=APP.simulcast.getReceivingVideoStream(o);APP.RTC.attachMediaStream(e,a),n(e)}else setTimeout(function(){i(e,t,o,r)},250)}function o(e,t,n,i){var o=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;o&&(i=window.innerHeight);var r=(n-e)/2,a=(i-t)/2;return[r,a]}function r(e,t,n){var i=(n-e)/2,o=0;return[i,o]}function a(e,t,n,i){e||(e=j),t||(t=O);var o=e/t,r=Math.max(e,n),a=Math.max(t,i);return i>r/o&&(a=i,r=a*o),n>a*o&&(r=n,a=r/o),[r,a]}function s(e,t,n){var i=$("#"+e+">span.displayname"),o=APP.translation.generateTranslatonHTML(interfaceConfig.DEFAULT_LOCAL_DISPLAY_NAME);if(i.length>0){var r=i.get(0);if("localDisplayName"===r.id&&$("#localDisplayName").text()!==t)if(t&&t.length>0){var a=APP.translation.generateTranslatonHTML("me");$("#localDisplayName").html(t+" ("+a+")")}else $("#localDisplayName").html(o);else if(t&&t.length>0)$("#"+e+"_name").html(t);else if(n&&n.length>0){var s=APP.translation.generateTranslatonHTML(n);$("#"+e+"_name").html(s)}else $("#"+e+"_name").text(interfaceConfig.DEFAULT_REMOTE_DISPLAY_NAME)}else{var c=null;if(i=document.createElement("span"),i.className="displayname",$("#"+e)[0].appendChild(i),"localVideoContainer"===e)if(c=h(),t&&t.length>0){var a=APP.translation.generateTranslatonHTML("me");i.innerHTML=t+a}else i.innerHTML=o;else i.innerText=t&&t.length>0?t:interfaceConfig.DEFAULT_REMOTE_DISPLAY_NAME;if(c){i.id="localDisplayName",$("#"+e)[0].appendChild(c),APP.translation.translateElement($("a.displayname"));var l=document.createElement("input");l.className="displayname",l.type="text",l.id="editDisplayName",t&&t.length&&(l.value=t);var u=APP.translation.translateString("defaultNickname",{name:"Jane Pink"});l.setAttribute("style","display:none;"),l.setAttribute("data-18n","[placeholder]defaultNickname"),l.setAttribute("data-i18n-options",JSON.stringify({name:"Jane Pink"})),l.setAttribute("placeholder",u),$("#"+e)[0].appendChild(l),$("#localVideoContainer .displayname").bind("click",function(e){e.preventDefault(),e.stopPropagation(),$("#localDisplayName").hide(),$("#editDisplayName").show(),$("#editDisplayName").focus(),$("#editDisplayName").select(),$("#editDisplayName").one("focusout",function(){U.inputDisplayNameHandler(this.value)
}),$("#editDisplayName").on("keydown",function(e){13===e.keyCode&&(e.preventDefault(),U.inputDisplayNameHandler(this.value))})})}else i.id=e+"_name"}}function c(e){return e?$(e===APP.xmpp.myResource()?"#localVideoContainer":"#participant_"+e):null}function l(e,t,n,i,o){e.width(t),e.height(n),e.css({top:o+"px",bottom:o+"px",left:i+"px",right:i+"px"})}function u(e,t){var n=document.createElement("span");n.className="remotevideomenu",t.appendChild(n);var i=document.createElement("i");i.className="fa fa-angle-down",i.title="Remote user controls",n.appendChild(i);var o=document.createElement("ul");o.className="popupmenu",o.id="remote_popupmenu_"+Strophe.getResourceFromJid(e),n.appendChild(o);var r=document.createElement("li"),a=document.createElement("a"),s="<i style='float:left;' class='icon-mic-disabled'></i>";I[e]?(a.innerHTML=s+" <div style='width: 90px;margin-left: 20px;' data-i18n='videothumbnail.muted'></div>",a.className="mutelink disabled"):(a.innerHTML=s+" <div style='width: 90px;margin-left: 20px;' data-i18n='videothumbnail.domute'></div>",a.className="mutelink"),a.onclick=function(){void 0!=$(this).attr("disabled")&&event.preventDefault();var t=1==I[e];APP.xmpp.setMute(e,!t),o.setAttribute("style","display:none;"),t?(this.innerHTML=s+" <div style='width: 90px;margin-left: 20px;' data-i18n='videothumbnail.muted'></div>",this.className="mutelink disabled"):(this.innerHTML=s+" <div style='width: 90px;margin-left: 20px;' data-i18n='videothumbnail.domute'></div>",this.className="mutelink")},r.appendChild(a),o.appendChild(r);var c="<i style='float:left;' class='fa fa-eject'></i>",l=document.createElement("li"),u=document.createElement("a"),d="<div style='width: 90px;margin-left: 20px;' data-i18n='videothumbnail.kick'>&nbsp;</div>";u.innerHTML=c+" "+d,u.onclick=function(){APP.xmpp.eject(e),o.setAttribute("style","display:none;")},l.appendChild(u),o.appendChild(l);var p=document.createElement("span");p.className="popupmenuPadding",o.appendChild(p),APP.translation.translateElement($("#"+o.id+" > li > a > div"))}function d(e){var t=$("#"+e+">span.remotevideomenu");t.length&&t.remove()}function p(e,t,n){U.connectionIndicators[e]&&U.connectionIndicators[e].updateConnectionQuality(t,n)}function f(e,t,n,i){e||(e=j),t||(t=O);var o=e/t,r=Math.max(e,n),a=Math.max(t,i);return i-=$("#remoteVideos").outerHeight(),r/o>=i&&(a=i,r=a*o),a*o>=n&&(r=n,a=r/o),[r,a]}function h(){var e=document.createElement("a");return e.className="displayname",S.setTooltip(e,"videothumbnail.editnickname","top"),e.innerHTML='<i class="fa fa-pencil"></i>',e}function m(e){var t=document.createElement("i");t.className="fa fa-star",e.appendChild(t),S.setTooltip(e,"videothumbnail.moderator","top")}var g=e("../audio_levels/AudioLevels"),v=e("../avatar/Avatar"),y=e("../side_pannels/chat/Chat"),b=e("../side_pannels/contactlist/ContactList"),S=e("../util/UIUtil"),_=e("./ConnectionIndicator"),w=e("../util/NicknameHandler"),A=e("../../../service/RTC/MediaStreamTypes"),x=e("../../../service/UI/UIEvents"),P=null,T=config.channelLastN,C=config.channelLastN,E=[],k=[],R=null,L={updateInProgress:!1,newSrc:""},D=null,M=null,I={},N=!0,j=null,O=null,V=null,U=function(t){function n(e,t){var n=$("#participant_"+e);if(n){var i="hide"===t,o=!1;if(i)n.is(":visible")&&i&&(o=!0,n.hide(),U.connectionIndicators["participant_"+e]&&U.connectionIndicators["participant_"+e].hide());else{n.is(":visible")||(o=!0,n.show());var r=APP.xmpp.findJidFromResource(e);"show"==t?v.showUserAvatar(r,!1):v.showUserAvatar(r,!0)}o&&U.resizeThumbnails()}}return t.connectionIndicators={},t.getVideoSize=a,t.getVideoPosition=o,t.init=function(e){document.getElementById("largeVideo").addEventListener("loadedmetadata",function(){j=this.videoWidth,O=this.videoHeight,U.positionLarge(j,O)}),D=e},t.isInLastN=function(e){return 0>T||T>0&&0==k.length||k&&-1!==k.indexOf(e)},t.changeLocalStream=function(e,t){U.changeLocalVideo(e,t)},t.changeLocalAudio=function(e,t){t&&APP.UI.setAudioMuted(!0,!0),APP.RTC.attachMediaStream($("#localAudio"),e.getOriginalStream()),document.getElementById("localAudio").autoplay=!0,document.getElementById("localAudio").volume=0},t.changeLocalVideo=function(e,t){function n(e){e.stopPropagation(),U.handleVideoThumbClicked(APP.RTC.getVideoSrc(i),!1,APP.xmpp.myResource())}s("localVideoContainer"),U.connectionIndicators.localVideoContainer||(U.connectionIndicators.localVideoContainer=new _($("#localVideoContainer")[0],null,U)),g.updateAudioLevelCanvas(null,U);var i=null;if($("#localVideoContainer").click(n),$("#localVideoContainer").hover(function(){U.showDisplayName("localVideoContainer",!0)},function(){U.isLargeVideoVisible()&&APP.RTC.getVideoSrc(i)===APP.RTC.getVideoSrc($("#largeVideo")[0])||U.showDisplayName("localVideoContainer",!1)}),t)return void APP.UI.setVideoMute(!0);var o=!0;"screen"==e.videoType&&(o=!1);var i=document.createElement("video");i.id="localVideo_"+APP.RTC.getStreamID(e.getOriginalStream()),i.autoplay=!0,i.volume=0,i.oncontextmenu=function(){return!1};var r=document.getElementById("localVideoWrapper");r.appendChild(i);var a=$("#"+i.id);a.click(n),N=o,o&&a.addClass("flipVideoX");var c=APP.simulcast.getLocalVideoStream();APP.RTC.attachMediaStream(a,c),e.getOriginalStream().onended=function(){r.removeChild(i),U.updateRemovedVideo(APP.RTC.getVideoSrc(i))},V=APP.RTC.getVideoSrc(i);var l=APP.xmpp.myResource();U.updateLargeVideo(V,0,l)},t.mucJoined=function(){var e=APP.xmpp.myResource();L.userResourceJid||U.updateLargeVideo(V,0,e,!0)},t.setDeviceAvailabilityIcons=function(e,t){if(t){var n=null;n=e?$("#participant_"+e)[0]:$("#localVideoContainer")[0],n&&($("#"+n.id+" > .noMic").remove(),$("#"+n.id+" > .noVideo").remove(),t.audio||n.appendChild(document.createElement("div")).setAttribute("class","noMic"),t.video||n.appendChild(document.createElement("div")).setAttribute("class","noVideo"),t.audio||t.video||($("#"+n.id+" > .noMic").css("background-position","75%"),$("#"+n.id+" > .noVideo").css("background-position","25%"),$("#"+n.id+" > .noVideo").css("background-color","transparent")))}},t.updateRemovedVideo=function(e){if(e===APP.RTC.getVideoSrc($("#largeVideo")[0])){var t=$('#remoteVideos>span[id!="mixedstream"]:visible:last>video').get(0);t||(console.info("Last visible video no longer exists"),t=$('#remoteVideos>span[id!="mixedstream"]>video').get(0),t&&APP.RTC.getVideoSrc(t)||(console.info("Fallback to local video..."),t=$("#remoteVideos>span>span>video").get(0)));var n=null,i=null;if(t){var o=t.parentNode;n=APP.RTC.getVideoSrc(t),i=t.volume}else console.warn("Failed to elect large video"),o=$('#remoteVideos>span[id!="mixedstream"]:visible:last').get(0);var r=null;if(!o)return;r="localVideoWrapper"==o.id?APP.xmpp.myResource():U.getPeerContainerResourceJid(o),U.updateLargeVideo(n,i,r)}},t.onRemoteStreamAdded=function(e){var t,n=document.getElementById("remoteVideos");if(e.peerjid)U.ensurePeerContainerExists(e.peerjid),t=document.getElementById("participant_"+Strophe.getResourceFromJid(e.peerjid));else{var i=e.getOriginalStream().id;if("mixedmslabel"!==i&&"default"!==i)return void console.error("can not associate stream",i,"with a participant");t=document.createElement("span"),t.id="mixedstream",t.className="videocontainer",n.appendChild(t),S.playSoundNotification("userJoined")}t&&U.addRemoteStreamElement(t,e.sid,e.getOriginalStream(),e.peerjid,e.ssrc)},t.getLargeVideoState=function(){return L},t.updateLargeVideo=function(e,t,n,i){if(console.log("hover in",e,n),APP.RTC.getVideoSrc($("#largeVideo")[0])!==e||i){$("#activeSpeaker").css("visibility","hidden"),L.newSrc=e,L.isVisible=$("#largeVideo").is(":visible"),L.isDesktop=APP.RTC.isVideoSrcDesktop(APP.xmpp.findJidFromResource(n)),L.oldResourceJid=L.userResourceJid?L.userResourceJid:null,L.userResourceJid=n,L.flipX=e===V&&N;var s=!1;if(L.oldResourceJid!==L.userResourceJid&&(s=!0,D.emit(x.SELECTED_ENDPOINT,L.userResourceJid)),!L.updateInProgress){L.updateInProgress=!0;var c=function(){if(v.updateActiveSpeakerAvatarSrc(APP.xmpp.findJidFromResource(L.userResourceJid)),!s&&L.preload&&null!==L.preload&&APP.RTC.getVideoSrc($(L.preload)[0])===e){console.info("Switching to preloaded video");var t=$("#largeVideo").prop("attributes");$.each(t,function(){"id"!==this.name&&"src"!==this.name&&L.preload.attr(this.name,this.value)}),L.preload.appendTo($("#largeVideoContainer")),$("#largeVideo").attr("id","previousLargeVideo"),L.preload.attr("id","largeVideo"),$("#previousLargeVideo").remove(),L.preload.on("loadedmetadata",function(){j=this.videoWidth,O=this.videoHeight,U.positionLarge(j,O)}),L.preload=null,L.preload_ssrc=0}else APP.RTC.setVideoSrc($("#largeVideo")[0],L.newSrc);var n=document.getElementById("largeVideo").style.webkitTransform;L.flipX&&"scaleX(-1)"!==n?document.getElementById("largeVideo").style.webkitTransform="scaleX(-1)":L.flipX||"scaleX(-1)"!==n||(document.getElementById("largeVideo").style.webkitTransform="none"),U.getVideoSize=L.isDesktop?f:a,U.getVideoPosition=L.isDesktop?r:o,L.oldResourceJid&&U.enableDominantSpeaker(L.oldResourceJid,!1),L.userResourceJid&&U.enableDominantSpeaker(L.userResourceJid,!0),s&&L.isVisible&&$(this).fadeIn(300),s&&v.showUserAvatar(APP.xmpp.findJidFromResource(L.oldResourceJid)),L.updateInProgress=!1};s?$("#largeVideo").fadeOut(300,c):c()}}else v.showUserAvatar(APP.xmpp.findJidFromResource(L.userResourceJid))},t.handleVideoThumbClicked=function(e,t,n){var i=null;if(M){var o=M.resourceJid;i=c(o)}if(i&&i.removeClass("videoContainerFocused"),M&&M.src===e){M=null;var r=null;return P&&(r=$("#participant_"+P+">video").get(0),r&&U.updateLargeVideo(APP.RTC.getVideoSrc(r),1,P)),void(t||D.emit(x.PINNED_ENDPOINT))}if(M={src:e,resourceJid:n},n){var a=c(n);a.addClass("videoContainerFocused"),t||D.emit(x.PINNED_ENDPOINT,n)}$("#largeVideo").attr("src")===e&&U.isLargeVideoOnTop()||($(document).trigger("video.selected",[!1]),U.updateLargeVideo(e,1,n),$("audio").each(function(e,t){-1!==t.id.indexOf("mixedmslabel")&&(t.volume=0,t.volume=1)}))},t.positionLarge=function(e,t){var n=$("#videospace").width(),i=window.innerHeight,o=U.getVideoSize(e,t,n,i),r=o[0],a=o[1],s=U.getVideoPosition(r,a,n,i),c=s[0],u=s[1];l($("#largeVideo"),r,a,c,u)},t.setLargeVideoVisible=function(e){var t=L.userResourceJid;if(e)$("#largeVideo").css({visibility:"visible"}),$(".watermark").css({visibility:"visible"}),U.enableDominantSpeaker(t,!0);else if($("#largeVideo").css({visibility:"hidden"}),$("#activeSpeaker").css("visibility","hidden"),$(".watermark").css({visibility:"hidden"}),U.enableDominantSpeaker(t,!1),M){var n=M.resourceJid,i=c(n);i&&i.length>0&&i.removeClass("videoContainerFocused"),M=null,n&&v.showUserAvatar(APP.xmpp.findJidFromResource(n))}},t.isLargeVideoVisible=function(){return $("#largeVideo").is(":visible")},t.isLargeVideoOnTop=function(){var t=e("../etherpad/Etherpad"),n=e("../prezi/Prezi");return!n.isPresentationVisible()&&!t.isVisible()},t.ensurePeerContainerExists=function(e,t){b.ensureAddContact(e,t);var i=Strophe.getResourceFromJid(e),o="participant_"+i;if(!$("#"+o).length){var r=U.addRemoteVideoContainer(e,o,t);v.setUserAvatar(e,t),s(o),U.connectionIndicators[o]=new _(r,e,U);var a=document.createElement("span");a.className="nick",a.appendChild(document.createTextNode(i)),r.appendChild(a),C&&C>0&&$("#remoteVideos>span").length>=C+2?n(i,"hide"):U.resizeThumbnails()}},t.addRemoteVideoContainer=function(e,t){var n=document.createElement("span");n.id=t,n.className="videocontainer";var i=document.getElementById("remoteVideos");return i.appendChild(n),APP.xmpp.isModerator()&&null!==e&&u(e,n),g.updateAudioLevelCanvas(e,U),n},t.createStreamElement=function(e,t){var n=t.getVideoTracks().length>0,i=document.createElement(n?"video":"audio"),o=(n?"remoteVideo_":"remoteAudio_")+e+"_"+APP.RTC.getStreamID(t);return i.id=o,i.autoplay=!0,i.oncontextmenu=function(){return!1},i},t.addRemoteStreamElement=function(e,t,n,o,r){var a=null,s=n.getVideoTracks().length>0;if(e){var c=U.createStreamElement(t,n);a=c.id,e.appendChild(c);var l=$("#"+a);if(l.hide(),!s||null!==e.offsetParent&&s){var u=APP.simulcast.getReceivingVideoStream(n);APP.RTC.attachMediaStream(l,u),s&&i(l,r,n,o)}n.onended=function(){console.log("stream ended",this),U.removeRemoteStreamElement(n,s,e,a)},e.onclick=function(t){var n=$("#"+e.id+">video").get(0);return n&&U.handleVideoThumbClicked(APP.RTC.getVideoSrc(n),!1,Strophe.getResourceFromJid(o)),t.stopPropagation(),t.preventDefault(),!1},$(e).hover(function(){U.showDisplayName(e.id,!0)},function(){var t=null;$("#"+e.id+">video")&&$("#"+e.id+">video").length>0&&(t=APP.RTC.getVideoSrc($("#"+e.id+">video").get(0))),U.isLargeVideoVisible()&&t===APP.RTC.getVideoSrc($("#largeVideo")[0])||U.showDisplayName(e.id,!1)})}return a},t.removeRemoteStreamElement=function(e,t,n,i){if(n){var o=null,r=null;t?(o=$("#"+i),r=APP.RTC.getVideoSrc(o.get(0))):o=$("#"+n.id+">audio"),o.removed=!0,o.remove();var a=$("#"+n.id+">audio").length,s=$("#"+n.id+">video").length;a||s||(console.log("Remove whole user",n.id),U.connectionIndicators[n.id]&&U.connectionIndicators[n.id].remove(),n.remove(),S.playSoundNotification("userLeft"),U.resizeThumbnails()),r&&U.updateRemovedVideo(r)}},t.inputDisplayNameHandler=function(e){if(w.setNickname(e),!$("#localDisplayName").is(":visible")){if(w.getNickname()){var t=APP.translation.generateTranslatonHTML("me");$("#localDisplayName").html(w.getNickname()+" ("+t+")")}else{var n=APP.translation.generateTranslatonHTML(interfaceConfig.DEFAULT_LOCAL_DISPLAY_NAME);$("#localDisplayName").html(n)}$("#localDisplayName").show()}$("#editDisplayName").hide()},t.showDisplayName=function(e,t){var n=$("#"+e+">span.displayname").get(0);t?n&&n.innerHTML&&n.innerHTML.length&&n.setAttribute("style","display:inline-block;"):n&&n.setAttribute("style","display:none;")},t.setPresenceStatus=function(e,t){if($("#"+e).length){var n=$("#"+e+">span.status");n.length||(n=document.createElement("span"),n.className="status",n.id=e+"_status",$("#"+e)[0].appendChild(n),n=$("#"+e+">span.status")),t&&t.length?($("#"+e+"_status").text(t),n.get(0).setAttribute("style","display:inline-block;")):n.get(0).setAttribute("style","display:none;")}},t.showModeratorIndicator=function(){var e=APP.xmpp.isModerator();if(e){var t=$("#localVideoContainer .focusindicator");0===t.children().length&&(m(t[0]),APP.translation.translateElement($("#localVideoContainer .focusindicator")))}var n=APP.xmpp.getMembers();Object.keys(n).forEach(function(t){if("focus"!==Strophe.getResourceFromJid(t)){var i=Strophe.getResourceFromJid(t),o="participant_"+i,r=document.getElementById(o);if(!r)return void console.error("No video container for "+t);var a=n[t];if("moderator"===a.role){var s=$("#"+o+">span.remotevideomenu");s.length&&d(o);var c=$("#"+o+" .focusindicator");c&&0!==c.length||(c=document.createElement("span"),c.className="focusindicator",r.appendChild(c),m(c),APP.translation.translateElement($("#"+o+" .focusindicator")))}else e&&$("#remote_popupmenu_"+i).length<=0&&u(t,document.getElementById("participant_"+i))}})},t.showVideoIndicator=function(e,t){var n=$("#"+e+">span.videoMuted");if("false"===t)n.length>0&&n.remove();else{if(0==n.length){n=document.createElement("span"),n.className="videoMuted",$("#"+e)[0].appendChild(n);var i=document.createElement("i");i.className="icon-camera-disabled",S.setTooltip(i,"videothumbnail.videomute","top"),n.appendChild(i),APP.translation.translateElement($("#"+e+" > span > i"))}U.updateMutePosition(e)}},t.updateMutePosition=function(e){var t=$("#"+e+">span.audioMuted"),n=$("#"+e+">div.connectionindicator"),i=$("#"+e+">span.videoMuted");n.length>0&&"none"!=n[0].style.display?(t.css({right:"23px"}),i.css({right:(t.length>0?23:0)+30+"px"})):(t.css({right:"0px"}),i.css({right:(t.length>0?30:0)+"px"}))},t.showAudioIndicator=function(e,t){var n=$("#"+e+">span.audioMuted");if("false"===t)n.length>0&&(n.popover("hide"),n.remove());else{if(0==n.length){n=document.createElement("span"),n.className="audioMuted",S.setTooltip(n,"videothumbnail.mute","top"),$("#"+e)[0].appendChild(n),APP.translation.translateElement($("#"+e+" > span"));var i=document.createElement("i");i.className="icon-mic-disabled",n.appendChild(i)}U.updateMutePosition(e)}},t.showLocalAudioIndicator=function(e){U.showAudioIndicator("localVideoContainer",e.toString())},t.resizeLargeVideoContainer=function(){y.resizeChat();var e=window.innerHeight,t=S.getAvailableVideoWidth();if(!(0>t||0>e)){$("#videospace").width(t),$("#videospace").height(e),$("#largeVideoContainer").width(t),$("#largeVideoContainer").height(e);var n=interfaceConfig.ACTIVE_SPEAKER_AVATAR_SIZE,i=e/2-n/4*3;$("#activeSpeaker").css("top",i),U.resizeThumbnails()}},t.resizeThumbnails=function(){var e=$("#remoteVideos").width(),t=U.calculateThumbnailSize(e),n=t[0],i=t[1];$("#remoteVideos").height(i),$("#remoteVideos>span").width(n),$("#remoteVideos>span").height(i),$(".userAvatar").css("left",(n-i)/2),$(document).trigger("remotevideo.resized",[n,i])},t.enableDominantSpeaker=function(e,t){var n=null,i=null;e===APP.xmpp.myResource()?(n="localVideoWrapper",i="localVideoContainer"):(n="participant_"+e,i=n);var o=e,r=$("#"+i+">span.displayname");if(r.length>0&&(o=r.html()),console.log("UI enable dominant speaker",o,e,t),videoSpan=document.getElementById(i),videoSpan){var a=$("#"+n+">video");if(a&&a.length>0)if(t){var s=U.isLargeVideoOnTop();U.showDisplayName(i,s),videoSpan.classList.contains("dominantspeaker")||videoSpan.classList.add("dominantspeaker")}else U.showDisplayName(i,!1),videoSpan.classList.contains("dominantspeaker")&&videoSpan.classList.remove("dominantspeaker");v.showUserAvatar(APP.xmpp.findJidFromResource(e))}},t.calculateThumbnailSize=function(e){var t=100,n=$("#remoteVideos>span:visible").length;C&&C>0&&(n=Math.min(C+1,n));var i=e-6*n-70-4,o=i/n,r=16/9,a=Math.min(160,t);return t=Math.min(a,o/r),o/r>t&&(o=Math.floor(t*r)),[o,t]},t.updateRemoteVideoMenu=function(e,t){var n=$("#remote_popupmenu_"+Strophe.getResourceFromJid(e)+">li>a.mutelink"),i="<i class='icon-mic-disabled'></i>";if(n.length){var o=n.get(0);"true"===t?(o.innerHTML=i+" Muted",o.className="mutelink disabled"):(o.innerHTML=i+" Mute",o.className="mutelink")}},t.getDominantSpeakerResourceJid=function(){return P},t.getPeerContainerResourceJid=function(e){var t=e.id.indexOf("participant_");return t>=0?e.id.substring(t+12):void 0},$(b).bind("contactclicked",function(e,t){if(t){var n=Strophe.getResourceFromJid(t),i=$("#participant_"+n);if(i.length>0){var o=$("video",i).get(0);o?o.src&&""!=o.src?U.handleVideoThumbClicked(o.src,!1,Strophe.getResourceFromJid(t)):(R=t,D.emit(x.PINNED_ENDPOINT,Strophe.getResourceFromJid(t))):t==APP.xmpp.myJid()&&$("#localVideoContainer").click()}}}),$(document).bind("audiomuted.muc",function(e,t,n){var i=null;t===APP.xmpp.myJid()?i="localVideoContainer":(U.ensurePeerContainerExists(t),i="participant_"+Strophe.getResourceFromJid(t)),I[t]=n,APP.xmpp.isModerator()&&U.updateRemoteVideoMenu(t,n),i&&U.showAudioIndicator(i,n)}),$(document).bind("videomuted.muc",function(e,t,n){var i="true"===n;if(t===APP.xmpp.myJid()||APP.RTC.muteRemoteVideoStream(t,i)){v.showUserAvatar(t,i);var o=null;t===APP.xmpp.myJid()?o="localVideoContainer":(U.ensurePeerContainerExists(t),o="participant_"+Strophe.getResourceFromJid(t)),o&&U.showVideoIndicator(o,n)}}),t.onDisplayNameChanged=function(e,t,n){"localVideoContainer"===e||e===APP.xmpp.myJid()?s("localVideoContainer",t):(U.ensurePeerContainerExists(e),s("participant_"+Strophe.getResourceFromJid(e),t,n))},t.onDominantSpeakerChanged=function(e){if(e!==APP.xmpp.myResource()){var t=APP.xmpp.getMembers();if(e!==P){var n="participant_"+P,i="participant_"+e,o=APP.xmpp.findJidFromResource(P),r=APP.xmpp.findJidFromResource(e);!P||t&&t[o]&&t[o].displayName||s(n,null),!e||t&&t[r]&&t[r].displayName||s(i,null,interfaceConfig.DEFAULT_DOMINANT_SPEAKER_DISPLAY_NAME),P=e;var a=document.getElementById("participant_"+e);if(a&&!M){var c=a.getElementsByTagName("video");c.length&&c[0].currentTime>0&&U.updateLargeVideo(APP.RTC.getVideoSrc(c[0]),e)}}}},t.onLastNEndpointsChanged=function(e,t){T!==e.length&&(T=e.length),k=e,T>C&&(C=T);for(var o=e.slice(0),r=0;r<E.length&&!(o.length>=C);r++){var a=E[r];-1===o.indexOf(a)&&o.push(a)}E=o;var s=!1;if($("#remoteVideos>span").each(function(t,i){var o=U.getPeerContainerResourceJid(i),r=!0;if(o&&e.indexOf(o)<0&&E.indexOf(o)<0?(console.log("Remove from last N",o),n(o,"hide"),r=!1):o&&$("#participant_"+o).is(":visible")&&e.indexOf(o)<0&&E.indexOf(o)>=0&&(n(o,"avatar"),r=!1),!r){var a=L.userResourceJid;s||o!==a||(s=!0)}}),(!t||t.length<0)&&(t=e),t&&t.length>0&&t.forEach(function(e){var t=$("#participant_"+e).is(":visible");if(n(e,"show"),!t){console.log("Add to last N",e);var o=APP.xmpp.findJidFromResource(e),r=APP.RTC.remoteStreams[o][A.VIDEO_TYPE],a=$("#participant_"+e+">video"),c=APP.simulcast.getReceivingVideoStream(r.stream);APP.RTC.attachMediaStream(a,c),R==r.peerjid&&(R=null,U.handleVideoThumbClicked($(a).attr("src"),!1,Strophe.getResourceFromJid(r.peerjid)),s=!1),i(a,r.ssrc,r.stream,e)}}),s)for(var c,l,u,d=APP.xmpp.myResource(),r=0;r<e.length;r++)if(c=e[r],c&&c!==d&&(l=$("#participant_"+c),0!=l.length&&(u=$("video",l).attr("src")))){U.updateLargeVideo(u);break}},t.onSimulcastLayersChanging=function(e){e.forEach(function(e){var t=e.endpoint;if(-1==T||!(1>T||-1===k.indexOf(t))){var n=e.simulcastLayer.primarySSRC,i=APP.simulcast.getReceivingVideoStreamBySSRC(n),o=i.sid,r=i.stream;if(o&&r){var a=APP.simulcast.getRemoteVideoStreamIdBySSRC(n);console.info([e,n,a,o,r]);var s=Strophe.getResourceFromJid(APP.xmpp.getJidFromSSRC(n))==L.userResourceJid;s&&(L.preload&&$(L.preload).remove(),console.info("Preloading remote video"),L.preload=$("<video autoplay></video>"),L.preload_ssrc=n,APP.RTC.attachMediaStream(L.preload,r))}else console.error("Could not find a stream or a session.",o,r)}})},t.onSimulcastLayersChanged=function(e){e.forEach(function(e){var t=e.endpoint;if(-1==T||!(1>T||-1===k.indexOf(t))){var n=e.simulcastLayer.primarySSRC,i=APP.simulcast.getReceivingVideoStreamBySSRC(n),o=i.sid,r=i.stream;if(o&&r){var a=APP.simulcast.getRemoteVideoStreamIdBySSRC(n);console.info("Switching simulcast substream."),console.info([e,n,a,o,r]);var s=a.split(" "),c=$(["#","remoteVideo_",o,"_",s[0]].join("")),l=Strophe.getResourceFromJid(APP.xmpp.getJidFromSSRC(n))==L.userResourceJid,u=M&&M.src&&""!=M.src&&APP.RTC.getVideoSrc(c[0])==M.src;L.preload_ssrc==n?APP.RTC.setVideoSrc(c[0],APP.RTC.getVideoSrc(L.preload[0])):(L.preload&&null!=L.preload&&$(L.preload).remove(),L.preload_ssrc=0,APP.RTC.attachMediaStream(c,r));var d=APP.xmpp.getJidFromSSRC(n);l&&U.updateLargeVideo(APP.RTC.getVideoSrc(c[0]),null,Strophe.getResourceFromJid(d)),u&&(M.src=APP.RTC.getVideoSrc(c[0]));var p;p=t==APP.xmpp.myResource()?"localVideoContainer":"participant_"+t;var f=U.connectionIndicators[p];f&&f.updatePopoverData()}else console.error("Could not find a stream or a sid.",o,r)}})},t.updateLocalConnectionStats=function(e,t){var n=null;null!==t.resolution&&(n=t.resolution,t.resolution=n[APP.xmpp.myJid()],delete n[APP.xmpp.myJid()]),p("localVideoContainer",e,t);for(var i in n)if(null!==n[i]){var o="participant_"+Strophe.getResourceFromJid(i);U.connectionIndicators[o]&&U.connectionIndicators[o].updateResolution(n[i])}},t.updateConnectionStats=function(e,t,n){var i=Strophe.getResourceFromJid(e),o="participant_"+i;p(o,t,n)},t.removeConnectionIndicator=function(e){U.connectionIndicators["participant_"+Strophe.getResourceFromJid(e)]&&U.connectionIndicators["participant_"+Strophe.getResourceFromJid(e)].remove()},t.hideConnectionIndicator=function(e){U.connectionIndicators["participant_"+Strophe.getResourceFromJid(e)]&&U.connectionIndicators["participant_"+Strophe.getResourceFromJid(e)].hide()},t.onStatsStop=function(){for(var e in U.connectionIndicators)U.connectionIndicators[e].hideIndicator()},t.participantLeft=function(e){M&&M.jid===e&&(console.info("Focused video owner has left the conference"),M=null)},t.onVideoTypeChanged=function(e){e&&Strophe.getResourceFromJid(e)===L.userResourceJid&&(L.isDesktop=APP.RTC.isVideoSrcDesktop(e),U.getVideoSize=L.isDesktop?f:a,U.getVideoPosition=L.isDesktop?r:o,U.positionLarge(null,null))},t}(U||{});t.exports=U},{"../../../service/RTC/MediaStreamTypes":64,"../../../service/UI/UIEvents":69,"../audio_levels/AudioLevels":10,"../avatar/Avatar":14,"../etherpad/Etherpad":15,"../prezi/Prezi":16,"../side_pannels/chat/Chat":19,"../side_pannels/contactlist/ContactList":23,"../util/NicknameHandler":30,"../util/UIUtil":31,"./ConnectionIndicator":32}],34:[function(e,t){function n(e){return e[Math.floor(Math.random()*e.length)]}function i(e){for(var t in c)if(e.indexOf(t)>=0)return!0}var o=["Aliens","Animals","Antelopes","Ants","Apes","Apples","Baboons","Bacteria","Badgers","Bananas","Bats","Bears","Birds","Bonobos","Brides","Bugs","Bulls","Butterflies","Cheetahs","Cherries","Chicken","Children","Chimps","Clowns","Cows","Creatures","Dinosaurs","Dogs","Dolphins","Donkeys","Dragons","Ducks","Dwarfs","Eagles","Elephants","Elves","FAIL","Fathers","Fish","Flowers","Frogs","Fruit","Fungi","Galaxies","Geese","Goats","Gorillas","Hedgehogs","Hippos","Horses","Hunters","Insects","Kids","Knights","Lemons","Lemurs","Leopards","LifeForms","Lions","Lizards","Mice","Monkeys","Monsters","Mushrooms","Octopodes","Oranges","Orangutans","Organisms","Pants","Parrots","Penguins","People","Pigeons","Pigs","Pineapples","Plants","Potatoes","Priests","Rats","Reptiles","Reptilians","Rhinos","Seagulls","Sheep","Siblings","Snakes","Spaghetti","Spiders","Squid","Squirrels","Stars","Students","Teachers","Tigers","Tomatoes","Trees","Vampires","Vegetables","Viruses","Vulcans","Warewolves","Weasels","Whales","Witches","Wizards","Wolves","Workers","Worms","Zebras"],r=["Abandon","Adapt","Advertise","Answer","Anticipate","Appreciate","Approach","Argue","Ask","Bite","Blossom","Blush","Breathe","Breed","Bribe","Burn","Calculate","Clean","Code","Communicate","Compute","Confess","Confiscate","Conjugate","Conjure","Consume","Contemplate","Crawl","Dance","Delegate","Devour","Develop","Differ","Discuss","Dissolve","Drink","Eat","Elaborate","Emancipate","Estimate","Expire","Extinguish","Extract","FAIL","Facilitate","Fall","Feed","Finish","Floss","Fly","Follow","Fragment","Freeze","Gather","Glow","Grow","Hex","Hide","Hug","Hurry","Improve","Intersect","Investigate","Jinx","Joke","Jubilate","Kiss","Laugh","Manage","Meet","Merge","Move","Object","Observe","Offer","Paint","Participate","Party","Perform","Plan","Pursue","Pierce","Play","Postpone","Pray","Proclaim","Question","Read","Reckon","Rejoice","Represent","Resize","Rhyme","Scream","Search","Select","Share","Shoot","Shout","Signal","Sing","Skate","Sleep","Smile","Smoke","Solve","Spell","Steer","Stink","Substitute","Swim","Taste","Teach","Terminate","Think","Type","Unite","Vanish","Worship"],a=["Absently","Accurately","Accusingly","Adorably","AllTheTime","Alone","Always","Amazingly","Angrily","Anxiously","Anywhere","Appallingly","Apparently","Articulately","Astonishingly","Badly","Barely","Beautifully","Blindly","Bravely","Brightly","Briskly","Brutally","Calmly","Carefully","Casually","Cautiously","Cleverly","Constantly","Correctly","Crazily","Curiously","Cynically","Daily","Dangerously","Deliberately","Delicately","Desperately","Discreetly","Eagerly","Easily","Euphoricly","Evenly","Everywhere","Exactly","Expectantly","Extensively","FAIL","Ferociously","Fiercely","Finely","Flatly","Frequently","Frighteningly","Gently","Gloriously","Grimly","Guiltily","Happily","Hard","Hastily","Heroically","High","Highly","Hourly","Humbly","Hysterically","Immensely","Impartially","Impolitely","Indifferently","Intensely","Jealously","Jovially","Kindly","Lazily","Lightly","Loudly","Lovingly","Loyally","Magnificently","Malevolently","Merrily","Mightily","Miserably","Mysteriously","NOT","Nervously","Nicely","Nowhere","Objectively","Obnoxiously","Obsessively","Obviously","Often","Painfully","Patiently","Playfully","Politely","Poorly","Precisely","Promptly","Quickly","Quietly","Randomly","Rapidly","Rarely","Recklessly","Regularly","Remorsefully","Responsibly","Rudely","Ruthlessly","Sadly","Scornfully","Seamlessly","Seldom","Selfishly","Seriously","Shakily","Sharply","Sideways","Silently","Sleepily","Slightly","Slowly","Slyly","Smoothly","Softly","Solemnly","Steadily","Sternly","Strangely","Strongly","Stunningly","Surely","Tenderly","Thoughtfully","Tightly","Uneasily","Vanishingly","Violently","Warmly","Weakly","Wearily","Weekly","Weirdly","Well","Well","Wickedly","Wildly","Wisely","Wonderfully","Yearly"],s=["Abominable","Accurate","Adorable","All","Alleged","Ancient","Angry","Angry","Anxious","Appalling","Apparent","Astonishing","Attractive","Awesome","Baby","Bad","Beautiful","Benign","Big","Bitter","Blind","Blue","Bold","Brave","Bright","Brisk","Calm","Camouflaged","Casual","Cautious","Choppy","Chosen","Clever","Cold","Cool","Crawly","Crazy","Creepy","Cruel","Curious","Cynical","Dangerous","Dark","Delicate","Desperate","Difficult","Discreet","Disguised","Dizzy","Dumb","Eager","Easy","Edgy","Electric","Elegant","Emancipated","Enormous","Euphoric","Evil","FAIL","Fast","Ferocious","Fierce","Fine","Flawed","Flying","Foolish","Foxy","Freezing","Funny","Furious","Gentle","Glorious","Golden","Good","Green","Green","Guilty","Hairy","Happy","Hard","Hasty","Hazy","Heroic","Hostile","Hot","Humble","Humongous","Humorous","Hysterical","Idealistic","Ignorant","Immense","Impartial","Impolite","Indifferent","Infuriated","Insightful","Intense","Interesting","Intimidated","Intriguing","Jealous","Jolly","Jovial","Jumpy","Kind","Laughing","Lazy","Liquid","Lonely","Longing","Loud","Loving","Loyal","Macabre","Mad","Magical","Magnificent","Malevolent","Medieval","Memorable","Mere","Merry","Mighty","Mischievous","Miserable","Modified","Moody","Most","Mysterious","Mystical","Needy","Nervous","Nice","Objective","Obnoxious","Obsessive","Obvious","Opinionated","Orange","Painful","Passionate","Perfect","Pink","Playful","Poisonous","Polite","Poor","Popular","Powerful","Precise","Preserved","Pretty","Purple","Quick","Quiet","Random","Rapid","Rare","Real","Reassuring","Reckless","Red","Regular","Remorseful","Responsible","Rich","Rude","Ruthless","Sad","Scared","Scary","Scornful","Screaming","Selfish","Serious","Shady","Shaky","Sharp","Shiny","Shy","Simple","Sleepy","Slow","Sly","Small","Smart","Smelly","Smiling","Smooth","Smug","Sober","Soft","Solemn","Square","Square","Steady","Strange","Strong","Stunning","Subjective","Successful","Surly","Sweet","Tactful","Tense","Thoughtful","Tight","Tiny","Tolerant","Uneasy","Unique","Unseen","Warm","Weak","Weird","WellCooked","Wild","Wise","Witty","Wonderful","Worried","Yellow","Young","Zealous"],c={_PLURALNOUN_:o,_VERB_:r,_ADVERB_:a,_ADJECTIVE_:s},l=["_ADJECTIVE__PLURALNOUN__VERB__ADVERB_"],u={generateRoomWithoutSeparator:function(){for(var e,t=n(l);i(t);)for(var o in c)e=n(c[o]),t=t.replace(o,e);return t}};t.exports=u},{}],35:[function(e,t){function n(){var e=$("#enter_room_field").val();e||(e=$("#enter_room_field").attr("room_name")),e&&(window.location.pathname="/"+e)}function i(e){var t=$("#enter_room_field").attr("placeholder");$("#enter_room_field").attr("placeholder",t+e.substr(0,1)),a=setTimeout(function(){i(e.substring(1,e.length))},70)}function o(){var e=c.generateRoomWithoutSeparator();$("#enter_room_field").attr("room_name",e),$("#enter_room_field").attr("placeholder",""),clearTimeout(a),i(e),s=setTimeout(o,1e4)}function r(){if($("#videoconference_page").hide(),$("#domain_name").text(window.location.protocol+"//"+window.location.host+"/"),interfaceConfig.SHOW_JITSI_WATERMARK){var e=$("#welcome_page_header div[class='watermark leftwatermark']");e&&e.length>0&&(e.css({display:"block"}),e.parent().get(0).href=interfaceConfig.JITSI_WATERMARK_LINK)}if(interfaceConfig.SHOW_BRAND_WATERMARK){var t=$("#welcome_page_header div[class='watermark rightwatermark']");t&&t.length>0&&(t.css({display:"block"}),t.parent().get(0).href=interfaceConfig.BRAND_WATERMARK_LINK,t.get(0).style.backgroundImage="url(images/rightwatermark.png)")}if(interfaceConfig.SHOW_POWERED_BY&&$("#welcome_page_header>a[class='poweredby']").css({display:"block"}),$("#enter_room_button").click(function(){n()
}),$("#enter_room_field").keydown(function(e){13===e.keyCode&&n()}),interfaceConfig.GENERATE_ROOMNAMES_ON_WELCOME_PAGE!==!1){var i,r;$("#reload_roomname").click(function(){clearTimeout(i),clearTimeout(r),o()}),$("#reload_roomname").show(),o()}$("#disable_welcome").click(function(){window.localStorage.welcomePageDisabled=$("#disable_welcome").is(":checked")})}var a,s,c=e("./RoomnameGenerator");t.exports=r},{"./RoomnameGenerator":34}],36:[function(e,t){function n(){i(),p=setInterval(i,1e4)}function i(){APP.xmpp.addToPresence("connectionQuality",o(u))}function o(e){return{bitrate_download:e.bitrate.download,bitrate_upload:e.bitrate.upload,packetLoss_total:e.packetLoss.total,packetLoss_download:e.packetLoss.download,packetLoss_upload:e.packetLoss.upload}}function r(e){return{bitrate:{download:e.bitrate_download,upload:e.bitrate_upload},packetLoss:{total:e.packetLoss_total,download:e.packetLoss_download,upload:e.packetLoss_upload}}}var a=e("events"),s=new a,c=e("../../service/connectionquality/CQEvents"),l=e("../../service/xmpp/XMPPEvents"),u={},d={},p=null,f={init:function(){APP.xmpp.addListener(l.REMOTE_STATS,this.updateRemoteStats),APP.statistics.addConnectionStatsListener(this.updateLocalStats),APP.statistics.addRemoteStatsStopListener(this.stopSendingStats)},updateLocalStats:function(e){u=e,s.emit(c.LOCALSTATS_UPDATED,100-u.packetLoss.total,u),null==p&&n()},updateRemoteStats:function(e,t){return null==t||null==t.packetLoss_total?void s.emit(c.REMOTESTATS_UPDATED,e,null,null):(d[e]=r(t),void s.emit(c.REMOTESTATS_UPDATED,e,100-t.packetLoss_total,d[e]))},stopSendingStats:function(){clearInterval(p),p=null,s.emit(c.STOP)},getStats:function(){return u},addListener:function(e,t){s.on(e,t)}};t.exports=f},{"../../service/connectionquality/CQEvents":71,"../../service/xmpp/XMPPEvents":75,events:77}],37:[function(e,t){function n(e,t){APP.RTC.getUserMediaWithConstraints(["screen"],e,t)}function i(){return"https://chrome.google.com/webstore/detail/"+config.chromeExtensionId}function o(e,t){try{for(var n=e.split("."),i=t.split("."),o=Math.max(n.length,i.length),r=0;o>r;r++){var a=0,s=0;if(r<n.length&&(a=parseInt(n[r])),r<i.length&&(s=parseInt(i[r])),isNaN(a)||isNaN(s))return!0;if(a!==s)return a>s}return!1}catch(c){return console.error("Failed to parse extension version",c),APP.UI.messageHandler.showError("dialog.error","dialog.detectext"),!0}}function r(e){return chrome.runtime?void chrome.runtime.sendMessage(config.chromeExtensionId,{getVersion:!0},function(t){if(!t||!t.version)return console.warn("Extension not installed?: ",chrome.runtime.lastError),void e(!1,!1);var n=t.version;console.log("Extension version is: "+n);var i=o(config.minChromeExtVersion,n);e(!i,i)}):void e(!1,!1)}function a(e,t){chrome.runtime.sendMessage(config.chromeExtensionId,{getStream:!0,sources:config.desktopSharingSources},function(n){return n?(console.log("Response from extension: "+n),void(n.streamId?APP.RTC.getUserMediaWithConstraints(["desktop"],function(t){e(t)},t,null,null,null,n.streamId):t("Extension failed to get the stream"))):void t(chrome.runtime.lastError)})}function s(e,t){v?a(e,t):(y&&alert("Jitsi Desktop Streamer requires update. Changes will take effect after next Chrome restart."),chrome.webstore.install(i(),function(e){console.log("Extension installed successfully",e),window.location.reload(!1)},function(e){console.log("Failed to install the extension",e),t(e),APP.UI.messageHandler.showError("dialog.error","dialog.failtoinstall")}))}function c(e){navigator.webkitGetUserMedia?"ext"==e?(g=s,console.info("Using Chrome extension for desktop sharing")):"webrtc"==e&&(g=n,console.info("Using Chrome WebRTC for desktop sharing")):(g=null,console.info("Desktop sharing disabled")),b=null}function l(){$("link[rel=chrome-webstore-item]").attr("href",i())}function u(e){console.error("Failed to obtain the stream to switch to",e),m=!1,h=!1,f(null)}function d(e){console.error("Failed to obtain the stream to switch to",e),m=!1}function p(){m=!1,_.emit(w.SWITCHING_DONE,h)}function f(e){_.emit(w.NEW_STREAM_CREATED,e,h,p)}var h=!1,m=!1,g=null,v=!1,y=!1,b=null,S=e("events"),_=new S,w=e("../../service/desktopsharing/DesktopSharingEventTypes");t.exports={isUsingScreenStream:function(){return h},isDesktopSharingEnabled:function(){if(null===b)if(g===s){var e=navigator.userAgent.toLowerCase(),t=parseInt(e.match(/chrome\/(\d+)\./)[1],10);console.log("Chrome version"+e,t),b=t>=34}else b=g===n;return b},init:function(){c(config.desktopSharing),config.chromeExtensionId&&(l(),r(function(e,t){v=e,y=t,console.info("Chrome extension installed: "+v+" updateRequired: "+y)})),_.emit(w.INIT)},addListener:function(e,t){_.on(t,e)},removeListener:function(e,t){_.removeListener(t,e)},toggleScreenSharing:function(){return m||!g?void console.warn("Switch in progress or no method defined"):(m=!0,void(h?APP.RTC.getUserMediaWithConstraints(["video"],function(e){h=!1,f(e)},u,config.resolution||"360"):g(function(e){h=!0,e.addEventListener("ended",function(){!m&&h&&APP.desktopsharing.toggleScreenSharing()}),f(e)},d)))}}},{"../../service/desktopsharing/DesktopSharingEventTypes":72,events:77}],38:[function(e,t){var n={67:{character:"C",id:"toggleChatPopover","function":APP.UI.toggleChat},70:{character:"F",id:"filmstripPopover","function":APP.UI.toggleFilmStrip},77:{character:"M",id:"mutePopover","function":APP.UI.toggleAudio},84:{character:"T","function":function(){APP.RTC.localAudio.isMuted()||APP.UI.toggleAudio()}},86:{character:"V",id:"toggleVideoPopover","function":APP.UI.toggleVideo}},i={init:function(){window.onkeyup=function(e){var t=e.which;$(":focus").is("input[type=text]")||$(":focus").is("input[type=password]")||$(":focus").is("textarea")?27===t&&$("#smileysContainer").is(":visible")&&APP.UI.toggleSmileys():"object"==typeof n[t]?n[t]["function"]():t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)&&APP.UI.clickOnVideo(t-"0".charCodeAt(0)+1)},window.onkeydown=function(e){$(":focus").is("input[type=text]")||$(":focus").is("input[type=password]")||$(":focus").is("textarea")||e.which==="T".charCodeAt(0)&&APP.RTC.localAudio.isMuted()&&APP.UI.toggleAudio()};var e=this;$("body").popover({selector:"[data-toggle=popover]",trigger:"click hover",content:function(){return this.getAttribute("content")+e.getShortcut(this.getAttribute("shortcut"))}})},getShortcut:function(e){for(var t in n)if(n.hasOwnProperty(t)&&n[t].id===e)return" ("+n[t].character+")";return""}};t.exports=i},{}],39:[function(e,t){function n(){APP.xmpp.addListener(c.MUC_MEMBER_JOINED,i),APP.xmpp.addListener(c.MUC_MEMBER_LEFT,o)}function i(e,t,n){var i={displayName:n};APP.xmpp.getConnection().disco.info(e,"",function(t){r(e,t)}),p[e]=i}function o(e){delete p[e],s()}function r(e,t){if(p[e]){var n=$(t).find('>query>feature[var="urn:xmpp:jingle:dtmf:0"]').length>0;a(e,n)}}function a(e,t){var n=p[e].supportsDtmf;p[e].supportsDtmf=t,t!=n&&s()}function s(){var e=!1;for(var t in p)if("undefined"!=typeof p[t].supportsDtmf&&p[t].supportsDtmf){e=!0;break}f!=e&&(f=e,d.emit(l.DTMF_SUPPORT_CHANGED,f))}var c=e("../../service/xmpp/XMPPEvents"),l=e("../../service/members/Events"),u=e("events"),d=new u,p={},f=!1,h={start:function(){n()},addListener:function(e,t){d.on(e,t)},removeListener:function(e,t){d.removeListener(e,t)}};t.exports=h},{"../../service/members/Events":73,"../../service/xmpp/XMPPEvents":75,events:77}],40:[function(e,t){function n(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return console.log("localstorage is not supported"),!1}}function i(){function e(){return(Math.random().toString(16)+"000000000").substr(2,8)}return e()+e()+e()+e()}var o,r="",a="",s=null;n()?(window.localStorage.jitsiMeetId||(window.localStorage.jitsiMeetId=i(),console.log("generated id",window.localStorage.jitsiMeetId)),o=window.localStorage.jitsiMeetId||"",r=window.localStorage.email||"",a=window.localStorage.displayname||"",s=window.localStorage.language):(console.log("local storage is not supported"),o=i());var c={setDisplayName:function(e){return a=e,window.localStorage.displayname=a,a},setEmail:function(e){return r=e,window.localStorage.email=e,r},getSettings:function(){return{email:r,displayName:a,uid:o,language:s}},setLanguage:function(e){s=e,window.localStorage.language=e}};t.exports=c},{}],41:[function(e,t){function n(e,t){this.name=e,this.lvl=t}n.prototype.log=function(e){this.lvl&&console.log(e)},n.prototype.info=function(e){this.lvl>1&&console.info(e)},n.prototype.fine=function(e){this.lvl>2&&console.log(e)},n.prototype.error=function(e){console.error(e)},t.exports=n},{}],42:[function(e,t){function n(){this.simulcastUtils=new o,this.logger=new i("SimulcastReceiver",1)}var i=e("./SimulcastLogger"),o=e("./SimulcastUtils"),r=e("../../service/RTC/MediaStreamTypes");n.prototype._remoteVideoSourceCache="",n.prototype._remoteMaps={msid2Quality:{},ssrc2Msid:{},msid2ssrc:{},receivingVideoStreams:{}},n.prototype._cacheRemoteVideoSources=function(e){this._remoteVideoSourceCache=this.simulcastUtils._getVideoSources(e)},n.prototype._restoreRemoteVideoSources=function(e){this.simulcastUtils._replaceVideoSources(e,this._remoteVideoSourceCache)},n.prototype._ensureGoogConference=function(e){var t;this.logger.info("Ensuring x-google-conference flag..."),this.simulcastUtils._indexOfArray("a=x-google-flag:conference",e)===this.simulcastUtils._emptyCompoundIndex&&(t=this.simulcastUtils._getVideoSources(e),t=["a=x-google-flag:conference"].concat(t),this.simulcastUtils._replaceVideoSources(e,t))},n.prototype._restoreSimulcastGroups=function(e){this._restoreRemoteVideoSources(e)},n.prototype.reverseTransformRemoteDescription=function(e){var t;return this.simulcastUtils.isValidDescription(e)?(config.enableSimulcast&&(t=e.sdp.split("\r\n"),this._restoreSimulcastGroups(t),e=new RTCSessionDescription({type:e.type,sdp:t.join("\r\n")})),e):e},o.prototype._ensureOrder=function(e){var t,n;t=this.parseMedia(e,["video"])[0],n=this._compileVideoSources(t),this._replaceVideoSources(e,n)},n.prototype._updateRemoteMaps=function(e){var t,n,i=this.simulcastUtils.parseMedia(e,["video"])[0];this._remoteMaps.msid2Quality={},this._remoteMaps.ssrc2Msid={},this._remoteMaps.msid2ssrc={};var o=this;i.groups&&0!==i.groups.length&&i.groups.forEach(function(e){"SIM"===e.semantics&&e.ssrcs&&0!==e.ssrcs.length&&(n=0,e.ssrcs.forEach(function(e){t=i.sources[e],o._remoteMaps.msid2Quality[t.msid]=n++,o._remoteMaps.ssrc2Msid[t.ssrc]=t.msid,o._remoteMaps.msid2ssrc[t.msid]=t.ssrc}))})},n.prototype._setReceivingVideoStream=function(e,t){this._remoteMaps.receivingVideoStreams[e]=t},n.prototype.getReceivingVideoStream=function(e){var t,n,i,o,r=0,a=this;if(config.enableSimulcast&&(e.getVideoTracks().some(function(t){return Object.keys(a._remoteMaps.receivingVideoStreams).some(function(n){var o=a._remoteMaps.receivingVideoStreams[n],r=a._remoteMaps.ssrc2Msid[o];return r==[e.id,t.id].join(" ")?(i=t,!0):void 0})}),!i))for(t=e.getVideoTracks(),n=0;n<t.length;n++)if(o=[e.id,t[n].id].join(" "),this._remoteMaps.msid2Quality[o]===r){i=t[n];break}return i?new webkitMediaStream([i]):e},n.prototype.getReceivingSSRC=function(e){var t=Strophe.getResourceFromJid(e),n=this._remoteMaps.receivingVideoStreams[t];if(!n){var i=APP.RTC.remoteStreams[e][r.VIDEO_TYPE],o=i.getOriginalStream(),a=o.getVideoTracks();if(a)for(var s=0;s<a.length;s++){var c=a[s],l=[o.id,c.id].join(" "),u=this._remoteMaps.msid2ssrc[l],d=this._remoteMaps.msid2Quality[l];0==d&&(n=u)}}return n},n.prototype.getReceivingVideoStreamBySSRC=function(e){var t,n,i,o=APP.xmpp.getJidFromSSRC(e);if(o&&APP.RTC.remoteStreams[o]){var a=APP.RTC.remoteStreams[o][r.VIDEO_TYPE],s=a.getOriginalStream(),c=s.getVideoTracks();if(c)for(i=0;i<c.length;i++){var l=c[i],u=[s.id,l.id].join(" "),d=this._remoteMaps.msid2ssrc[u];if(d==e){n=new webkitMediaStream([l]),t=a.sid;break}}}else console.debug(APP.RTC.remoteStreams,o,e);return{sid:t,stream:n}},n.prototype.getRemoteVideoStreamIdBySSRC=function(e){return this._remoteMaps.ssrc2Msid[e]},n.prototype.transformRemoteDescription=function(e){if(e&&e.sdp){var t=e.sdp.split("\r\n");this._updateRemoteMaps(t),this._cacheRemoteVideoSources(t),this.simulcastUtils._removeSimulcastGroup(t),-1!==e.sdp.indexOf("a=ssrc-group:SIM")&&this._ensureGoogConference(t),e=new RTCSessionDescription({type:e.type,sdp:t.join("\r\n")}),this.logger.fine(["Transformed remote description",e.sdp].join(" "))}return e},t.exports=n},{"../../service/RTC/MediaStreamTypes":64,"./SimulcastLogger":41,"./SimulcastUtils":44}],43:[function(e,t){function n(){this.simulcastUtils=new s,this.logger=new a("SimulcastSender",1)}function i(){n.call(this)}function o(){n.call(this)}function r(){n.call(this)}var a=e("./SimulcastLogger"),s=e("./SimulcastUtils");n.prototype.displayedLocalVideoStream=null,n.prototype._generateGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}(),n.prototype._generateRandomSSRC=function(){var e=0,t=4294967295;return Math.floor(Math.random()*(t-e))+e},n.prototype.getLocalVideoStream=function(){return null!=this.displayedLocalVideoStream?this.displayedLocalVideoStream:APP.RTC.localVideo.getOriginalStream()},i.prototype=Object.create(n.prototype),i.prototype._localExplosionMap={},i.prototype._isUsingScreenStream=!1,i.prototype._localVideoSourceCache="",i.prototype.reset=function(){this._localExplosionMap={},this._isUsingScreenStream=APP.desktopsharing.isUsingScreenStream()},i.prototype._cacheLocalVideoSources=function(e){this._localVideoSourceCache=this.simulcastUtils._getVideoSources(e)},i.prototype._restoreLocalVideoSources=function(e){this.simulcastUtils._replaceVideoSources(e,this._localVideoSourceCache)},i.prototype._appendSimulcastGroup=function(e){var t,n,i,o,r,a=2;for(this.logger.info("Appending simulcast group..."),t=this.simulcastUtils.parseMedia(e,["video"])[0],n=["a=ssrc-group:SIM"],r=[],o=0;a>o;o++)i=this._generateRandomSSRC(),n.push(i),t.base&&r.splice.apply(r,[r.length,0].concat([["a=ssrc:",i," cname:",t.base.cname].join(""),["a=ssrc:",i," msid:",t.base.msid].join("")])),this.logger.info(["Generated substream ",o," with SSRC ",i,"."].join(""));r.splice(0,0,n.join(" ")),this.simulcastUtils._replaceVideoSources(e,r)},i.prototype._ensureSimulcastGroup=function(e){this.logger.info("Ensuring simulcast group..."),this.simulcastUtils._indexOfArray("a=ssrc-group:SIM",e)===this.simulcastUtils._emptyCompoundIndex?(this._appendSimulcastGroup(e),this._cacheLocalVideoSources(e)):this._restoreLocalVideoSources(e)},i.prototype._explodeSimulcastSenderSources=function(e){var t,n,i,o,r,a;this.logger.info("Exploding local video sources..."),r=this.simulcastUtils.parseMedia(e,["video"])[0],a=this,r.groups&&0!==r.groups.length&&r.groups.forEach(function(e){"SIM"===e.semantics&&e.ssrcs.forEach(function(e){a._localExplosionMap[e]?n=a._localExplosionMap[e]:(i=r.sources[e].msid.substring(0,r.sources[e].msid.indexOf(" ")),o=a._generateGuid(),n=[i,o].join(" "),a._localExplosionMap[e]=n),r.sources[e].msid=n})}),t=this.simulcastUtils._compileVideoSources(r),this.simulcastUtils._replaceVideoSources(e,t)},i.prototype.getUserMedia=function(e,t,n){navigator.webkitGetUserMedia(e,function(e){t(e)},n)},i.prototype.reverseTransformLocalDescription=function(e){var t;return!this.simulcastUtils.isValidDescription(e)||this._isUsingScreenStream?e:(t=e.sdp.split("\r\n"),this._explodeSimulcastSenderSources(t),e=new RTCSessionDescription({type:e.type,sdp:t.join("\r\n")}),this.logger.fine(["Exploded local video sources",e.sdp].join(" ")),e)},i.prototype.transformAnswer=function(e){if(!this.simulcastUtils.isValidDescription(e)||this._isUsingScreenStream)return e;var t=e.sdp.split("\r\n");return this._ensureSimulcastGroup(t),e=new RTCSessionDescription({type:e.type,sdp:t.join("\r\n")}),this.logger.fine(["Transformed answer",e.sdp].join(" ")),e},i.prototype.transformLocalDescription=function(e){return e},i.prototype._setLocalVideoStreamEnabled=function(){},i.prototype.constructor=i,o.prototype=Object.create(n.prototype),o.prototype.localStream=null,o.prototype._localMaps={msids:[],msid2ssrc:{}},o.prototype._groupLocalVideoSources=function(e){var t,n,i,o=[];this.logger.info("Grouping local video sources..."),n=this.simulcastUtils.parseMedia(e,["video"])[0];for(i in n.sources)this._localMaps.msid2ssrc[n.sources[i].msid.split(" ")[1]]=i;var r=this;this._localMaps.msids.forEach(function(e){o.push(r._localMaps.msid2ssrc[e])}),n.groups||(n.groups=[]),n.groups.push({semantics:"SIM",ssrcs:o}),t=this.simulcastUtils._compileVideoSources(n),this.simulcastUtils._replaceVideoSources(e,t)},o.prototype.getUserMedia=function(e,t,n){var i={audio:!1,video:{mandatory:{maxWidth:320,maxHeight:180,maxFrameRate:15}}};this.logger.info("HQ constraints: ",e),this.logger.info("LQ constraints: ",i);var o=this;navigator.webkitGetUserMedia(e,function(e){o.localStream=e,o._localMaps.msids=[],o._localMaps.msid2ssrc={},o._localMaps.msids.push(e.getVideoTracks()[0].id),navigator.webkitGetUserMedia(i,function(e){o.displayedLocalVideoStream=e,o._localMaps.msids.splice(0,0,e.getVideoTracks()[0].id),o.localStream.addTrack(e.getVideoTracks()[0]),t(o.localStream)},n)},n)},o.prototype.reverseTransformLocalDescription=function(e){var t;return this.simulcastUtils.isValidDescription(e)?(t=e.sdp.split("\r\n"),this._groupLocalVideoSources(t),e=new RTCSessionDescription({type:e.type,sdp:t.join("\r\n")}),this.logger.fine("Grouped local video sources"),this.logger.fine(e.sdp),e):e},o.prototype.transformAnswer=function(e){return e},o.prototype.transformLocalDescription=function(e){var t=e.sdp.split("\r\n");return this.simulcastUtils._removeSimulcastGroup(t),e=new RTCSessionDescription({type:e.type,sdp:t.join("\r\n")}),this.logger.fine("Transformed local description"),this.logger.fine(e.sdp),e},o.prototype._setLocalVideoStreamEnabled=function(e,t){var n,i=this;this.logger.log(["Requested to",t?"enable":"disable",e].join(" ")),Object.keys(this._localMaps.msid2ssrc).some(function(t){return i._localMaps.msid2ssrc[t]==e?(n=t,!0):void 0})&&i.localStream.getVideoTracks().some(function(e){return e.id===n?(e.enabled=t,!0):void 0})?(this.logger.log([n,t?"enabled":"disabled"].join(" ")),$(document).trigger(t?"simulcastlayerstarted":"simulcastlayerstopped")):this.logger.error("I don't have a local stream with SSRC "+e)},o.prototype.constructor=o,r.prototype=Object.create(n.prototype),r.prototype.getUserMedia=function(e,t,n){navigator.webkitGetUserMedia(e,function(e){t(e)},n)},r.prototype.reverseTransformLocalDescription=function(e){return e},r.prototype.transformAnswer=function(e){return e},r.prototype.transformLocalDescription=function(e){return e},r.prototype._setLocalVideoStreamEnabled=function(){},r.prototype.constructor=r,t.exports={"native":i,no:r}},{"./SimulcastLogger":41,"./SimulcastUtils":44}],44:[function(e,t){function n(){this.logger=new i("SimulcastUtils",1)}var i=e("./SimulcastLogger");n.prototype._emptyCompoundIndex={},n.prototype._replaceVideoSources=function(e,t){var n,i=!1,o=-1,r=0;for(this.logger.info("Replacing video sources..."),n=0;n<e.length&&(!i||"m="!==e[n].substring(0,"m=".length));n++)i||"m=video "!==e[n].substring(0,"m=video ".length)||(i=!0),!i||"a=ssrc:"!==e[n].substring(0,"a=ssrc:".length)&&"a=ssrc-group:"!==e[n].substring(0,"a=ssrc-group:".length)||(-1===o&&(o=n),r++);e.splice.apply(e,[o,r].concat(t))},n.prototype.isValidDescription=function(e){return e&&null!=e&&e.type&&""!=e.type&&e.sdp&&""!=e.sdp},n.prototype._getVideoSources=function(e){var t,n=!1,i=[];for(this.logger.info("Getting video sources..."),t=0;t<e.length&&(!n||"m="!==e[t].substring(0,"m=".length));t++)n||"m=video "!==e[t].substring(0,"m=video ".length)||(n=!0),n&&"a=ssrc:"===e[t].substring(0,"a=ssrc:".length)&&i.push(e[t]),n&&"a=ssrc-group:"===e[t].substring(0,"a=ssrc-group:".length)&&i.push(e[t]);return i},n.prototype.parseMedia=function(e,t){var n,i,o,r,a,s,c,l,u,d,p=[],f=!0;for(this.logger.info("Parsing media sources..."),n=0;n<e.length;n++)"m="===e[n].substring(0,"m=".length)?(i=e[n].substr("m=".length,e[n].indexOf(" ")-"m=".length),f=void 0!==t&&-1===t.indexOf(i),f||(o={type:i,sources:{},groups:[]},p.push(o))):f||"a=ssrc:"!==e[n].substring(0,"a=ssrc:".length)?f||"a=ssrc-group:"!==e[n].substring(0,"a=ssrc-group:".length)?f||"a=sendrecv"!==e[n].substring(0,"a=sendrecv".length)&&"a=recvonly"!==e[n].substring(0,"a=recvonly".length)&&"a=sendonly"!==e[n].substring(0,"a=sendonly".length)&&"a=inactive"!==e[n].substring(0,"a=inactive".length)||(o.direction=e[n].substring("a=".length)):(r=e[n].indexOf(" "),d=e[n].substr(0,r).substr("a=ssrc-group:".length),a=e[n].substr(r).trim().split(" "),u={semantics:d,ssrcs:a},o.groups.push(u)):(r=e[n].indexOf(" "),c=e[n].substring("a=ssrc:".length,r),void 0===o.sources[c]&&(s={ssrc:c},o.sources[c]=s),l=e[n].substr(r+1).split(":",2)[0],s[l]=e[n].substr(r+1).split(":",2)[1],void 0===o.base&&(o.base=s));return p},n.prototype._indexOfArray=function(e,t,n){var i,o,r=t.length;for(n||(n=0),o=n;r>o;o++)if(i=t[o].indexOf(e),-1!==i)return{row:o,column:i};return this._emptyCompoundIndex},n.prototype._removeSimulcastGroup=function(e){var t;for(t=e.length-1;t>=0;t--)-1!==e[t].indexOf("a=ssrc-group:SIM")&&e.splice(t,1)},n.prototype._compileVideoSources=function(e){var t,n=[],i=[];if(this.logger.info("Compiling video sources..."),e.groups&&0!==e.groups.length&&e.groups.forEach(function(t){t.ssrcs&&0!==t.ssrcs.length&&(n.push([["a=ssrc-group:",t.semantics].join(""),t.ssrcs.join(" ")].join(" ")),t.ssrcs.forEach(function(t){i.push(t),n.splice.apply(n,[n.length,0].concat([["a=ssrc:",t," cname:",e.sources[t].cname].join(""),["a=ssrc:",t," msid:",e.sources[t].msid].join("")]))}))}),e.sources)for(t in e.sources)-1===i.indexOf(t)&&n.splice.apply(n,[n.length,0].concat([["a=ssrc:",t," cname:",e.sources[t].cname].join(""),["a=ssrc:",t," msid:",e.sources[t].msid].join("")]));return n},t.exports=n},{"./SimulcastLogger":41}],45:[function(e,t){function n(){if(this.simulcastUtils=new s,this.simulcastReceiver=new a,config.enableSimulcast){var e=window.chrome,t=window.navigator.vendor;if(null===e||void 0===e||"Google Inc."!==t||window.navigator.appVersion.match(/Chromium\//))this.simulcastSender=new o;else{var n=parseInt(window.navigator.appVersion.match(/Chrome\/(\d+)\./)[1],10);this.simulcastSender=n>37?new r:new o}}else this.simulcastSender=new o;APP.RTC.addListener(c.SIMULCAST_LAYER_CHANGED,function(e){e.forEach(function(e){var t=e.simulcastLayer.primarySSRC;l._setReceivingVideoStream(e.endpoint,t)})}),APP.RTC.addListener(c.SIMULCAST_START,function(e){var t=e.primarySSRC;l._setLocalVideoStreamEnabled(t,!0)}),APP.RTC.addListener(c.SIMULCAST_STOP,function(e){var t=e.primarySSRC;l._setLocalVideoStreamEnabled(t,!1)})}var i=e("./SimulcastSender"),o=i.no,r=i["native"],a=e("./SimulcastReceiver"),s=e("./SimulcastUtils"),c=e("../../service/RTC/RTCEvents");n.prototype.reverseTransformRemoteDescription=function(e){return this.simulcastReceiver.reverseTransformRemoteDescription(e)},n.prototype.transformRemoteDescription=function(e){return this.simulcastReceiver.transformRemoteDescription(e)},n.prototype.getRemoteVideoStreamIdBySSRC=function(e){return this.simulcastReceiver.getRemoteVideoStreamIdBySSRC(e)},n.prototype.getReceivingVideoStream=function(e){return this.simulcastReceiver.getReceivingVideoStream(e)},n.prototype.transformLocalDescription=function(e){return this.simulcastSender.transformLocalDescription(e)},n.prototype.getLocalVideoStream=function(){return this.simulcastSender.getLocalVideoStream()},n.prototype.getUserMedia=function(e,t,n){this.simulcastSender.getUserMedia(e,t,n)},n.prototype.reverseTransformLocalDescription=function(e){return this.simulcastSender.reverseTransformLocalDescription(e)},n.prototype.transformAnswer=function(e){return this.simulcastSender.transformAnswer(e)},n.prototype.getReceivingSSRC=function(e){return this.simulcastReceiver.getReceivingSSRC(e)},n.prototype.getReceivingVideoStreamBySSRC=function(e){return this.simulcastReceiver.getReceivingVideoStreamBySSRC(e)},n.prototype.parseMedia=function(e,t){var n=e.sdp.split("\r\n");return this.simulcastUtils.parseMedia(n,t)},n.prototype._setReceivingVideoStream=function(e,t){this.simulcastReceiver._setReceivingVideoStream(e,t)},n.prototype._setLocalVideoStreamEnabled=function(e,t){this.simulcastSender._setLocalVideoStreamEnabled(e,t)},n.prototype.resetSender=function(){"function"==typeof this.simulcastSender.reset&&this.simulcastSender.reset()};var l=new n;t.exports=l},{"../../service/RTC/RTCEvents":66,"./SimulcastReceiver":42,"./SimulcastSender":43,"./SimulcastUtils":44}],46:[function(e,t){function n(e){for(var t=0,n=e.length,i=0;n>i;i++)t<e[i]&&(t=e[i]);return parseFloat(((t-127)/128).toFixed(3))}function i(e,t){var n=0,i=t-e;return n=i>.2?t-.2:-.4>i?t+.4:e,parseFloat(n.toFixed(3))}function o(e,t,n,i){window.AudioContext=window.AudioContext||window.webkitAudioContext,this.stream=e,this.intervalId=null,this.intervalMilis=t,this.eventEmitter=i,this.audioLevel=0,this.statisticsService=n}var r=2048,a=.8;o.prototype.start=function(){if(!config.disableAudioLevels&&window.AudioContext){var e=new AudioContext,t=e.createAnalyser();t.smoothingTimeConstant=a,t.fftSize=r;var o=e.createMediaStreamSource(this.stream);o.connect(t);var s=this;this.intervalId=setInterval(function(){var e=new Uint8Array(t.frequencyBinCount);t.getByteTimeDomainData(e);var o=n(e);o!=s.audioLevel&&(s.audioLevel=i(o,s.audioLevel),s.eventEmitter.emit("statistics.audioLevel",s.statisticsService.LOCAL_JID,s.audioLevel))},this.intervalMilis)}},o.prototype.stop=function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)},t.exports=o},{}],47:[function(e,t){function n(e,t){return!t||0>=t||!e||0>=e?0:Math.round(e/t*100)}function i(e,t){if(!u[APP.RTC.getBrowserType()][t])throw"The property isn't supported!";var n=u[APP.RTC.getBrowserType()][t];return APP.RTC.getBrowserType()==l.RTC_BROWSER_CHROME?e.stat(n):e[n]}function o(){this.ssrc2Loss={},this.ssrc2AudioLevel={},this.ssrc2bitrate={},this.ssrc2resolution={}}function r(e){return Math.min(Math.max(e,0),1)}function a(e,t,n,i){this.peerconnection=e,this.baselineAudioLevelsReport=null,this.currentAudioLevelsReport=null,this.currentStatsReport=null,this.baselineStatsReport=null,this.audioLevelsIntervalId=null,this.eventEmitter=i,this.GATHER_INTERVAL=15e3,this.LOG_INTERVAL=6e4,this.gatherStatsIntervalId=null,this.logStatsIntervalId=null,this.statsToBeLogged={timestamps:[],stats:{}},this.audioLevelsIntervalMilis=t,this.statsIntervalId=null,this.statsIntervalMilis=n,this.jid2stats={}}function s(e,t,n){return"googCandidatePair"==t&&"googChannelId"==n?!1:"ssrc"!=t||"googTrackId"!=n&&"transportId"!=n&&"ssrc"!=n?!0:!1}function c(e,t){return"googCertificate"==e.substring(0,15)||"googTrack"==e.substring(0,9)||"googLibjingleSession"==e.substring(0,20)?!1:"googComponent"==t?!1:!0}var l=e("../../service/RTC/RTCBrowserType");o.bandwidth={},o.bitrate={},o.packetLoss=null,o.prototype.setSsrcLoss=function(e,t){this.ssrc2Loss[e]=t},o.prototype.setSsrcResolution=function(e,t){null===t&&this.ssrc2resolution[e]?delete this.ssrc2resolution[e]:null!==t&&(this.ssrc2resolution[e]=t)},o.prototype.setSsrcBitrate=function(e,t){this.ssrc2bitrate[e]?(this.ssrc2bitrate[e].download+=t.download,this.ssrc2bitrate[e].upload+=t.upload):this.ssrc2bitrate[e]=t},o.prototype.setSsrcAudioLevel=function(e,t){this.ssrc2AudioLevel[e]=r(t)},o.transport=[],t.exports=a,a.prototype.stop=function(){this.audioLevelsIntervalId&&(clearInterval(this.audioLevelsIntervalId),this.audioLevelsIntervalId=null),this.statsIntervalId&&(clearInterval(this.statsIntervalId),this.statsIntervalId=null),this.logStatsIntervalId&&(clearInterval(this.logStatsIntervalId),this.logStatsIntervalId=null),this.gatherStatsIntervalId&&(clearInterval(this.gatherStatsIntervalId),this.gatherStatsIntervalId=null)},a.prototype.errorCallback=function(e){console.error("Get stats error",e),this.stop()},a.prototype.start=function(){var e=this;config.disableAudioLevels||(this.audioLevelsIntervalId=setInterval(function(){e.peerconnection.getStats(function(t){var n=null;n=t&&t.result&&"function"==typeof t.result?t.result():t,e.currentAudioLevelsReport=n,e.processAudioLevelReport(),e.baselineAudioLevelsReport=e.currentAudioLevelsReport},e.errorCallback)},e.audioLevelsIntervalMilis)),config.disableStats||navigator.mozGetUserMedia||(this.statsIntervalId=setInterval(function(){e.peerconnection.getStats(function(t){var n=null;n=t&&t.result&&"function"==typeof t.result?t.result():t,e.currentStatsReport=n;try{e.processStatsReport()}catch(i){console.error("Unsupported key:"+i,i)}e.baselineStatsReport=e.currentStatsReport},e.errorCallback)},e.statsIntervalMilis)),config.logStats&&!navigator.mozGetUserMedia&&(this.gatherStatsIntervalId=setInterval(function(){e.peerconnection.getStats(function(t){e.addStatsToBeLogged(t.result())},function(){})},this.GATHER_INTERVAL),this.logStatsIntervalId=setInterval(function(){e.logStats()},this.LOG_INTERVAL))},a.prototype.addStatsToBeLogged=function(e){var t=this,n=this.statsToBeLogged.timestamps.length;this.statsToBeLogged.timestamps.push((new Date).getTime()),e.map(function(e){if(c(e.id,e.type)){var i=t.statsToBeLogged.stats[e.id];i||(i=t.statsToBeLogged.stats[e.id]={}),i.type=e.type,e.names().map(function(t){if(s(e.id,e.type,t)){var o=i[t];for(o||(o=i[t]=[]);o.length<n;)o.push(null);o.push(e.stat(t))}})}})},a.prototype.logStats=function(){APP.xmpp.sendLogs(this.statsToBeLogged)&&(this.statsToBeLogged.stats={},this.statsToBeLogged.timestamps=[])};var u={};u[l.RTC_BROWSER_FIREFOX]={ssrc:"ssrc",packetsReceived:"packetsReceived",packetsLost:"packetsLost",packetsSent:"packetsSent",bytesReceived:"bytesReceived",bytesSent:"bytesSent"},u[l.RTC_BROWSER_CHROME]={receiveBandwidth:"googAvailableReceiveBandwidth",sendBandwidth:"googAvailableSendBandwidth",remoteAddress:"googRemoteAddress",transportType:"googTransportType",localAddress:"googLocalAddress",activeConnection:"googActiveConnection",ssrc:"ssrc",packetsReceived:"packetsReceived",packetsSent:"packetsSent",packetsLost:"packetsLost",bytesReceived:"bytesReceived",bytesSent:"bytesSent",googFrameHeightReceived:"googFrameHeightReceived",googFrameWidthReceived:"googFrameWidthReceived",googFrameHeightSent:"googFrameHeightSent",googFrameWidthSent:"googFrameWidthSent",audioInputLevel:"audioInputLevel",audioOutputLevel:"audioOutputLevel"},a.prototype.processStatsReport=function(){if(this.baselineStatsReport){for(var e in this.currentStatsReport){var t=this.currentStatsReport[e];try{(i(t,"receiveBandwidth")||i(t,"sendBandwidth"))&&(o.bandwidth={download:Math.round(i(t,"receiveBandwidth")/1e3),upload:Math.round(i(t,"sendBandwidth")/1e3)})}catch(r){}if("googCandidatePair"!=t.type){if("candidatepair"==t.type){if("succeeded"==t.state)continue;var a=this.currentStatsReport[t.localCandidateId],s=this.currentStatsReport[t.remoteCandidateId];o.transport.push({localip:a.ipAddress+":"+a.portNumber,ip:s.ipAddress+":"+s.portNumber,type:a.transport})}if("ssrc"==t.type||"outboundrtp"==t.type||"inboundrtp"==t.type){var c=this.baselineStatsReport[e];if(c){var l=i(t,"ssrc");if(l){var u=APP.xmpp.getJidFromSSRC(l);if(!u&&Date.now()-t.timestamp<3e3)console.warn("No jid for ssrc: "+l);else{var d=this.jid2stats[u];d||(d=new o,this.jid2stats[u]=d);var p=!0,f="packetsReceived";if(i(t,f)||(p=!1,f="packetsSent",i(t,f))){var h=i(t,f);(!h||0>h)&&(h=0);var m=i(c,f);(!m||0>m)&&(m=0);var g=h-m;(!g||0>g)&&(g=0);var v=i(t,"packetsLost");(!v||0>v)&&(v=0);var y=i(c,"packetsLost");(!y||0>y)&&(y=0);var b=v-y;(!b||0>b)&&(b=0);var S=g+b;d.setSsrcLoss(l,{packetsTotal:S,packetsLost:b,isDownloadStream:p});var _=0,w=0;i(t,"bytesReceived")&&(_=i(t,"bytesReceived")-i(c,"bytesReceived")),i(t,"bytesSent")&&(w=i(t,"bytesSent")-i(c,"bytesSent"));var A=Math.round((t.timestamp-c.timestamp)/1e3);_=0>=_||0>=A?0:Math.round(8*_/A/1e3),w=0>=w||0>=A?0:Math.round(8*w/A/1e3),d.setSsrcBitrate(l,{download:_,upload:w});var x={height:null,width:null};try{i(t,"googFrameHeightReceived")&&i(t,"googFrameWidthReceived")?(x.height=i(t,"googFrameHeightReceived"),x.width=i(t,"googFrameWidthReceived")):i(t,"googFrameHeightSent")&&i(t,"googFrameWidthSent")&&(x.height=i(t,"googFrameHeightSent"),x.width=i(t,"googFrameWidthSent"))
}catch(r){}x.height&&x.width?d.setSsrcResolution(l,x):d.setSsrcResolution(l,null)}else console.warn("No packetsReceived nor packetSent stat found")}}}else console.warn(i(t,"ssrc")+" not enough data")}}else{var P,T,C,E;try{P=i(t,"remoteAddress"),T=i(t,"transportType"),C=i(t,"localAddress"),E=i(t,"activeConnection")}catch(r){}if(!P||!T||!C||"true"!=E)continue;for(var k=!1,R=0;R<o.transport.length;R++)o.transport[R].ip==P&&o.transport[R].type==T&&o.transport[R].localip==C&&(k=!0);if(k)continue;o.transport.push({localip:C,ip:P,type:T})}}var L=this,D={download:0,upload:0},M={download:0,upload:0},I=0,N=0,j={};Object.keys(this.jid2stats).forEach(function(e){Object.keys(L.jid2stats[e].ssrc2Loss).forEach(function(t){var n="upload";L.jid2stats[e].ssrc2Loss[t].isDownloadStream&&(n="download"),D[n]+=L.jid2stats[e].ssrc2Loss[t].packetsTotal,M[n]+=L.jid2stats[e].ssrc2Loss[t].packetsLost}),Object.keys(L.jid2stats[e].ssrc2bitrate).forEach(function(t){I+=L.jid2stats[e].ssrc2bitrate[t].download,N+=L.jid2stats[e].ssrc2bitrate[t].upload,delete L.jid2stats[e].ssrc2bitrate[t]}),j[e]=L.jid2stats[e].ssrc2resolution}),o.bitrate={upload:N,download:I},o.packetLoss={total:n(M.download+M.upload,D.download+D.upload),download:n(M.download,D.download),upload:n(M.upload,D.upload)},this.eventEmitter.emit("statistics.connectionstats",{bitrate:o.bitrate,packetLoss:o.packetLoss,bandwidth:o.bandwidth,resolution:j,transport:o.transport}),o.transport=[]}},a.prototype.processAudioLevelReport=function(){if(this.baselineAudioLevelsReport)for(var e in this.currentAudioLevelsReport){var t=this.currentAudioLevelsReport[e];if("ssrc"==t.type){var n=this.baselineAudioLevelsReport[e];if(n){var r=i(t,"ssrc"),a=APP.xmpp.getJidFromSSRC(r);if(!a&&Date.now()-t.timestamp<3e3)console.warn("No jid for ssrc: "+r);else{var s=this.jid2stats[a];s||(s=new o,this.jid2stats[a]=s);var c=null;try{c=i(t,"audioInputLevel"),c||(c=i(t,"audioOutputLevel"))}catch(l){return console.warn("Audio Levels are not available in the statistics."),void clearInterval(this.audioLevelsIntervalId)}c&&(c/=32767,s.setSsrcAudioLevel(r,c),a!=APP.xmpp.myJid()&&this.eventEmitter.emit("statistics.audioLevel",a,c))}}else console.warn(i(t,"ssrc")+" not enough data")}}}},{"../../service/RTC/RTCBrowserType":65}],48:[function(e,t){function n(){f&&(f.stop(),f=null)}function i(){h&&(h.stop(),p.emit("statistics.stop"),h=null)}function o(e){h&&(h.stop(),h=null),h=new c(e,200,2e3,p),h.start()}function r(e){0!==e.getOriginalStream().getAudioTracks().length&&(f=new s(e.getOriginalStream(),200,m,p),f.start())}function a(e){i(),e&&(n(),p.removeAllListeners())}var s=e("./LocalStatsCollector.js"),c=e("./RTPStatsCollector.js"),l=e("events"),u=e("../../service/RTC/StreamEventTypes.js"),d=e("../../service/xmpp/XMPPEvents"),p=new l,f=null,h=null,m={LOCAL_JID:"local",addAudioLevelListener:function(e){p.on("statistics.audioLevel",e)},removeAudioLevelListener:function(e){p.removeListener("statistics.audioLevel",e)},addConnectionStatsListener:function(e){p.on("statistics.connectionstats",e)},removeConnectionStatsListener:function(e){p.removeListener("statistics.connectionstats",e)},addRemoteStatsStopListener:function(e){p.on("statistics.stop",e)},removeRemoteStatsStopListener:function(e){p.removeListener("statistics.stop",e)},stop:function(){n(),i(),p&&p.removeAllListeners()},stopRemoteStatistics:function(){i()},start:function(){APP.RTC.addStreamListener(r,u.EVENT_TYPE_LOCAL_CREATED),APP.xmpp.addListener(d.DISPOSE_CONFERENCE,a),APP.xmpp.addListener(d.CALL_INCOMING,function(e){o(e.peerconnection)})}};t.exports=m},{"../../service/RTC/StreamEventTypes.js":68,"../../service/xmpp/XMPPEvents":75,"./LocalStatsCollector.js":46,"./RTPStatsCollector.js":47,events:77}],49:[function(e,t){function n(){$("[data-i18n]").i18n()}function i(){for(var e=window.location.search.substring(1),t=e.split("&"),n=0;n<t.length;n++){var i=t[n].split("=");if("lang"==i[0])return i[1]}return null}var o=e("i18next-client"),r=e("../../service/translation/languages"),a=e("../settings/Settings"),s=r.EN;o.addPostProcessor("resolveAppName",function(e){return e.replace("__app__",interfaceConfig.APP_NAME)});var c={detectLngQS:"lang",useCookie:!1,fallbackLng:s,load:"unspecific",resGetPath:"lang/__ns__-__lng__.json",ns:{namespaces:["main","languages"],defaultNs:"main"},lngWhitelist:r.getLanguages(),fallbackOnNull:!0,fallbackOnEmpty:!0,useDataAttrOptions:!0,defaultValueFromContent:!1,app:interfaceConfig.APP_NAME,getAsync:!1,defaultValueFromContent:!1,customLoad:function(e,t,n,i){var a="lang/__ns__-__lng__.json";e===r.EN&&(a="lang/__ns__.json");var s=o.functions.applyReplacement(a,{lng:e,ns:t});o.functions.ajax({url:s,success:function(e){o.functions.log("loaded: "+s),i(null,e)},error:function(e,t,n){if(t&&200==t||e&&e.status&&200==e.status)o.functions.error("There is a typo in: "+s);else if(t&&404==t||e&&e.status&&404==e.status)o.functions.log("Does not exist: "+s);else{var r=t?t:e&&e.status?e.status:null;o.functions.log(r+" when loading "+s)}i(n,{})},dataType:"json",async:n.getAsync})}};t.exports={init:function(e){var t=c;if(!e&&(e=i(),!e)){var r=a.getSettings();r&&(e=r.language)}e&&(t.lng=e),o.init(t,n)},translateString:function(e,t){return o.t(e,t)},setLanguage:function(e){e||(e=s),o.setLng(e,c,n)},getCurrentLanguage:function(){return o.lng()},translateElement:function(e){e.i18n()},generateTranslatonHTML:function(e,t){var n='<span data-i18n="'+e+'"';return t&&(n+=' data-i18n-options="'+JSON.stringify(t)+'"'),n+=">",n+=this.translateString(e,t),n+="</span>"}}},{"../../service/translation/languages":74,"../settings/Settings":40,"i18next-client":79}],50:[function(e,t){function n(e,t,n,i){this.me=e,this.sid=t,this.connection=n,this.initiator=null,this.responder=null,this.isInitiator=null,this.peerjid=null,this.state=null,this.localSDP=null,this.remoteSDP=null,this.relayedStreams=[],this.startTime=null,this.stopTime=null,this.media_constraints=null,this.pc_constraints=null,this.ice_config={},this.drip_container=[],this.service=i,this.usetrickle=!0,this.usepranswer=!1,this.usedrip=!1,this.hadstuncandidate=!1,this.hadturncandidate=!1,this.lasticecandidate=!1,this.statsinterval=null,this.reason=null,this.addssrc=[],this.removessrc=[],this.pendingop=null,this.switchstreams=!1,this.wait=!0,this.localStreamsSSRC=null,this.videoMuteByUser=!1,this.modifySourcesQueue=l.queue(this._modifySources.bind(this),1),this.modifySourcesQueue.pause()}function i(e,t){switch(t.peerconnection.iceConnectionState){case"checking":t.timeChecking=(new Date).getTime(),t.firstconnect=!0;break;case"completed":case"connected":if(t.firstconnect){t.firstconnect=!1;var n={};n.setupTime=(new Date).getTime()-t.timeChecking,t.peerconnection.getStats(function(e){e&&e.result&&e.result().forEach(function(e){"googCandidatePair"==e.type&&"true"==e.stat("googActiveConnection")&&(n.localCandidateType=e.stat("googLocalCandidateType"),n.remoteCandidateType=e.stat("googRemoteCandidateType"),n.candidatePair=e.stat("googLocalCandidateType")+";"+e.stat("googRemoteCandidateType"),0===e.stat("googRemoteAddress").indexOf("[")&&(n.ipv6=!0))})})}}}function o(e){console.log("sendkeyframe",e.iceConnectionState),"connected"===e.iceConnectionState&&e.setRemoteDescription(e.remoteDescription,function(){e.createAnswer(function(t){e.setLocalDescription(t,function(){},function(e){console.log("triggerKeyframe setLocalDescription failed",e),APP.UI.messageHandler.showError()})},function(e){console.log("triggerKeyframe createAnswer failed",e),APP.UI.messageHandler.showError()})},function(e){console.log("triggerKeyframe setRemoteDescription failed",e),APP.UI.messageHandler.showError()})}var r=e("./TraceablePeerConnection"),a=e("./SDPDiffer"),s=e("./SDPUtil"),c=e("./SDP"),l=(e("../../service/RTC/RTCBrowserType"),e("async"));n.prototype.updateModifySourcesQueue=function(){var e=this.peerconnection.signalingState,t=this.peerconnection.iceConnectionState;"stable"===e&&"connected"===t?this.modifySourcesQueue.resume():this.modifySourcesQueue.pause()},n.prototype.initiate=function(e,t){var n=this;return null!==this.state?void console.error("attempt to initiate on session "+this.sid+"in state "+this.state):(this.isInitiator=t,this.state="pending",this.initiator=t?this.me:e,this.responder=t?e:this.me,this.peerjid=e,this.hadstuncandidate=!1,this.hadturncandidate=!1,this.lasticecandidate=!1,this.peerconnection=new r(this.connection.jingle.ice_config,this.connection.jingle.pc_constraints),this.peerconnection.onicecandidate=function(e){n.sendIceCandidate(e.candidate)},this.peerconnection.onaddstream=function(e){"default"!==e.stream.id?(console.log("REMOTE STREAM ADDED: "+e.stream+" - "+e.stream.id),n.remoteStreamAdded(e)):console.log("RECVONLY REMOTE STREAM IGNORED: "+e.stream+" - "+e.stream.id)},this.peerconnection.onremovestream=function(e){$(document).trigger("remotestreamremoved.jingle",[e,n.sid])},this.peerconnection.onsignalingstatechange=function(){n&&n.peerconnection&&n.updateModifySourcesQueue()},this.peerconnection.oniceconnectionstatechange=function(){if(n&&n.peerconnection){switch(n.updateModifySourcesQueue(),n.peerconnection.iceConnectionState){case"connected":this.startTime=new Date;break;case"disconnected":this.stopTime=new Date}i(n.sid,n)}},APP.RTC.localStreams.forEach(function(e){n.peerconnection.addStream(e.getOriginalStream())}),void this.relayedStreams.forEach(function(e){n.peerconnection.addStream(e)}))},n.prototype.accept=function(){var e=this;this.state="active";var t=this.peerconnection.localDescription;if(t&&"pranswer"==t.type){if(console.log("going from pranswer to answer"),this.usetrickle)for(var i=s.find_lines(t.sdp,"a=candidate:"),o=0;o<i.length;o++)t.sdp=t.sdp.replace(i[o]+"\r\n","");for(;s.find_line(t.sdp,"a=inactive");)t.sdp=t.sdp.replace("a=inactive","a=sendrecv");t=APP.simulcast.reverseTransformLocalDescription(t);var r=new c(t.sdp),a=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-accept",initiator:this.initiator,responder:this.responder,sid:this.sid});r.toJingle(a,this.initiator==this.me?"initiator":"responder",this.localStreamsSSRC);for(var l=this.peerconnection.localDescription.sdp;s.find_line(l,"a=inactive");)l=l.replace("a=inactive","a=sendrecv");var e=this;this.peerconnection.setLocalDescription(new RTCSessionDescription({type:"answer",sdp:l}),function(){e.setLocalDescription(),e.connection.sendIQ(a,function(){var t={};t.source="answer",$(document).trigger("ack.jingle",[e.sid,t])},function(t){var i=$(t).find("error").length?{code:$(t).find("error").attr("code"),reason:$(t).find("error :first")[0].tagName}:{};i.source="answer",n.onJingleError(e.sid,i)},1e4)},function(e){console.error("setLocalDescription failed",e)})}},n.prototype.terminate=function(e){this.state="ended",this.reason=e,this.peerconnection.close(),null!==this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null)},n.prototype.active=function(){return"active"==this.state},n.prototype.sendIceCandidate=function(e){var t=this;if(e&&!this.lasticecandidate){var i=s.iceparams(this.localSDP.media[e.sdpMLineIndex],this.localSDP.session),o=s.candidateToJingle(e.candidate);if(!i||!o)return void console.error("failed to get ice && jcand");if(i.xmlns="urn:xmpp:jingle:transports:ice-udp:1","srflx"===o.type?this.hadstuncandidate=!0:"relay"===o.type&&(this.hadturncandidate=!0),this.usetrickle){if(this.usedrip)return 0===this.drip_container.length&&window.setTimeout(function(){0!==t.drip_container.length&&(t.sendIceCandidates(t.drip_container),t.drip_container=[])},20),void this.drip_container.push(e);t.sendIceCandidate([e])}}else{if(!this.usetrickle){var r=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"offer"==this.peerconnection.localDescription.type?"session-initiate":"session-accept",initiator:this.initiator,sid:this.sid});this.localSDP=new c(this.peerconnection.localDescription.sdp);var t=this,a=function(e){e||(e={}),t.localSDP.toJingle(r,t.initiator==t.me?"initiator":"responder",e),t.connection.sendIQ(r,function(){var e={};e.source="offer",$(document).trigger("ack.jingle",[t.sid,e])},function(e){t.state="error",t.peerconnection.close();var i=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};i.source="offer",n.onJingleError(t.sid,i)},1e4)};a()}this.lasticecandidate=!0,console.log("Have we encountered any srflx candidates? "+this.hadstuncandidate),console.log("Have we encountered any relay candidates? "+this.hadturncandidate),this.hadstuncandidate||this.hadturncandidate||"closed"==this.peerconnection.signalingState||$(document).trigger("nostuncandidates.jingle",[this.sid])}},n.prototype.sendIceCandidates=function(e){console.log("sendIceCandidates",e);for(var t=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"transport-info",initiator:this.initiator,sid:this.sid}),i=0;i<this.localSDP.media.length;i++){var o=e.filter(function(e){return e.sdpMLineIndex==i}),r=s.parse_mline(this.localSDP.media[i].split("\r\n")[0]);if(o.length>0){var a=s.iceparams(this.localSDP.media[i],this.localSDP.session);a.xmlns="urn:xmpp:jingle:transports:ice-udp:1",t.c("content",{creator:this.initiator==this.me?"initiator":"responder",name:o[0].sdpMid?o[0].sdpMid:r.media}).c("transport",a);for(var c=0;c<o.length;c++)t.c("candidate",s.candidateToJingle(o[c].candidate)).up();if(s.find_line(this.localSDP.media[i],"a=fingerprint:",this.localSDP.session)){var l=s.parse_fingerprint(s.find_line(this.localSDP.media[i],"a=fingerprint:",this.localSDP.session));l.required=!0,t.c("fingerprint",{xmlns:"urn:xmpp:jingle:apps:dtls:0"}).t(l.fingerprint),delete l.fingerprint,t.attrs(l),t.up()}t.up(),t.up()}}this.connection.sendIQ(t,function(){var e={};e.source="transportinfo",$(document).trigger("ack.jingle",[this.sid,e])},function(e){var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};t.source="transportinfo",n.onJingleError(this.sid,t)},1e4)},n.prototype.sendOffer=function(){var e=this;this.peerconnection.createOffer(function(t){e.createdOffer(t)},function(e){console.error("createOffer failed",e)},this.media_constraints)},n.prototype.createdOffer=function(e){var t=this;this.localSDP=new c(e.sdp);var i=function(){var e=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-initiate",initiator:this.initiator,sid:this.sid});t.localSDP.toJingle(e,this.initiator==this.me?"initiator":"responder",this.localStreamsSSRC),t.connection.sendIQ(e,function(){var e={};e.source="offer",$(document).trigger("ack.jingle",[t.sid,e])},function(e){t.state="error",t.peerconnection.close();var i=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};i.source="offer",n.onJingleError(t.sid,i)},1e4)};e.sdp=this.localSDP.raw,this.peerconnection.setLocalDescription(e,function(){t.usetrickle&&i(),t.setLocalDescription()},function(e){console.error("setLocalDescription failed",e)});for(var o=s.find_lines(this.localSDP.raw,"a=candidate:"),r=0;r<o.length;r++){var a=s.parse_icecandidate(o[r]);"srflx"==a.type?this.hadstuncandidate=!0:"relay"==a.type&&(this.hadturncandidate=!0)}},n.prototype.setRemoteDescription=function(e,t){if(this.remoteSDP=new c(""),this.remoteSDP.fromJingle(e),null!==this.peerconnection.remoteDescription&&(console.log("setRemoteDescription when remote description is not null, should be pranswer",this.peerconnection.remoteDescription),"pranswer"==this.peerconnection.remoteDescription.type)){for(var i=new c(this.peerconnection.remoteDescription.sdp),o=0;o<i.media.length;o++){s.find_line(this.remoteSDP.media[o],"a=ice-ufrag:",this.remoteSDP.session)||(s.find_line(i.media[o],"a=ice-ufrag:",i.session)?this.remoteSDP.media[o]+=s.find_line(i.media[o],"a=ice-ufrag:",i.session)+"\r\n":console.warn("no ice ufrag?"),s.find_line(i.media[o],"a=ice-pwd:",i.session)?this.remoteSDP.media[o]+=s.find_line(i.media[o],"a=ice-pwd:",i.session)+"\r\n":console.warn("no ice pwd?"));for(var r=s.find_lines(i.media[o],"a=candidate:"),a=0;a<r.length;a++)this.remoteSDP.media[o]+=r[a]+"\r\n"}this.remoteSDP.raw=this.remoteSDP.session+this.remoteSDP.media.join("")}var l=new RTCSessionDescription({type:t,sdp:this.remoteSDP.raw});this.peerconnection.setRemoteDescription(l,function(){},function(e){console.error("setRemoteDescription error",e),n.onJingleFatalError(self,e)})},n.prototype.addIceCandidate=function(e){var t=this;if("closed"!=this.peerconnection.signalingState){if(!this.peerconnection.remoteDescription&&"have-local-offer"==this.peerconnection.signalingState){if(console.log("trickle ice candidate arriving before session accept..."),!this.remoteSDP){for(var n="v=0\r\no=- 1923518516 2 IN IP4 0.0.0.0\r\ns=-\r\nt=0 0\r\n",i=0;i<this.localSDP.media.length;i++)n+=s.find_line(this.localSDP.media[i],"m=")+"\r\n",n+=s.find_lines(this.localSDP.media[i],"a=rtpmap:").join("\r\n")+"\r\n",s.find_line(this.localSDP.media[i],"a=mid:")&&(n+=s.find_line(this.localSDP.media[i],"a=mid:")+"\r\n"),n+="a=inactive\r\n";this.remoteSDP=new c(n)}e.each(function(){for(var e=0;e<t.remoteSDP.media.length;e++)if((s.find_line(t.remoteSDP.media[e],"a=mid:"+$(this).attr("name"))||0===t.remoteSDP.media[e].indexOf("m="+$(this).attr("name")))&&!s.find_line(t.remoteSDP.media[e],"a=ice-ufrag:")){var n=$(this).find("transport");t.remoteSDP.media[e]+="a=ice-ufrag:"+n.attr("ufrag")+"\r\n",t.remoteSDP.media[e]+="a=ice-pwd:"+n.attr("pwd")+"\r\n",n=$(this).find("transport>fingerprint"),n.length?t.remoteSDP.media[e]+="a=fingerprint:"+n.attr("hash")+" "+n.text()+"\r\n":(console.log("no dtls fingerprint (webrtc issue #1718?)"),t.remoteSDP.media[e]+="a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:BAADBAADBAADBAADBAADBAADBAADBAADBAADBAAD\r\n");break}}),this.remoteSDP.raw=this.remoteSDP.session+this.remoteSDP.media.join("");var o=this.remoteSDP.media.filter(function(e){return s.find_line(e,"a=ice-ufrag:")}).length==this.remoteSDP.media.length;if(o){console.log("setting pranswer");try{this.peerconnection.setRemoteDescription(new RTCSessionDescription({type:"pranswer",sdp:this.remoteSDP.raw}),function(){},function(e){console.log("setRemoteDescription pranswer failed",e.toString())})}catch(r){console.error("setting pranswer failed",r)}}}e.each(function(){var e,n=-1;for(e=0;e<t.remoteSDP.media.length;e++)if(s.find_line(t.remoteSDP.media[e],"a=mid:"+$(this).attr("name"))||0===t.remoteSDP.media[e].indexOf("m="+$(this).attr("name"))){n=e;break}if(-1==n)for(e=0;e<t.localSDP.media.length;e++)if(s.find_line(t.localSDP.media[e],"a=mid:"+$(this).attr("name"))||0===t.localSDP.media[e].indexOf("m="+$(this).attr("name"))){n=e;break}var i=$(this).attr("name");$(this).find("transport>candidate").each(function(){var e,o;e=s.candidateFromJingle(this),o=new RTCIceCandidate({sdpMLineIndex:n,sdpMid:i,candidate:e});try{t.peerconnection.addIceCandidate(o)}catch(r){console.error("addIceCandidate failed",r.toString(),e)}})})}},n.prototype.sendAnswer=function(e){var t=this;this.peerconnection.createAnswer(function(n){t.createdAnswer(n,e)},function(e){console.error("createAnswer failed",e)},this.media_constraints)},n.prototype.createdAnswer=function(e,t){var i=this;if(this.localSDP=new c(e.sdp),this.usepranswer=t===!0,this.usetrickle&&this.usepranswer){e.type="pranswer";for(var o=0;o<this.localSDP.media.length;o++)this.localSDP.media[o]=this.localSDP.media[o].replace("a=sendrecv\r\n","a=inactive\r\n");this.localSDP.raw=this.localSDP.session+"\r\n"+this.localSDP.media.join("")}var i=this,r=function(t){var o=$iq({to:i.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-accept",initiator:i.initiator,responder:i.responder,sid:i.sid}),r=APP.simulcast.reverseTransformLocalDescription(e),a=new c(r.sdp);a.toJingle(o,i.initiator==i.me?"initiator":"responder",t),i.connection.sendIQ(o,function(){var e={};e.source="answer",$(document).trigger("ack.jingle",[i.sid,e])},function(e){var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};t.source="answer",n.onJingleError(i.sid,t)},1e4)};e.sdp=this.localSDP.raw,this.peerconnection.setLocalDescription(e,function(){i.usetrickle&&!i.usepranswer&&r(),i.setLocalDescription()},function(e){console.error("setLocalDescription failed",e)});for(var a=s.find_lines(this.localSDP.raw,"a=candidate:"),l=0;l<a.length;l++){var u=s.parse_icecandidate(a[l]);"srflx"==u.type?this.hadstuncandidate=!0:"relay"==u.type&&(this.hadturncandidate=!0)}},n.prototype.sendTerminate=function(e,t){var n=this,i=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-terminate",initiator:this.initiator,sid:this.sid}).c("reason").c(e||"success");t&&i.up().c("text").t(t),this.connection.sendIQ(i,function(){n.peerconnection.close(),n.peerconnection=null,n.terminate();var e={};e.source="terminate",$(document).trigger("ack.jingle",[n.sid,e])},function(e){var t=$(e).find("error").length?{code:$(e).find("error").attr("code"),reason:$(e).find("error :first")[0].tagName}:{};$(document).trigger("ack.jingle",[n.sid,t])},1e4),null!==this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null)},n.prototype.addSource=function(e,t){var n=this;if(!this.peerconnection.localDescription)return console.warn("addSource - localDescription not ready yet"),void setTimeout(function(){n.addSource(e,t)},200);console.log("addssrc",(new Date).getTime()),console.log("ice",this.peerconnection.iceConnectionState);var i=new c(this.peerconnection.remoteDescription.sdp),o=new c(this.peerconnection.localDescription.sdp);$(e).each(function(e,t){var r=$(t).attr("name"),a="";$(t).find('ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each(function(){var e=this.getAttribute("semantics"),t=$(this).find(">source").map(function(){return this.getAttribute("ssrc")}).get();0!=t.length&&(a+="a=ssrc-group:"+e+" "+t.join(" ")+"\r\n")});var c=$(t).find('source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]');c.each(function(){var e=$(this).attr("ssrc");return o.containsSSRC(e)?void console.warn("Got add stream request for my own ssrc: "+e):void $(this).find(">parameter").each(function(){a+="a=ssrc:"+e+" "+$(this).attr("name"),$(this).attr("value")&&$(this).attr("value").length&&(a+=":"+$(this).attr("value")),a+="\r\n"})}),i.media.forEach(function(e,t){s.find_line(e,"a=mid:"+r)&&(i.media[t]+=a,n.addssrc[t]||(n.addssrc[t]=""),n.addssrc[t]+=a)}),i.raw=i.session+i.media.join("")}),this.modifySourcesQueue.push(function(){console.log("modify sources done");var e=new c(n.peerconnection.localDescription.sdp);console.log("SDPs",o,e),n.notifyMySSRCUpdate(o,e)})},n.prototype.removeSource=function(e,t){var n=this;if(!this.peerconnection.localDescription)return console.warn("removeSource - localDescription not ready yet"),void setTimeout(function(){n.removeSource(e,t)},200);console.log("removessrc",(new Date).getTime()),console.log("ice",this.peerconnection.iceConnectionState);var i=new c(this.peerconnection.remoteDescription.sdp),o=new c(this.peerconnection.localDescription.sdp);$(e).each(function(e,t){var r=$(t).attr("name"),a="";$(t).find('ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each(function(){var e=this.getAttribute("semantics"),t=$(this).find(">source").map(function(){return this.getAttribute("ssrc")}).get();0!=t.length&&(a+="a=ssrc-group:"+e+" "+t.join(" ")+"\r\n")});var c=$(t).find('source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]');c.each(function(){var e=$(this).attr("ssrc");return o.containsSSRC(e)?void console.error("Got remove stream request for my own ssrc: "+e):void $(this).find(">parameter").each(function(){a+="a=ssrc:"+e+" "+$(this).attr("name"),$(this).attr("value")&&$(this).attr("value").length&&(a+=":"+$(this).attr("value")),a+="\r\n"})}),i.media.forEach(function(e,t){s.find_line(e,"a=mid:"+r)&&(i.media[t]+=a,n.removessrc[t]||(n.removessrc[t]=""),n.removessrc[t]+=a)}),i.raw=i.session+i.media.join("")}),this.modifySourcesQueue.push(function(){console.log("modify sources done");var e=new c(n.peerconnection.localDescription.sdp);console.log("SDPs",o,e),n.notifyMySSRCUpdate(o,e)})},n.prototype._modifySources=function(e,t){var n=this;if("closed"!=this.peerconnection.signalingState){if(!(this.addssrc.length||this.removessrc.length||null!==this.pendingop||this.switchstreams))return this.setLocalDescription(),e&&e(),void t();this.switchstreams=!1;var i=new c(this.peerconnection.remoteDescription.sdp);this.addssrc.forEach(function(e,t){i.media[t]+=e}),this.addssrc=[],this.removessrc.forEach(function(e,t){e=e.split("\r\n"),e.pop(),e.forEach(function(e){i.media[t]=i.media[t].replace(e+"\r\n","")})}),this.removessrc=[],i.media[0]&&(i.media[0]=i.media[0].replace("a=recvonly","a=sendrecv")),i.media[1]&&(i.media[1]=i.media[1].replace("a=recvonly","a=sendrecv")),i.raw=i.session+i.media.join(""),this.peerconnection.setRemoteDescription(new RTCSessionDescription({type:"offer",sdp:i.raw}),function(){return"closed"==n.signalingState?(console.error("createAnswer attempt on closed state"),void t("createAnswer attempt on closed state")):void n.peerconnection.createAnswer(function(i){if(null!==n.pendingop){var o=new c(i.sdp);if(o.media.length>1){switch(n.pendingop){case"mute":o.media[1]=o.media[1].replace("a=sendrecv","a=recvonly");break;case"unmute":o.media[1]=o.media[1].replace("a=recvonly","a=sendrecv")}o.raw=o.session+o.media.join(""),i.sdp=o.raw}n.pendingop=null}n.peerconnection.setLocalDescription(i,function(){n.setLocalDescription(),e&&e(),t()},function(e){console.error("modified setLocalDescription failed",e),t(e)})},function(e){console.error("modified answer failed",e),t(e)})},function(e){console.error("modify failed",e),t(e)})}},n.prototype.switchStreams=function(e,t,n,i){var o=this,r=null;return o.peerconnection&&(o.peerconnection.localDescription&&(r=new c(o.peerconnection.localDescription.sdp)),o.peerconnection.removeStream(t,!0),e&&o.peerconnection.addStream(e)),i||APP.RTC.switchVideoStreams(e,t),r&&o.peerconnection?(o.switchstreams=!0,void o.modifySourcesQueue.push(function(){console.log("modify sources done"),n();var e=new c(o.peerconnection.localDescription.sdp);console.log("SDPs",r,e),o.notifyMySSRCUpdate(r,e)})):void n()},n.prototype.notifyMySSRCUpdate=function(e,t){if("stable"!=this.peerconnection.signalingState||"connected"!=this.peerconnection.iceConnectionState)return void console.log("Too early to send updates");o=new a(t,e);var n=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"source-remove",initiator:this.initiator,sid:this.sid}),i=o.toJingle(n);i?this.connection.sendIQ(n,function(e){console.info("got remove result",e)},function(e){console.error("got remove error",e)}):console.log("removal not necessary");var o=new a(e,t),r=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"source-add",initiator:this.initiator,sid:this.sid}),s=o.toJingle(r);s?this.connection.sendIQ(r,function(e){console.info("got add result",e)},function(e){console.error("got add error",e)}):console.log("addition not necessary")},n.prototype.setVideoMute=function(e,t,n){var i;if(n?(i=n.byUser,"undefined"==typeof i&&(i=!0)):i=!0,i)this.videoMuteByUser=e;else if(this.videoMuteByUser)return;this.hardMuteVideo(e);var o=this,r=null;o.peerconnection&&o.peerconnection.localDescription&&(r=new c(o.peerconnection.localDescription.sdp)),this.modifySourcesQueue.push(function(){console.log("modify sources done"),t(e);var n=new c(o.peerconnection.localDescription.sdp);console.log("SDPs",r,n),o.notifyMySSRCUpdate(r,n)})},n.prototype.hardMuteVideo=function(e){this.pendingop=e?"mute":"unmute"},n.prototype.sendMute=function(e,t){var n=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiator,sid:this.sid});n.c(e?"mute":"unmute",{xmlns:"urn:xmpp:jingle:apps:rtp:info:1"}),n.attrs({creator:this.me==this.initiator?"creator":"responder"}),t&&n.attrs({name:t}),this.connection.send(n)},n.prototype.sendRinging=function(){var e=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-info",initiator:this.initiator,sid:this.sid});e.c("ringing",{xmlns:"urn:xmpp:jingle:apps:rtp:info:1"}),this.connection.send(e)},n.prototype.getStats=function(e){var t=this,n={audio:0,video:0},i={audio:0,video:0},o={audio:0,video:0},r={audio:0,video:0},a={audio:0,video:0},s={audio:0,video:0};return this.statsinterval=window.setInterval(function(){t&&t.peerconnection&&t.peerconnection.getStats&&t.peerconnection.getStats(function(e){for(var c=e.result(),l=0;l<c.length;++l)if("ssrc"==c[l].type){var u=c[l].stat("packetsReceived"),d=c[l].stat("packetsLost");u&&d&&(u=parseInt(u,10),d=parseInt(d,10),c[l].stat("googFrameRateReceived")?(r.video=i.video,o.video=n.video,n.video=u,i.video=d):(r.audio=i.audio,o.audio=n.audio,n.audio=u,i.audio=d))}s.audio=n.audio-o.audio,s.video=n.video-o.video,a.audio=s.audio>0?Math.ceil(100*(i.audio-r.audio)/s.audio):0,a.video=s.video>0?Math.ceil(100*(i.video-r.video)/s.video):0,$(document).trigger("packetloss.jingle",[t.sid,a])})},e||3e3),this.statsinterval},n.onJingleError=function(e,t){console.error("Jingle error",t)},n.onJingleFatalError=function(){this.service.sessionTerminated=!0,this.connection.emuc.doLeave(),APP.UI.messageHandler.showError("dialog.sorry","dialog.internalError")},n.prototype.setLocalDescription=function(){var e=[],t=APP.simulcast.parseMedia(this.peerconnection.localDescription);if(t.forEach(function(t){Object.keys(t.sources).length>0?Object.keys(t.sources).forEach(function(n){e.push({ssrc:n,type:t.type,direction:t.direction})}):this.localStreamsSSRC&&this.localStreamsSSRC[t.type]&&e.push({ssrc:this.localStreamsSSRC[t.type],type:t.type,direction:t.direction})}),console.log("new ssrcs",e),this.connection.emuc.clearPresenceMedia(),e.length>0){for(var n=1;n<=e.length;n++)"video"===e[n-1].type&&APP.desktopsharing.isUsingScreenStream()&&(e[n-1].type="screen"),this.connection.emuc.addMediaToPresence(n,e[n-1].type,e[n-1].ssrc,e[n-1].direction);this.connection.emuc.sendPresence()}},n.prototype.remoteStreamAdded=function(e,t){var n,i=this,r=this.connection.emuc.ssrc2jid;if(e.stream.id&&-1===e.stream.id.indexOf("mixedmslabel")){var a=s.find_lines(this.peerconnection.remoteDescription.sdp,"a=ssrc:");if(a=a.filter(function(t){return-1!==t.indexOf("msid:"+e.stream.id)}),a.length){if(n=a[0].substring(7).split(" ")[0],!r[n])return"undefined"==typeof t&&(t=0),void(t>10?console.warning("Waiting for jid timed out",n):setTimeout(function(e){return function(){i.remoteStreamAdded(e,t++)}}(e),250));console.log("associated jid",r[n],e.peerjid),r[n]&&(e.peerjid=r[n])}}APP.RTC.createRemoteStream(e,this.sid,n);var c=e.stream.getVideoTracks().length>0;c&&e.peerjid&&this.peerjid===e.peerjid&&0===e.stream.getVideoTracks().length&&APP.RTC.localVideo.getTracks().length>0&&window.setTimeout(function(){o(i.peerconnection)},3e3)},t.exports=n},{"../../service/RTC/RTCBrowserType":65,"./SDP":51,"./SDPDiffer":52,"./SDPUtil":53,"./TraceablePeerConnection":54,async:76}],51:[function(e,t){function n(e){this.media=e.split("\r\nm=");for(var t=1;t<this.media.length;t++)this.media[t]="m="+this.media[t],t!=this.media.length-1&&(this.media[t]+="\r\n");this.session=this.media.shift()+"\r\n",this.raw=this.session+this.media.join("")}var i=e("./SDPUtil");n.prototype.getMediaSsrcMap=function(){for(var e,t=this,n={},o=0;o<t.media.length;o++){e=i.find_lines(t.media[o],"a=ssrc:");var r=i.parse_mid(i.find_line(t.media[o],"a=mid:")),a={mediaindex:o,mid:r,ssrcs:{},ssrcGroups:[]};n[o]=a,e.forEach(function(e){var t=e.substring(7).split(" ")[0];a.ssrcs[t]||(a.ssrcs[t]={ssrc:t,lines:[]}),a.ssrcs[t].lines.push(e)}),e=i.find_lines(t.media[o],"a=ssrc-group:"),e.forEach(function(e){var t=e.substr(0,idx).substr(13),n=e.substr(14+t.length).split(" ");0!=n.length&&a.ssrcGroups.push({semantics:t,ssrcs:n})})}return n},n.prototype.containsSSRC=function(e){var t=this.getMediaSsrcMap(),n=!1;return Object.keys(t).forEach(function(i){var o=t[i];-1!=Object.keys(o.ssrcs).indexOf(e)&&(n=!0)}),n},n.prototype.mangle=function(){var e,t,n,o,r,a;
for(e=0;e<this.media.length;e++)if(o=this.media[e].split("\r\n"),o.pop(),n=i.parse_mline(o.shift()),"audio"==n.media){for(a="",n.fmt.length=0,t=0;t<o.length;t++)if("a=rtpmap:"==o[t].substr(0,9)){if(r=i.parse_rtpmap(o[t]),"CN"==r.name||"ISAC"==r.name)continue;n.fmt.push(r.id),a+=o[t]+"\r\n"}else a+=o[t]+"\r\n";this.media[e]=i.build_mline(n)+"\r\n",this.media[e]+=a}this.raw=this.session+this.media.join("")},n.prototype.removeSessionLines=function(e){var t=this,n=i.find_lines(this.session,e);return n.forEach(function(e){t.session=t.session.replace(e+"\r\n","")}),this.raw=this.session+this.media.join(""),n},n.prototype.removeMediaLines=function(e,t){var n=this,o=i.find_lines(this.media[e],t);return o.forEach(function(t){n.media[e]=n.media[e].replace(t+"\r\n","")}),this.raw=this.session+this.media.join(""),o},n.prototype.toJingle=function(e,t,n){var o,r,a,s,c,l,u,d;if(i.find_line(this.session,"a=group:"))for(d=i.find_lines(this.session,"a=group:"),o=0;o<d.length;o++){u=d[o].split(" ");var p=u.shift().substr(8);for(e.c("group",{xmlns:"urn:xmpp:jingle:apps:grouping:0",semantics:p}),r=0;r<u.length;r++)e.c("content",{name:u[r]}).up();e.up()}for(o=0;o<this.media.length;o++)if(s=i.parse_mline(this.media[o].split("\r\n")[0]),"audio"===s.media||"video"===s.media||"application"===s.media){if(c=i.find_line(this.media[o],"a=ssrc:")?i.find_line(this.media[o],"a=ssrc:").substring(7).split(" ")[0]:n&&n[s.media]?n[s.media]:!1,e.c("content",{creator:t,name:s.media}),i.find_line(this.media[o],"a=mid:")){var f=i.parse_mid(i.find_line(this.media[o],"a=mid:"));e.attrs({name:f})}if(i.find_line(this.media[o],"a=rtpmap:").length){for(e.c("description",{xmlns:"urn:xmpp:jingle:apps:rtp:1",media:s.media}),c&&e.attrs({ssrc:c}),r=0;r<s.fmt.length;r++){if(l=i.find_line(this.media[o],"a=rtpmap:"+s.fmt[r]),e.c("payload-type",i.parse_rtpmap(l)),i.find_line(this.media[o],"a=fmtp:"+s.fmt[r]))for(u=i.parse_fmtp(i.find_line(this.media[o],"a=fmtp:"+s.fmt[r])),a=0;a<u.length;a++)e.c("parameter",u[a]).up();this.RtcpFbToJingle(o,e,s.fmt[r]),e.up()}if(i.find_line(this.media[o],"a=crypto:",this.session)){e.c("encryption",{required:1});var h=i.find_lines(this.media[o],"a=crypto:",this.session);h.forEach(function(t){e.c("crypto",i.parse_crypto(t)).up()}),e.up()}if(c){e.c("source",{ssrc:c,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"});var m=i.find_lines(this.media[o],"a=ssrc:");if(m.length>0)m.forEach(function(t){idx=t.indexOf(" ");var n=t.substr(0,idx).substr(7);n!=c&&(e.up(),c=n,e.c("source",{ssrc:c,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}));var i=t.substr(idx+1);e.c("parameter"),-1==i.indexOf(":")?e.attrs({name:i}):(e.attrs({name:i.split(":",2)[0]}),e.attrs({value:i.split(":",2)[1]})),e.up()}),e.up();else{e.up(),e.c("source",{ssrc:c,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),e.c("parameter"),e.attrs({name:"cname",value:Math.random().toString(36).substring(7)}),e.up();var g=null;g="audio"==s.media?APP.RTC.localAudio.getId():APP.RTC.localVideo.getId(),null!=g&&(g=g.replace(/[\{,\}]/g,""),e.c("parameter"),e.attrs({name:"msid",value:g}),e.up(),e.c("parameter"),e.attrs({name:"mslabel",value:g}),e.up(),e.c("parameter"),e.attrs({name:"label",value:g}),e.up(),e.up())}var v=i.find_lines(this.media[o],"a=ssrc-group:");v.forEach(function(t){idx=t.indexOf(" ");var n=t.substr(0,idx).substr(13),i=t.substr(14+n.length).split(" ");0!=i.length&&(e.c("ssrc-group",{semantics:n,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),i.forEach(function(t){e.c("source",{ssrc:t}).up()}),e.up())})}if(i.find_line(this.media[o],"a=rtcp-mux")&&e.c("rtcp-mux").up(),this.RtcpFbToJingle(o,e,"*"),i.find_line(this.media[o],"a=extmap:"))for(d=i.find_lines(this.media[o],"a=extmap:"),r=0;r<d.length;r++){if(u=i.parse_extmap(d[r]),e.c("rtp-hdrext",{xmlns:"urn:xmpp:jingle:apps:rtp:rtp-hdrext:0",uri:u.uri,id:u.value}),u.hasOwnProperty("direction"))switch(u.direction){case"sendonly":e.attrs({senders:"responder"});break;case"recvonly":e.attrs({senders:"initiator"});break;case"sendrecv":e.attrs({senders:"both"});break;case"inactive":e.attrs({senders:"none"})}e.up()}e.up()}this.TransportToJingle(o,e),i.find_line(this.media[o],"a=sendrecv",this.session)?e.attrs({senders:"both"}):i.find_line(this.media[o],"a=sendonly",this.session)?e.attrs({senders:"initiator"}):i.find_line(this.media[o],"a=recvonly",this.session)?e.attrs({senders:"responder"}):i.find_line(this.media[o],"a=inactive",this.session)&&e.attrs({senders:"none"}),"0"==s.port&&e.attrs({senders:"rejected"}),e.up()}return e.up(),e},n.prototype.TransportToJingle=function(e,t){var n,o=e,r=this;if(t.c("transport"),i.find_line(this.media[e],"a=sctpmap:").length){var a=i.find_line(this.media[o],"a=sctpmap:",r.session);if(a){var s=i.parse_sctpmap(a);t.c("sctpmap",{xmlns:"urn:xmpp:jingle:transports:dtls-sctp:1",number:s[0],protocol:s[1]}),s.length>2&&t.attrs({streams:s[2]}),t.up()}}var c=i.find_lines(this.media[e],"a=fingerprint:",this.session);if(c.forEach(function(o){n=i.parse_fingerprint(o),n.xmlns="urn:xmpp:jingle:apps:dtls:0",t.c("fingerprint").t(n.fingerprint),delete n.fingerprint,o=i.find_line(r.media[e],"a=setup:",r.session),o&&(n.setup=o.substr(8)),t.attrs(n),t.up()}),n=i.iceparams(this.media[e],this.session),n&&(n.xmlns="urn:xmpp:jingle:transports:ice-udp:1",t.attrs(n),i.find_line(this.media[e],"a=candidate:",this.session))){var l=i.find_lines(this.media[e],"a=candidate:",this.session);l.forEach(function(e){t.c("candidate",i.candidateToJingle(e)).up()})}t.up()},n.prototype.RtcpFbToJingle=function(e,t,n){var o=i.find_lines(this.media[e],"a=rtcp-fb:"+n);o.forEach(function(e){var n=i.parse_rtcpfb(e);"trr-int"==n.type?(t.c("rtcp-fb-trr-int",{xmlns:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",value:n.params[0]}),t.up()):(t.c("rtcp-fb",{xmlns:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",type:n.type}),n.params.length>0&&t.attrs({subtype:n.params[0]}),t.up())})},n.prototype.RtcpFbFromJingle=function(e,t){var n="",i=e.find('>rtcp-fb-trr-int[xmlns="urn:xmpp:jingle:apps:rtp:rtcp-fb:0"]');return i.length&&(n+="a=rtcp-fb:* trr-int ",n+=i.attr("value")?i.attr("value"):"0",n+="\r\n"),i=e.find('>rtcp-fb[xmlns="urn:xmpp:jingle:apps:rtp:rtcp-fb:0"]'),i.each(function(){n+="a=rtcp-fb:"+t+" "+$(this).attr("type"),$(this).attr("subtype")&&(n+=" "+$(this).attr("subtype")),n+="\r\n"}),n},n.prototype.fromJingle=function(e){var t=this;this.raw="v=0\r\no=- 1923518516 2 IN IP4 0.0.0.0\r\ns=-\r\nt=0 0\r\n",$(e).find('>group[xmlns="urn:xmpp:jingle:apps:grouping:0"]').length&&$(e).find('>group[xmlns="urn:xmpp:jingle:apps:grouping:0"]').each(function(e,n){var i=$(n).find(">content").map(function(e,t){return t.getAttribute("name")}).get();i.length>0&&(t.raw+="a=group:"+(n.getAttribute("semantics")||n.getAttribute("type"))+" "+i.join(" ")+"\r\n")}),this.session=this.raw,e.find(">content").each(function(){var e=t.jingle2media($(this));t.media.push(e)}),this.raw=this.session+this.media.join("")},n.prototype.jingle2media=function(e){var t,n="",o=e.find("description"),r=(o.attr("ssrc"),this),a=e.find('>transport>sctpmap[xmlns="urn:xmpp:jingle:transports:dtls-sctp:1"]');if(t={media:o.attr("media")},t.port="1","rejected"==e.attr("senders")&&(t.port="0"),t.proto=e.find(">transport>fingerprint").length||o.find("encryption").length?a.length?"DTLS/SCTP":"RTP/SAVPF":"RTP/AVPF",a.length){n+="m=application 1 DTLS/SCTP "+a.attr("number")+"\r\n",n+="a=sctpmap:"+a.attr("number")+" "+a.attr("protocol");var s=a.attr("streams");n+=s?" "+s+"\r\n":"\r\n"}else t.fmt=o.find("payload-type").map(function(){return this.getAttribute("id")}).get(),n+=i.build_mline(t)+"\r\n";switch(n+="c=IN IP4 0.0.0.0\r\n",a.length||(n+="a=rtcp:1 IN IP4 0.0.0.0\r\n"),t=e.find('>transport[xmlns="urn:xmpp:jingle:transports:ice-udp:1"]'),t.length&&(t.attr("ufrag")&&(n+=i.build_iceufrag(t.attr("ufrag"))+"\r\n"),t.attr("pwd")&&(n+=i.build_icepwd(t.attr("pwd"))+"\r\n"),t.find(">fingerprint").each(function(){n+="a=fingerprint:"+this.getAttribute("hash"),n+=" "+$(this).text(),n+="\r\n",this.getAttribute("setup")&&(n+="a=setup:"+this.getAttribute("setup")+"\r\n")})),e.attr("senders")){case"initiator":n+="a=sendonly\r\n";break;case"responder":n+="a=recvonly\r\n";break;case"none":n+="a=inactive\r\n";break;case"both":n+="a=sendrecv\r\n"}return n+="a=mid:"+e.attr("name")+"\r\n",o.find("rtcp-mux").length&&(n+="a=rtcp-mux\r\n"),o.find("encryption").length&&o.find("encryption>crypto").each(function(){n+="a=crypto:"+this.getAttribute("tag"),n+=" "+this.getAttribute("crypto-suite"),n+=" "+this.getAttribute("key-params"),this.getAttribute("session-params")&&(n+=" "+this.getAttribute("session-params")),n+="\r\n"}),o.find("payload-type").each(function(){n+=i.build_rtpmap(this)+"\r\n",$(this).find(">parameter").length&&(n+="a=fmtp:"+this.getAttribute("id")+" ",n+=$(this).find("parameter").map(function(){return(this.getAttribute("name")?this.getAttribute("name")+"=":"")+this.getAttribute("value")}).get().join("; "),n+="\r\n"),n+=r.RtcpFbFromJingle($(this),this.getAttribute("id"))}),n+=r.RtcpFbFromJingle(o,"*"),t=o.find('>rtp-hdrext[xmlns="urn:xmpp:jingle:apps:rtp:rtp-hdrext:0"]'),t.each(function(){n+="a=extmap:"+this.getAttribute("id")+" "+this.getAttribute("uri")+"\r\n"}),e.find('>transport[xmlns="urn:xmpp:jingle:transports:ice-udp:1"]>candidate').each(function(){n+=i.candidateFromJingle(this)}),t=e.find('description>ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each(function(){var e=this.getAttribute("semantics"),t=$(this).find(">source").map(function(){return this.getAttribute("ssrc")}).get();0!=t.length&&(n+="a=ssrc-group:"+e+" "+t.join(" ")+"\r\n")}),t=e.find('description>source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]'),t.each(function(){var e=this.getAttribute("ssrc");$(this).find(">parameter").each(function(){n+="a=ssrc:"+e+" "+this.getAttribute("name"),this.getAttribute("value")&&this.getAttribute("value").length&&(n+=":"+this.getAttribute("value")),n+="\r\n"})}),n},t.exports=n},{"./SDPUtil":53}],52:[function(e,t){function n(e,t){this.mySDP=e,this.otherSDP=t}n.prototype.getNewMedia=function(){function e(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,n=this.length;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0}var t=this.mySDP.getMediaSsrcMap(),n=this.otherSDP.getMediaSsrcMap(),i={};return Object.keys(n).forEach(function(o){var r=t[o],a=n[o];return!r&&a?void(i[o]=a):(Object.keys(a.ssrcs).forEach(function(e){-1===Object.keys(r.ssrcs).indexOf(e)&&(i[o]||(i[o]={mediaindex:a.mediaindex,mid:a.mid,ssrcs:{},ssrcGroups:[]}),i[o].ssrcs[e]=a.ssrcs[e])}),void a.ssrcGroups.forEach(function(t){for(var n=!1,s=0;s<r.ssrcGroups.length;s++){var c=r.ssrcGroups[s];if(t.semantics==c.semantics&&e.apply(t.ssrcs,[c.ssrcs])){n=!0;break}}n||(i[o]||(i[o]={mediaindex:a.mediaindex,mid:a.mid,ssrcs:{},ssrcGroups:[]}),i[o].ssrcGroups.push(t))}))}),i},n.prototype.toJingle=function(e){var t=this.getNewMedia(),n=!1;return Object.keys(t).forEach(function(i){n=!0;var o=t[i];e.c("content",{name:o.mid}),e.c("description",{xmlns:"urn:xmpp:jingle:apps:rtp:1",media:o.mid}),Object.keys(o.ssrcs).forEach(function(t){var n=o.ssrcs[t];e.c("source",{xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),e.attrs({ssrc:n.ssrc}),n.lines.forEach(function(t){var n=t.indexOf(" "),i=t.substr(n+1);e.c("parameter"),-1==i.indexOf(":")?e.attrs({name:i}):(e.attrs({name:i.split(":",2)[0]}),e.attrs({value:i.split(":",2)[1]})),e.up()}),e.up()}),o.ssrcGroups.forEach(function(t){0!=t.ssrcs.length&&(e.c("ssrc-group",{semantics:t.semantics,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),t.ssrcs.forEach(function(t){e.c("source",{ssrc:t}).up()}),e.up())}),e.up(),e.up()}),n},t.exports=n},{}],53:[function(e,t){SDPUtil={iceparams:function(e,t){var n=null;return SDPUtil.find_line(e,"a=ice-ufrag:",t)&&SDPUtil.find_line(e,"a=ice-pwd:",t)&&(n={ufrag:SDPUtil.parse_iceufrag(SDPUtil.find_line(e,"a=ice-ufrag:",t)),pwd:SDPUtil.parse_icepwd(SDPUtil.find_line(e,"a=ice-pwd:",t))}),n},parse_iceufrag:function(e){return e.substring(12)},build_iceufrag:function(e){return"a=ice-ufrag:"+e},parse_icepwd:function(e){return e.substring(10)},build_icepwd:function(e){return"a=ice-pwd:"+e},parse_mid:function(e){return e.substring(6)},parse_mline:function(e){var t=e.substring(2).split(" "),n={};return n.media=t.shift(),n.port=t.shift(),n.proto=t.shift(),""===t[t.length-1]&&t.pop(),n.fmt=t,n},build_mline:function(e){return"m="+e.media+" "+e.port+" "+e.proto+" "+e.fmt.join(" ")},parse_rtpmap:function(e){var t=e.substring(9).split(" "),n={};return n.id=t.shift(),t=t[0].split("/"),n.name=t.shift(),n.clockrate=t.shift(),n.channels=t.length?t.shift():"1",n},parse_sctpmap:function(e){var t=e.substring(10).split(" "),n=t[0],i=t[1],o=t.length>2?t[2]:null;return[n,i,o]},build_rtpmap:function(e){var t="a=rtpmap:"+e.getAttribute("id")+" "+e.getAttribute("name")+"/"+e.getAttribute("clockrate");return e.getAttribute("channels")&&"1"!=e.getAttribute("channels")&&(t+="/"+e.getAttribute("channels")),t},parse_crypto:function(e){var t=e.substring(9).split(" "),n={};return n.tag=t.shift(),n["crypto-suite"]=t.shift(),n["key-params"]=t.shift(),t.length&&(n["session-params"]=t.join(" ")),n},parse_fingerprint:function(e){var t=e.substring(14).split(" "),n={};return n.hash=t.shift(),n.fingerprint=t.shift(),n},parse_fmtp:function(e){var t,n,i,o=e.split(" "),r=[];for(o.shift(),o=o.join(" ").split(";"),t=0;t<o.length;t++){for(n=o[t].split("=")[0];n.length&&" "==n[0];)n=n.substring(1);i=o[t].split("=")[1],n&&i?r.push({name:n,value:i}):n&&r.push({name:"",value:n})}return r},parse_icecandidate:function(e){var t={},n=e.split(" ");t.foundation=n[0].substring(12),t.component=n[1],t.protocol=n[2].toLowerCase(),t.priority=n[3],t.ip=n[4],t.port=n[5],t.type=n[7],t.generation=0;for(var i=8;i<n.length;i+=2)switch(n[i]){case"raddr":t["rel-addr"]=n[i+1];break;case"rport":t["rel-port"]=n[i+1];break;case"generation":t.generation=n[i+1];break;case"tcptype":t.tcptype=n[i+1];break;default:console.log('parse_icecandidate not translating "'+n[i]+'" = "'+n[i+1]+'"')}return t.network="1",t.id=Math.random().toString(36).substr(2,10),t},build_icecandidate:function(e){var t=["a=candidate:"+e.foundation,e.component,e.protocol,e.priority,e.ip,e.port,"typ",e.type].join(" ");switch(t+=" ",e.type){case"srflx":case"prflx":case"relay":e.hasOwnAttribute("rel-addr")&&e.hasOwnAttribute("rel-port")&&(t+="raddr",t+=" ",t+=e["rel-addr"],t+=" ",t+="rport",t+=" ",t+=e["rel-port"],t+=" ")}return e.hasOwnAttribute("tcptype")&&(t+="tcptype",t+=" ",t+=e.tcptype,t+=" "),t+="generation",t+=" ",t+=e.hasOwnAttribute("generation")?e.generation:"0"},parse_ssrc:function(e){for(var t=e.split("\r\n"),n={},i=0;i<t.length;i++)if("a=ssrc:"==t[i].substring(0,7)){var o=t[i].indexOf(" ");n[t[i].substr(o+1).split(":",2)[0]]=t[i].substr(o+1).split(":",2)[1]}return n},parse_rtcpfb:function(e){var t=e.substr(10).split(" "),n={};return n.pt=t.shift(),n.type=t.shift(),n.params=t,n},parse_extmap:function(e){var t=e.substr(9).split(" "),n={};return n.value=t.shift(),-1!=n.value.indexOf("/")?(n.direction=n.value.substr(n.value.indexOf("/")+1),n.value=n.value.substr(0,n.value.indexOf("/"))):n.direction="both",n.uri=t.shift(),n.params=t,n},find_line:function(e,t,n){for(var i=e.split("\r\n"),o=0;o<i.length;o++)if(i[o].substring(0,t.length)==t)return i[o];if(!n)return!1;i=n.split("\r\n");for(var r=0;r<i.length;r++)if(i[r].substring(0,t.length)==t)return i[r];return!1},find_lines:function(e,t,n){for(var i=e.split("\r\n"),o=[],r=0;r<i.length;r++)i[r].substring(0,t.length)==t&&o.push(i[r]);if(o.length||!n)return o;i=n.split("\r\n");for(var a=0;a<i.length;a++)i[a].substring(0,t.length)==t&&o.push(i[a]);return o},candidateToJingle:function(e){if(0===e.indexOf("candidate:"))e="a="+e;else if("a=candidate:"!=e.substring(0,12))return console.log("parseCandidate called with a line that is not a candidate line"),console.log(e),null;"\r\n"==e.substring(e.length-2)&&(e=e.substring(0,e.length-2));var t,n={},i=e.split(" ");if("typ"!=i[6])return console.log("did not find typ in the right place"),console.log(e),null;for(n.foundation=i[0].substring(12),n.component=i[1],n.protocol=i[2].toLowerCase(),n.priority=i[3],n.ip=i[4],n.port=i[5],n.type=i[7],n.generation="0",t=8;t<i.length;t+=2)switch(i[t]){case"raddr":n["rel-addr"]=i[t+1];break;case"rport":n["rel-port"]=i[t+1];break;case"generation":n.generation=i[t+1];break;case"tcptype":n.tcptype=i[t+1];break;default:console.log('not translating "'+i[t]+'" = "'+i[t+1]+'"')}return n.network="1",n.id=Math.random().toString(36).substr(2,10),n},candidateFromJingle:function(e){var t="a=candidate:";switch(t+=e.getAttribute("foundation"),t+=" ",t+=e.getAttribute("component"),t+=" ",t+=e.getAttribute("protocol"),t+=" ",t+=e.getAttribute("priority"),t+=" ",t+=e.getAttribute("ip"),t+=" ",t+=e.getAttribute("port"),t+=" ",t+="typ",t+=" "+e.getAttribute("type"),t+=" ",e.getAttribute("type")){case"srflx":case"prflx":case"relay":e.getAttribute("rel-addr")&&e.getAttribute("rel-port")&&(t+="raddr",t+=" ",t+=e.getAttribute("rel-addr"),t+=" ",t+="rport",t+=" ",t+=e.getAttribute("rel-port"),t+=" ")}return"tcp"==e.getAttribute("protocol").toLowerCase()&&(t+="tcptype",t+=" ",t+=e.getAttribute("tcptype"),t+=" "),t+="generation",t+=" ",t+=e.getAttribute("generation")||"0",t+"\r\n"}},t.exports=SDPUtil},{}],54:[function(e,t){function n(t,n){var i=this,o=navigator.mozGetUserMedia?mozRTCPeerConnection:webkitRTCPeerConnection;this.peerconnection=new o(t,n),this.updateLog=[],this.stats={},this.statsinterval=null,this.maxstats=0;var r=e("sdp-interop").Interop;this.interop=new r,this.trace=function(e,t){i.updateLog.push({time:new Date,type:e,value:t||""})},this.onicecandidate=null,this.peerconnection.onicecandidate=function(e){i.trace("onicecandidate",JSON.stringify(e.candidate,null," ")),null!==i.onicecandidate&&i.onicecandidate(e)},this.onaddstream=null,this.peerconnection.onaddstream=function(e){i.trace("onaddstream",e.stream.id),null!==i.onaddstream&&i.onaddstream(e)},this.onremovestream=null,this.peerconnection.onremovestream=function(e){i.trace("onremovestream",e.stream.id),null!==i.onremovestream&&i.onremovestream(e)},this.onsignalingstatechange=null,this.peerconnection.onsignalingstatechange=function(e){i.trace("onsignalingstatechange",i.signalingState),null!==i.onsignalingstatechange&&i.onsignalingstatechange(e)},this.oniceconnectionstatechange=null,this.peerconnection.oniceconnectionstatechange=function(e){i.trace("oniceconnectionstatechange",i.iceConnectionState),null!==i.oniceconnectionstatechange&&i.oniceconnectionstatechange(e)},this.onnegotiationneeded=null,this.peerconnection.onnegotiationneeded=function(e){i.trace("onnegotiationneeded"),null!==i.onnegotiationneeded&&i.onnegotiationneeded(e)},i.ondatachannel=null,this.peerconnection.ondatachannel=function(e){i.trace("ondatachannel",e),null!==i.ondatachannel&&i.ondatachannel(e)},!navigator.mozGetUserMedia&&this.maxstats&&(this.statsinterval=window.setInterval(function(){i.peerconnection.getStats(function(e){for(var t=e.result(),n=0;n<t.length;++n){var o=new Date;t[n].names().forEach(function(e){var r=t[n].id+"-"+e;i.stats[r]||(i.stats[r]={startTime:o,endTime:o,values:[],times:[]}),i.stats[r].values.push(t[n].stat(e)),i.stats[r].times.push(o.getTime()),i.stats[r].values.length>i.maxstats&&(i.stats[r].values.shift(),i.stats[r].times.shift()),i.stats[r].endTime=o})}})},1e3))}dumpSDP=function(e){return"undefined"==typeof e||null==e?"":"type: "+e.type+"\r\n"+e.sdp},void 0!==n.prototype.__defineGetter__&&(n.prototype.__defineGetter__("signalingState",function(){return this.peerconnection.signalingState}),n.prototype.__defineGetter__("iceConnectionState",function(){return this.peerconnection.iceConnectionState}),n.prototype.__defineGetter__("localDescription",function(){this.trace("getLocalDescription::preTransform (Plan A)",dumpSDP(this.peerconnection.localDescription));var e=this.peerconnection.localDescription;return e=navigator.mozGetUserMedia?this.interop.toPlanB(e):APP.simulcast.reverseTransformLocalDescription(this.peerconnection.localDescription),this.trace("getLocalDescription::postTransform (Plan B)",dumpSDP(e)),e}),n.prototype.__defineGetter__("remoteDescription",function(){this.trace("getRemoteDescription::preTransform (Plan A)",dumpSDP(this.peerconnection.remoteDescription));var e=this.peerconnection.remoteDescription;return e=navigator.mozGetUserMedia?this.interop.toPlanB(e):APP.simulcast.reverseTransformRemoteDescription(this.peerconnection.remoteDescription),this.trace("getRemoteDescription::postTransform (Plan B)",dumpSDP(e)),e})),n.prototype.addStream=function(e){this.trace("addStream",e.id),APP.simulcast.resetSender();try{this.peerconnection.addStream(e)}catch(t){return void console.error(t)}},n.prototype.removeStream=function(e,t){this.trace("removeStream",e.id),APP.simulcast.resetSender(),t&&(e.getAudioTracks().forEach(function(e){e.stop()}),e.getVideoTracks().forEach(function(e){e.stop()}));try{this.peerconnection.removeStream(e)}catch(n){console.error(n)}},n.prototype.createDataChannel=function(e,t){return this.trace("createDataChannel",e,t),this.peerconnection.createDataChannel(e,t)},n.prototype.setLocalDescription=function(e,t,n){this.trace("setLocalDescription::preTransform (Plan B)",dumpSDP(e)),e=navigator.mozGetUserMedia?this.interop.toUnifiedPlan(e):APP.simulcast.transformLocalDescription(e),this.trace("setLocalDescription::postTransform (Plan A)",dumpSDP(e));var i=this;this.peerconnection.setLocalDescription(e,function(){i.trace("setLocalDescriptionOnSuccess"),t()},function(e){i.trace("setLocalDescriptionOnFailure",e),n(e)})},n.prototype.setRemoteDescription=function(e,t,n){this.trace("setRemoteDescription::preTransform (Plan B)",dumpSDP(e)),e=navigator.mozGetUserMedia?this.interop.toUnifiedPlan(e):APP.simulcast.transformRemoteDescription(e),this.trace("setRemoteDescription::postTransform (Plan A)",dumpSDP(e));var i=this;this.peerconnection.setRemoteDescription(e,function(){i.trace("setRemoteDescriptionOnSuccess"),t()},function(e){i.trace("setRemoteDescriptionOnFailure",e),n(e)})},n.prototype.close=function(){this.trace("stop"),null!==this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null),this.peerconnection.close()},n.prototype.createOffer=function(e,t,n){var i=this;this.trace("createOffer",JSON.stringify(n,null," ")),this.peerconnection.createOffer(function(t){i.trace("createOfferOnSuccess::preTransform (Plan A)",dumpSDP(t)),navigator.mozGetUserMedia&&(t=i.interop.toPlanB(t)),i.trace("createOfferOnSuccess::postTransform (Plan B)",dumpSDP(t)),e(t)},function(e){i.trace("createOfferOnFailure",e),t(e)},n)},n.prototype.createAnswer=function(e,t,n){var i=this;this.trace("createAnswer",JSON.stringify(n,null," ")),this.peerconnection.createAnswer(function(t){i.trace("createAnswerOnSuccess::preTransfom (Plan A)",dumpSDP(t)),t=navigator.mozGetUserMedia?i.interop.toPlanB(t):APP.simulcast.transformAnswer(t),i.trace("createAnswerOnSuccess::postTransfom (Plan B)",dumpSDP(t)),e(t)},function(e){i.trace("createAnswerOnFailure",e),t(e)},n)},n.prototype.addIceCandidate=function(e){this.trace("addIceCandidate",JSON.stringify(e,null," ")),this.peerconnection.addIceCandidate(e)},n.prototype.getStats=function(e,t){navigator.mozGetUserMedia?(t||(t=function(){}),this.peerconnection.getStats(null,e,t)):this.peerconnection.getStats(e)},t.exports=n},{"sdp-interop":101}],55:[function(e,t){function n(e){var t=1;return function(n){if(n)return void(t=1);var i=Math.pow(2,t-1);return t+=1,i*e}}var i,o=e("../../service/xmpp/XMPPEvents"),r=e("../settings/Settings"),a=e("../../service/authentication/AuthenticationEvents"),s=null,c=n(1e3),l=n(1e3),u=!1,d=void 0!==config.hosts.call_control,p=null,f={isModerator:function(){return s&&s.emuc.isModerator()},isPeerModerator:function(e){return s&&"moderator"===s.emuc.getMemberRole(e)},isExternalAuthEnabled:function(){return u},isSipGatewayEnabled:function(){return d},setConnection:function(e){s=e},init:function(e,t){function n(e){if(e.data&&e.data.sessionId){if(e.origin!==window.location.origin)return void console.warn("Ignoring sessionId from different origin: "+e.origin);localStorage.setItem("sessionId",e.data.sessionId)}}this.xmppService=e,p=t,window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent("onmessage",n)},onMucMemberLeft:function(e){console.info("Someone left is it focus ? "+e);var t=Strophe.getResourceFromJid(e);"focus"!==t||this.xmppService.sessionTerminated||(console.info("Focus has left the room - leaving conference"),location.reload())},setFocusUserJid:function(e){i||(i=e,console.info("Focus jid set to: "+i))},getFocusUserJid:function(){return i},getFocusComponent:function(){var e=config.hosts.focus;return e||(e="focus."+config.hosts.domain),e},createConferenceIq:function(e){var t=$iq({to:f.getFocusComponent(),type:"set"}),n=localStorage.getItem("sessionId"),i=r.getSettings().uid;return console.info("Session ID: "+n+" machine UID: "+i),t.c("conference",{xmlns:"http://jitsi.org/protocol/focus",room:e,"machine-uid":i}),n&&t.attrs({"session-id":n}),void 0!==config.hosts.bridge&&t.c("property",{name:"bridge",value:config.hosts.bridge}).up(),void 0!==config.hosts.call_control&&t.c("property",{name:"call_control",value:config.hosts.call_control}).up(),void 0!==config.channelLastN&&t.c("property",{name:"channelLastN",value:config.channelLastN}).up(),void 0!==config.adaptiveLastN&&t.c("property",{name:"adaptiveLastN",value:config.adaptiveLastN}).up(),void 0!==config.adaptiveSimulcast&&t.c("property",{name:"adaptiveSimulcast",value:config.adaptiveSimulcast}).up(),void 0!==config.openSctp&&t.c("property",{name:"openSctp",value:config.openSctp}).up(),void 0!==config.startAudioMuted&&t.c("property",{name:"startAudioMuted",value:config.startAudioMuted}).up(),void 0!==config.startVideoMuted&&t.c("property",{name:"startVideoMuted",value:config.startVideoMuted}).up(),t.up(),t},parseSessionId:function(e){var t=$(e).find("conference").attr("session-id");t&&(console.info("Received sessionId: "+t),localStorage.setItem("sessionId",t))},parseConfigOptions:function(e){f.setFocusUserJid($(e).find("conference").attr("focusjid"));var t=$(e).find(">conference>property[name='authentication'][value='true']").length>0;console.info("Authentication enabled: "+t),u=$(e).find(">conference>property[name='externalAuth'][value='true']").length>0,console.info("External authentication enabled: "+u),u||f.parseSessionId(e);var n=$(e).find(">conference").attr("identity");p.emit(a.IDENTITY_UPDATED,t,n),$(e).find(">conference>property[name='sipGatewayEnabled'][value='true']").length&&(d=!0),console.info("Sip gateway enabled: "+d)},allocateConferenceFocus:function(e,t){f.setFocusUserJid(config.focusUserJid);var n=f.createConferenceIq(e);s.sendIQ(n,function(n){if(f.parseConfigOptions(n),"true"===$(n).find("conference").attr("ready"))c(!0),l(!0),t();else{var i=c();console.info("Waiting for the focus... "+i),l(!0),window.setTimeout(function(){f.allocateConferenceFocus(e,t)},i)}},function(n){var i=$(n).find(">error>session-invalid").length;if(i&&(console.info("Session expired! - removing"),localStorage.removeItem("sessionId")),$(n).find(">error>graceful-shutdown").length)return void p.emit(o.GRACEFUL_SHUTDOWN);var r=$(n).find(">error>reservation-error");if(r.length){var a,s=r.attr("error-code");return $(n).find(">error>text")&&(a=$(n).find(">error>text").text()),void p.emit(o.RESERVATION_ERROR,s,a)}if($(n).find(">error>not-authorized").length){console.warn("Unauthorized to start the conference",n);var d=Strophe.getDomainFromJid(n.getAttribute("to"));return d!==config.hosts.anonymousdomain&&(u=!0),void p.emit(o.AUTHENTICATION_REQUIRED,function(){f.allocateConferenceFocus(e,t)})}var h=l();console.error("Focus error, retry after "+h,n);var m=f.getFocusComponent(),g=h/1e3;i||APP.UI.messageHandler.notify(null,"notify.focus","disconnected","notify.focusFail",{component:m,ms:g}),c(!0),window.setTimeout(function(){f.allocateConferenceFocus(e,t)},h)})},getLoginUrl:function(e,t){var n=$iq({to:f.getFocusComponent(),type:"get"});n.c("login-url",{xmlns:"http://jitsi.org/protocol/focus",room:e,"machine-uid":r.getSettings().uid}),s.sendIQ(n,function(e){var n=$(e).find("login-url").attr("url");n=n=decodeURIComponent(n),n?(console.info("Got auth url: "+n),t(n)):console.error("Failed to get auth url from the focus",e)},function(e){console.error("Get auth url error",e)})},getPopupLoginUrl:function(e,t){var n=$iq({to:f.getFocusComponent(),type:"get"});n.c("login-url",{xmlns:"http://jitsi.org/protocol/focus",room:e,"machine-uid":r.getSettings().uid,popup:!0}),s.sendIQ(n,function(e){var n=$(e).find("login-url").attr("url");n=n=decodeURIComponent(n),n?(console.info("Got POPUP auth url: "+n),t(n)):console.error("Failed to get POPUP auth url from the focus",e)},function(e){console.error("Get POPUP auth url error",e)})},logout:function(e){var t=$iq({to:f.getFocusComponent(),type:"set"}),n=localStorage.getItem("sessionId");return n?(t.c("logout",{xmlns:"http://jitsi.org/protocol/focus","session-id":n}),void s.sendIQ(t,function(t){var n=$(t).find("logout").attr("logout-url");n&&(n=decodeURIComponent(n)),console.info("Log out OK, url: "+n,t),localStorage.removeItem("sessionId"),e(n)},function(e){console.error("Logout error",e)})):void e()}};t.exports=f},{"../../service/authentication/AuthenticationEvents":70,"../../service/xmpp/XMPPEvents":75,"../settings/Settings":40}],56:[function(e,t){function n(e){c=e}function i(e,t,n,i){l?o(e,t,n,i):r(e,t,n,i)}function o(e,t,n,i){if(e!=a){var o=$iq({to:config.hosts.jirecon,type:"set"}).c("recording",{xmlns:"http://jitsi.org/protocol/jirecon",action:e?"start":"stop",mucjid:i.emuc.roomjid});e||o.attrs({rid:u}),console.log("Start recording"),i.sendIQ(o,function(t){u=$(t).find("recording").attr("rid"),console.log("Recording "+(e?"started":"stopped")+"(jirecon)"+t),a=e,e||(u=null),n(e)},function(e){console.log("Failed to start recording, error: ",e),n(a)})}}function r(e,t,n,i){var o=$iq({to:i.emuc.focusMucJid,type:"set"});o.c("conference",{xmlns:"http://jitsi.org/protocol/colibri"}),o.c("recording",{state:e,token:t}),i.sendIQ(o,function(t){console.log('Set recording "',e,'". Result:',t);var i=$(t).find(">conference>recording"),o="true"===i.attr("state");a=o,n(o)},function(e){console.warn(e),n(a)})}var a,s=e("./moderator"),c=null,l="undefined"!=typeof config.hosts.jirecon,u=null,d={toggleRecording:function(e,t,o,r){if(!s.isModerator())return void console.log("non-focus, or conference not yet organized: not enabling recording");var u=this;if(!c&&!l)return void e(function(i){n(i),u.toggleRecording(e,t,o,r)});var d=a;t(!d),i(!d,c,function(e){console.log("New recording state: ",e),e===d&&n(null),o(e)},r)}};t.exports=d},{"./moderator":55}],57:[function(e,t){var n=e("../../service/xmpp/XMPPEvents"),i=e("./moderator"),o=(e("./JingleSession"),!1);t.exports=function(e,t){Strophe.addConnectionPlugin("emuc",{connection:null,roomjid:null,myroomjid:null,members:{},list_members:[],presMap:{},preziMap:{},joined:!1,isOwner:!1,role:null,focusMucJid:null,ssrc2jid:{},init:function(e){this.connection=e},initPresenceMap:function(e){this.presMap.to=e,this.presMap.xns="http://jabber.org/protocol/muc",APP.RTC.localAudio.isMuted()&&this.addAudioInfoToPresence(!0),APP.RTC.localVideo.isMuted()&&this.addVideoInfoToPresence(!0)},doJoin:function(e,t){this.myroomjid=e,console.info("Joined MUC as "+this.myroomjid),this.initPresenceMap(this.myroomjid),this.roomjid||(this.roomjid=Strophe.getBareJidFromJid(e),this.connection.addHandler(this.onPresence.bind(this),null,"presence",null,null,this.roomjid,{matchBare:!0}),this.connection.addHandler(this.onPresenceUnavailable.bind(this),null,"presence","unavailable",null,this.roomjid,{matchBare:!0}),this.connection.addHandler(this.onPresenceError.bind(this),null,"presence","error",null,this.roomjid,{matchBare:!0}),this.connection.addHandler(this.onMessage.bind(this),null,"message",null,null,this.roomjid,{matchBare:!0})),void 0!==t&&(this.presMap.password=t),this.sendPresence()},doLeave:function(){console.log("do leave",this.myroomjid);var e=$pres({to:this.myroomjid,type:"unavailable"});this.presMap.length=0,this.connection.send(e)
},createNonAnonymousRoom:function(){var e=$iq({type:"get",to:this.roomjid}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}).c("x",{xmlns:"jabber:x:data",type:"submit"}),t=this;this.connection.sendIQ(e,function(e){if(!$(e).find('>query>x[xmlns="jabber:x:data"]>field[var="muc#roomconfig_whois"]').length)return void console.error("non-anonymous rooms not supported");var n=$iq({to:this.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"});n.c("x",{xmlns:"jabber:x:data",type:"submit"}),n.c("field",{"var":"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),n.c("field",{"var":"muc#roomconfig_whois"}).c("value").t("anyone").up().up(),t.connection.sendIQ(n)},function(){console.error("Error getting room configuration form")})},onPresence:function(e){var o=e.getAttribute("from");if(e.getAttribute("type"))return!0;var r=$(e).find(">etherpad");r.length&&config.etherpad_base&&!i.isModerator()&&t.emit(n.ETHERPAD,r.text());var a=$(e).find(">prezi");if(a.length){var s=a.attr("url"),c=a.find(">current").text();console.log("presentation info received from",o,s),null==this.preziMap[o]?(this.preziMap[o]=s,$(document).trigger("presentationadded.muc",[o,s,c])):$(document).trigger("gotoslide.muc",[o,s,c])}else if(null!=this.preziMap[o]){var s=this.preziMap[o];delete this.preziMap[o],$(document).trigger("presentationremoved.muc",[o,s])}var l=$(e).find(">audiomuted");l.length&&$(document).trigger("audiomuted.muc",[o,l.text()]);var u=$(e).find(">videomuted");u.length&&$(document).trigger("videomuted.muc",[o,u.text()]);var d=$(e).find(">startmuted");d.length&&t.emit(n.START_MUTED,"true"===d.attr("audio"),"true"===d.attr("video"));var p=$(e).find(">devices");if(p.length){var f=p.find(">audio"),h=p.find(">video"),m={audio:!1,video:!1};f.length&&"true"===f.text()&&(m.audio=!0),h.length&&"true"===h.text()&&(m.video=!0),t.emit(n.DEVICE_AVAILABLE,Strophe.getResourceFromJid(o),m)}var g=$(e).find(">stats");if(g.length){var v={};Strophe.forEachChild(g[0],"stat",function(e){v[e.getAttribute("name")]=e.getAttribute("value")}),t.emit(n.REMOTE_STATS,o,v)}$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="201"]').length&&(this.isOwner=!0,this.createNonAnonymousRoom());var y={};y.show=$(e).find(">show").text(),y.status=$(e).find(">status").text();var b=$(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>item');y.affiliation=b.attr("affiliation"),y.role=b.attr("role"),y.jid=b.attr("jid"),y.isFocus=!1,y.jid&&0==y.jid.indexOf(i.getFocusUserJid()+"/")&&(y.isFocus=!0);var S=$(e).find('>nick[xmlns="http://jabber.org/protocol/nick"]');if(y.displayName=S.length>0?S.html():null,o==this.myroomjid)"owner"==y.affiliation&&(this.isOwner=!0),this.role!==y.role&&(this.role=y.role,t.emit(n.LOCAL_ROLE_CHANGED,o,y,e,i.isModerator())),this.joined||(this.joined=!0,t.emit(n.MUC_JOINED,o,y),this.list_members.push(o));else if(void 0===this.members[o])if(this.members[o]=y,this.list_members.push(o),console.log("entered",o,y),y.isFocus)this.focusMucJid=o,console.info("Ignore focus: "+o+", real JID: "+y.jid);else{var _=$(e).find(">userId").text(),w=$(e).find(">email");w.length>0&&(_=w.text()),t.emit(n.MUC_MEMBER_JOINED,o,_,y.displayName)}else this.members[o].role!=y.role&&(this.members[o].role=y.role,t.emit(n.MUC_ROLE_CHANGED,y.role,y.displayName));return this.parsePresence(o,y,e),y.status&&t.emit(n.PRESENCE_STATUS,o,y),!0},onPresenceUnavailable:function(i){var o=i.getAttribute("from");if($(i).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>destroy').length){var r,a=$(i).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>destroy>reason');return a.length&&(r=a.text()),e.disposeConference(!1),t.emit(n.MUC_DESTROYED,r),!0}if($(i).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="110"]').length){if(this.list_members.length>1)for(var s=0;s<this.list_members.length;s++){var c=this.list_members[s];delete this.members[s],this.list_members.splice(s,1),this.onParticipantLeft(c)}}else delete this.members[o],this.list_members.splice(this.list_members.indexOf(o),1),this.onParticipantLeft(o);return $(i).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="307"]').length&&($(document).trigger("kicked.muc",[o]),this.myroomjid===o&&(e.disposeConference(!1),t.emit(n.KICKED))),!0},onPresenceError:function(e){var i=e.getAttribute("from");if($(e).find('>error[type="auth"]>not-authorized[xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"]').length){console.log("on password required",i);var o=this;t.emit(n.PASSWORD_REQUIRED,function(e){o.doJoin(i,e)})}else if($(e).find('>error[type="cancel"]>not-allowed[xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"]').length){var r=Strophe.getDomainFromJid(e.getAttribute("to"));r===config.hosts.anonymousdomain?APP.UI.messageHandler.openReportDialog(null,"dialog.joinError",e):(console.warn("onPresError ",e),APP.UI.messageHandler.openReportDialog(null,"dialog.connectError",e))}else console.warn("onPresError ",e),APP.UI.messageHandler.openReportDialog(null,"dialog.connectError",e);return!0},sendMessage:function(e,i){var o=$msg({to:this.roomjid,type:"groupchat"});o.c("body",e).up(),i&&o.c("nick",{xmlns:"http://jabber.org/protocol/nick"}).t(i).up().up(),this.connection.send(o),t.emit(n.SENDING_CHAT_MESSAGE,e)},setSubject:function(e){var t=$msg({to:this.roomjid,type:"groupchat"});t.c("subject",e),this.connection.send(t),console.log("topic changed to "+e)},onMessage:function(e){var i=e.getAttribute("from"),o=$(e).find('>nick[xmlns="http://jabber.org/protocol/nick"]').text()||Strophe.getResourceFromJid(i),r=$(e).find(">body").text(),a=e.getAttribute("type");if("error"==a)return t.emit(n.CHAT_ERROR_RECEIVED,$(e).find(">text").text(),r),!0;var s=$(e).find(">subject");if(s.length){var c=s.text();(c||""==c)&&(t.emit(n.SUBJECT_CHANGED,c),console.log("Subject is changed to "+c))}return r&&(console.log("chat",o,r),t.emit(n.MESSAGE_RECEIVED,i,o,r,this.myroomjid)),!0},lockRoom:function(e,t,n,i){var o=this;this.connection.sendIQ($iq({to:this.roomjid,type:"get"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}),function(r){if($(r).find('>query>x[xmlns="jabber:x:data"]>field[var="muc#roomconfig_roomsecret"]').length){var a=$iq({to:o.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"});a.c("x",{xmlns:"jabber:x:data",type:"submit"}),a.c("field",{"var":"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),a.c("field",{"var":"muc#roomconfig_roomsecret"}).c("value").t(e).up().up(),a.c("field",{"var":"muc#roomconfig_whois"}).c("value").t("anyone").up().up(),o.connection.sendIQ(a,t,n)}else i()},n)},kick:function(e){var t=$iq({to:this.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{nick:Strophe.getResourceFromJid(e),role:"none"}).c("reason").t("You have been kicked.").up().up().up();this.connection.sendIQ(t,function(t){console.log("Kick participant with jid: ",e,t)},function(e){console.log("Kick participant error: ",e)})},sendPresence:function(){if(this.presMap.to){var e=$pres({to:this.presMap.to});if(e.c("x",{xmlns:this.presMap.xns}),this.presMap.password&&e.c("password").t(this.presMap.password).up(),e.up(),this.connection.caps&&(this.connection.caps.node=config.clientNode,e.c("c",this.connection.caps.generateCapsAttrs()).up()),e.c("user-agent",{xmlns:"http://jitsi.org/jitmeet/user-agent"}).t(navigator.userAgent).up(),this.presMap.bridgeIsDown&&e.c("bridgeIsDown").up(),this.presMap.email&&e.c("email").t(this.presMap.email).up(),this.presMap.userId&&e.c("userId").t(this.presMap.userId).up(),this.presMap.displayName&&e.c("nick",{xmlns:"http://jabber.org/protocol/nick"}).t(this.presMap.displayName).up(),this.presMap.devices&&e.c("devices").c("audio").t(this.presMap.devices.audio).up().c("video").t(this.presMap.devices.video).up().up(),this.presMap.audions&&e.c("audiomuted",{xmlns:this.presMap.audions}).t(this.presMap.audiomuted).up(),this.presMap.videons&&e.c("videomuted",{xmlns:this.presMap.videons}).t(this.presMap.videomuted).up(),this.presMap.statsns){var t=e.c("stats",{xmlns:this.presMap.statsns});for(var n in this.presMap.stats)null!=this.presMap.stats[n]&&t.c("stat",{name:n,value:this.presMap.stats[n]}).up();e.up()}if(this.presMap.prezins&&e.c("prezi",{xmlns:this.presMap.prezins,url:this.presMap.preziurl}).c("current").t(this.presMap.prezicurrent).up().up(),this.presMap.etherpadns&&e.c("etherpad",{xmlns:this.presMap.etherpadns}).t(this.presMap.etherpadname).up(),this.presMap.medians){e.c("media",{xmlns:this.presMap.medians});var i=0;if(Object.keys(this.presMap).forEach(function(e){e.indexOf("source")>=0&&i++}),i>0)for(var o=1;i/3>=o;o++)e.c("source",{type:this.presMap["source"+o+"_type"],ssrc:this.presMap["source"+o+"_ssrc"],direction:this.presMap["source"+o+"_direction"]||"sendrecv"}).up();e.up()}void 0!==this.presMap.startMuted&&(e.c("startmuted",{audio:this.presMap.startMuted.audio,video:this.presMap.startMuted.video,xmlns:"http://jitsi.org/jitmeet/start-muted"}),delete this.presMap.startMuted),e.up(),this.connection.send(e)}},addDisplayNameToPresence:function(e){this.presMap.displayName=e},addMediaToPresence:function(e,t,n,i){this.presMap.medians||(this.presMap.medians="http://estos.de/ns/mjs"),this.presMap["source"+e+"_type"]=t,this.presMap["source"+e+"_ssrc"]=n,this.presMap["source"+e+"_direction"]=i},addDevicesToPresence:function(e){this.presMap.devices=e},clearPresenceMedia:function(){var e=this;Object.keys(this.presMap).forEach(function(t){-1!=t.indexOf("source")&&delete e.presMap[t]})},addPreziToPresence:function(e,t){this.presMap.prezins="http://jitsi.org/jitmeet/prezi",this.presMap.preziurl=e,this.presMap.prezicurrent=t},removePreziFromPresence:function(){delete this.presMap.prezins,delete this.presMap.preziurl,delete this.presMap.prezicurrent},addCurrentSlideToPresence:function(e){this.presMap.prezicurrent=e},getPrezi:function(e){return this.preziMap[e]},addEtherpadToPresence:function(e){this.presMap.etherpadns="http://jitsi.org/jitmeet/etherpad",this.presMap.etherpadname=e},addAudioInfoToPresence:function(e){this.presMap.audions="http://jitsi.org/jitmeet/audio",this.presMap.audiomuted=e.toString()},addVideoInfoToPresence:function(e){this.presMap.videons="http://jitsi.org/jitmeet/video",this.presMap.videomuted=e.toString()},addConnectionInfoToPresence:function(e){this.presMap.statsns="http://jitsi.org/jitmeet/stats",this.presMap.stats=e},findJidFromResource:function(e){if(e&&e===Strophe.getResourceFromJid(this.myroomjid))return this.myroomjid;var t=null;return Object.keys(this.members).some(function(n){return t=n,Strophe.getResourceFromJid(n)===e}),t},addBridgeIsDownToPresence:function(){this.presMap.bridgeIsDown=!0},addEmailToPresence:function(e){this.presMap.email=e},addUserIdToPresence:function(e){this.presMap.userId=e},addStartMutedToPresence:function(e,t){this.presMap.startMuted={audio:e,video:t}},isModerator:function(){return"moderator"===this.role},getMemberRole:function(e){return this.members[e]?this.members[e].role:null},onParticipantLeft:function(e){t.emit(n.MUC_MEMBER_LEFT,e),this.connection.jingle.terminateByJid(e),this.getPrezi(e)&&$(document).trigger("presentationremoved.muc",[e,this.getPrezi(e)]),i.onMucMemberLeft(e)},parsePresence:function(e,i,r){if($(r).find(">bridgeIsDown").length>0&&!o&&(o=!0,t.emit(n.BRIDGE_DOWN)),!i.isFocus){var a=this;Object.keys(this.ssrc2jid).forEach(function(t){a.ssrc2jid[t]==e&&delete a.ssrc2jid[t]});var s=[];$(r).find('>media[xmlns="http://estos.de/ns/mjs"]>source').each(function(t,n){var i=n.getAttribute("ssrc");a.ssrc2jid[i]=e;var o=n.getAttribute("type"),r=n.getAttribute("direction");s.push({type:o,direction:r})}),t.emit(n.STREAMS_CHANGED,e,s);var c=config.displayJids?Strophe.getResourceFromJid(e):i.displayName;c&&c.length>0&&t.emit(n.DISPLAY_NAME_CHANGED,e,c);var l=$(r).find(">userID").text(),u=$(r).find(">email");u.length>0&&(l=u.text()),t.emit(n.USER_ID_CHANGED,e,l)}}})}},{"../../service/xmpp/XMPPEvents":75,"./JingleSession":50,"./moderator":55}],58:[function(e,t){var n=e("./JingleSession"),i=e("../../service/xmpp/XMPPEvents");t.exports=function(e,t){function o(e,n){var o=n.jingle.sessions[e];n.jingle.activecall=o,t.emit(i.CALL_INCOMING,o),console.log("emuc data for",o.peerjid,n.emuc.members[o.peerjid]),o.usedrip=!0,o.sendAnswer(),o.accept()}Strophe.addConnectionPlugin("jingle",{connection:null,sessions:{},jid2session:{},ice_config:{iceServers:[]},pc_constraints:{},activecall:null,media_constraints:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},init:function(e){this.connection=e,this.connection.disco&&(this.connection.disco.addFeature("urn:xmpp:jingle:1"),this.connection.disco.addFeature("urn:xmpp:jingle:apps:rtp:1"),this.connection.disco.addFeature("urn:xmpp:jingle:transports:ice-udp:1"),this.connection.disco.addFeature("urn:xmpp:jingle:transports:dtls-sctp:1"),this.connection.disco.addFeature("urn:xmpp:jingle:apps:rtp:audio"),this.connection.disco.addFeature("urn:xmpp:jingle:apps:rtp:video"),config.useRtcpMux&&this.connection.disco.addFeature("urn:ietf:rfc:5761"),config.useBundle&&this.connection.disco.addFeature("urn:ietf:rfc:5888")),this.connection.addHandler(this.onJingle.bind(this),"urn:xmpp:jingle:1","iq","set",null,null)},onJingle:function(t){var i=$(t).find("jingle").attr("sid"),r=$(t).find("jingle").attr("action"),a=t.getAttribute("from"),s=$iq({type:"result",to:a,id:t.getAttribute("id")});console.log("on jingle "+r+" from "+a,t);var c=this.sessions[i];if("session-initiate"!=r){if(null===c)return s.type="error",s.c("error",{type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("unknown-session",{xmlns:"urn:xmpp:jingle:errors:1"}),this.connection.send(s),!0;if(Strophe.getBareJidFromJid(a)!=Strophe.getBareJidFromJid(c.peerjid))return console.warn("jid mismatch for session id",i,a,c.peerjid),s.type="error",s.c("error",{type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("unknown-session",{xmlns:"urn:xmpp:jingle:errors:1"}),this.connection.send(s),!0}else if(void 0!==c)return s.type="error",s.c("error",{type:"cancel"}).c("service-unavailable",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up(),console.warn("duplicate session id",i),this.connection.send(s),!0;switch(this.connection.send(s),r){case"session-initiate":var l=$(t).find("jingle>startmuted");if(l&&l.length>0){var u=l.attr("audio"),d=l.attr("video");APP.UI.setInitialMuteFromFocus("true"===u,"true"===d)}c=new n($(t).attr("to"),$(t).find("jingle").attr("sid"),this.connection,e),c.media_constraints=this.media_constraints,c.pc_constraints=this.pc_constraints,c.ice_config=this.ice_config,c.initiate(a,!1),c.setRemoteDescription($(t).find(">jingle"),"offer"),this.sessions[c.sid]=c,this.jid2session[c.peerjid]=c,o(c.sid,this.connection);break;case"session-accept":c.setRemoteDescription($(t).find(">jingle"),"answer"),c.accept(),$(document).trigger("callaccepted.jingle",[c.sid]);break;case"session-terminate":if(Object.keys(this.sessions).length<1||!(this.sessions[Object.keys(this.sessions)[0]]instanceof n))break;console.log("terminating...",c.sid),c.terminate(),this.terminate(c.sid),$(t).find(">jingle>reason").length?$(document).trigger("callterminated.jingle",[c.sid,c.peerjid,$(t).find(">jingle>reason>:first")[0].tagName,$(t).find(">jingle>reason>text").text()]):$(document).trigger("callterminated.jingle",[c.sid,c.peerjid]);break;case"transport-info":c.addIceCandidate($(t).find(">jingle>content"));break;case"session-info":var p;$(t).find('>jingle>ringing[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length?$(document).trigger("ringing.jingle",[c.sid]):$(t).find('>jingle>mute[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length?(p=$(t).find('>jingle>mute[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').attr("name"),$(document).trigger("mute.jingle",[c.sid,p])):$(t).find('>jingle>unmute[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').length&&(p=$(t).find('>jingle>unmute[xmlns="urn:xmpp:jingle:apps:rtp:info:1"]').attr("name"),$(document).trigger("unmute.jingle",[c.sid,p]));break;case"addsource":case"source-add":c.addSource($(t).find(">jingle>content"),a);break;case"removesource":case"source-remove":c.removeSource($(t).find(">jingle>content"),a);break;default:console.warn("jingle action not implemented",r)}return!0},initiate:function(t,i){var o=new n(i||this.connection.jid,Math.random().toString(36).substr(2,12),this.connection,e);return o.media_constraints=this.media_constraints,o.pc_constraints=this.pc_constraints,o.ice_config=this.ice_config,o.initiate(t,!0),this.sessions[o.sid]=o,this.jid2session[o.peerjid]=o,o.sendOffer(),o},terminate:function(e,t,n){if(null===e||void 0===e)for(e in this.sessions)"ended"!=this.sessions[e].state&&(this.sessions[e].sendTerminate(t||!this.sessions[e].active()?"cancel":null,n),this.sessions[e].terminate()),delete this.jid2session[this.sessions[e].peerjid],delete this.sessions[e];else this.sessions.hasOwnProperty(e)&&("ended"!=this.sessions[e].state&&(this.sessions[e].sendTerminate(t||!this.sessions[e].active()?"cancel":null,n),this.sessions[e].terminate()),delete this.jid2session[this.sessions[e].peerjid],delete this.sessions[e])},terminateByJid:function(e){if(this.jid2session.hasOwnProperty(e)){var t=this.jid2session[e];t&&(t.terminate(),console.log("peer went away silently",e),delete this.sessions[t.sid],delete this.jid2session[e],$(document).trigger("callterminated.jingle",[t.sid,e],"gone"))}},terminateRemoteByJid:function(e,t){if(this.jid2session.hasOwnProperty(e)){var n=this.jid2session[e];n&&(n.sendTerminate(t||!n.active()?"kick":null),n.terminate(),console.log("terminate peer with jid",n.sid,e),delete this.sessions[n.sid],delete this.jid2session[e],$(document).trigger("callterminated.jingle",[n.sid,e,"kicked"]))}},getStunAndTurnCredentials:function(){var e=this;this.connection.sendIQ($iq({type:"get",to:this.connection.domain}).c("services",{xmlns:"urn:xmpp:extdisco:1"}).c("service",{host:"turn."+this.connection.domain}),function(t){var n=[];$(t).find(">services>service").each(function(e,t){t=$(t);var i={},o=t.attr("type");switch(o){case"stun":i.url="stun:"+t.attr("host"),t.attr("port")&&(i.url+=":"+t.attr("port")),n.push(i);break;case"turn":case"turns":i.url=o+":",t.attr("username")&&(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10)<28?i.url+=t.attr("username")+"@":i.username=t.attr("username")),i.url+=t.attr("host"),t.attr("port")&&"3478"!=t.attr("port")&&(i.url+=":"+t.attr("port")),t.attr("transport")&&"udp"!=t.attr("transport")&&(i.url+="?transport="+t.attr("transport")),t.attr("password")&&(i.credential=t.attr("password")),n.push(i)}}),e.ice_config.iceServers=n},function(e){console.warn("getting turn credentials failed",e),console.warn("is mod_turncredentials or similar installed?")})},populateData:function(){var e={};return Object.keys(this.sessions).forEach(function(t){var n=this.sessions[t];n.peerconnection&&n.peerconnection.updateLog&&(e["jingle_"+n.sid]={updateLog:n.peerconnection.updateLog,stats:n.peerconnection.stats,url:window.location.href})}),e}})}},{"../../service/xmpp/XMPPEvents":75,"./JingleSession":50}],59:[function(e,t){t.exports=function(){Strophe.addConnectionPlugin("logger",{connection:null,log:[],init:function(e){this.connection=e,this.connection.rawInput=this.log_incoming.bind(this),this.connection.rawOutput=this.log_outgoing.bind(this)},log_incoming:function(e){this.log.push([(new Date).getTime(),"incoming",e])},log_outgoing:function(e){this.log.push([(new Date).getTime(),"outgoing",e])}})}},{}],60:[function(e,t){t.exports=function(e){Strophe.addConnectionPlugin("moderate",{connection:null,init:function(e){this.connection=e,this.connection.addHandler(this.onMute.bind(this),"http://jitsi.org/jitmeet/audio","iq","set",null,null)},setMute:function(e,t){console.info("set mute",t);var n=$iq({to:this.connection.emuc.focusMucJid,type:"set"}).c("mute",{xmlns:"http://jitsi.org/jitmeet/audio",jid:e}).t(t.toString()).up();this.connection.sendIQ(n,function(e){console.log("set mute",e)},function(e){console.log("set mute error",e)})},onMute:function(t){var n=t.getAttribute("from");if(n!==this.connection.emuc.focusMucJid)return console.warn("Ignored mute from non focus peer"),!1;var i=$(t).find("mute");if(i.length){var o="true"===i.text();APP.UI.setAudioMuted(o),e.forceMuted=o}return!0},eject:function(e){this.connection.emuc.kick(e)}})}},{}],61:[function(e,t){t.exports=function(){Strophe.addConnectionPlugin("rayo",{RAYO_XMLNS:"urn:xmpp:rayo:1",connection:null,init:function(e){this.connection=e,this.connection.disco&&this.connection.disco.addFeature("urn:xmpp:rayo:client:1"),this.connection.addHandler(this.onRayo.bind(this),this.RAYO_XMLNS,"iq","set",null,null)},onRayo:function(e){console.info("Rayo IQ",e)},dial:function(e,t,n,i){var o=$iq({type:"set",to:this.connection.emuc.focusMucJid});o.c("dial",{xmlns:this.RAYO_XMLNS,to:e,from:t}),o.c("header",{name:"JvbRoomName",value:n}).up(),null!==i&&i.length&&o.c("header",{name:"JvbRoomPassword",value:i}).up(),this.connection.sendIQ(o,function(e){console.info("Dial result ",e);var t=$(e).find("ref").attr("uri");this.call_resource=t.substr("xmpp:".length),console.info("Received call resource: "+this.call_resource)},function(e){console.info("Dial error ",e)})},hang_up:function(){if(!this.call_resource)return void console.warn("No call in progress");var e=this,t=$iq({type:"set",to:this.call_resource});t.c("hangup",{xmlns:this.RAYO_XMLNS}),this.connection.sendIQ(t,function(t){console.info("Hangup result ",t),e.call_resource=null},function(t){console.info("Hangup error ",t),e.call_resource=null})}})}},{}],62:[function(e,t){t.exports=function(){Strophe.log=function(e,t){switch(e){case Strophe.LogLevel.WARN:console.warn("Strophe: "+t);break;case Strophe.LogLevel.ERROR:case Strophe.LogLevel.FATAL:console.error("Strophe: "+t)}},Strophe.getStatusString=function(e){switch(e){case Strophe.Status.ERROR:return"ERROR";case Strophe.Status.CONNECTING:return"CONNECTING";case Strophe.Status.CONNFAIL:return"CONNFAIL";case Strophe.Status.AUTHENTICATING:return"AUTHENTICATING";case Strophe.Status.AUTHFAIL:return"AUTHFAIL";case Strophe.Status.CONNECTED:return"CONNECTED";case Strophe.Status.DISCONNECTED:return"DISCONNECTED";case Strophe.Status.DISCONNECTING:return"DISCONNECTING";case Strophe.Status.ATTACHED:return"ATTACHED";default:return"unknown"}}}},{}],63:[function(e,t){function n(e,t){var n=y.operation({retries:3});n.attempt(function(){S=A.createConnection(),c.setConnection(S),S.disco,S.jingle.pc_constraints=APP.RTC.getPCConstraints(),config.useIPv6&&(S.jingle.pc_constraints.optional||(S.jingle.pc_constraints.optional=[]),S.jingle.pc_constraints.optional.push({googIPv6:!0}));var o=p.getSettings();o.email&&S.emuc.addEmailToPresence(o.email),o.uid&&S.emuc.addUserIdToPresence(o.uid),o.displayName&&S.emuc.addDisplayNameToPresence(o.displayName);var r,a=!1,s=!1;S.connect(e,t,function(e,o){if(console.log("Strophe status changed to",Strophe.getStatusString(e),o),e===Strophe.Status.CONNECTED)config.useStunTurn&&S.jingle.getStunAndTurnCredentials(),console.info("My Jabber ID: "+S.jid),t&&(_=!0),i();else if(e===Strophe.Status.CONNFAIL)"x-strophe-bad-non-anon-jid"===o?a=!0:s=!0,r=o;else if(e===Strophe.Status.DISCONNECTED)if(a)A.promptLogin();else{if(s&&n.retry("connection-failed"))return;b.emit(v.CONNECTION_FAILED,o?o:r)}else e===Strophe.Status.AUTHFAIL&&A.promptLogin()})})}function i(){S&&S.connected&&Strophe.getResourceFromJid(S.jid)&&(APP.RTC.localAudio||APP.RTC.localVideo)&&o()}function o(){var e=APP.UI.generateRoomName();c.allocateConferenceFocus(e,APP.UI.checkForNicknameAndJoin)}function r(){e("./strophe.emuc")(A,b),e("./strophe.jingle")(A,b),e("./strophe.moderate")(A),e("./strophe.util")(),e("./strophe.rayo")(),e("./strophe.logger")()}function a(){APP.RTC.addStreamListener(i,h.EVENT_TYPE_LOCAL_CREATED),APP.RTC.addListener(m.AVAILABLE_DEVICES_CHANGED,function(e){A.addToPresence("devices",e)}),APP.UI.addListener(g.NICKNAME_CHANGED,function(e){A.addToPresence("displayName",e)})}function s(){$(window).bind("beforeunload",w),$(window).bind("unload",w)}var c=e("./moderator"),l=e("events"),u=e("./recording"),d=e("./SDP"),p=e("../settings/Settings"),f=e("pako"),h=e("../../service/RTC/StreamEventTypes"),m=e("../../service/RTC/RTCEvents"),g=e("../../service/UI/UIEvents"),v=e("../../service/xmpp/XMPPEvents"),y=e("retry"),b=new l,S=null,_=!1,w=function(){var e=!1;return function(){e||(e=!0,S&&S.connected&&$.ajax({type:"POST",url:config.bosh,async:!1,cache:!1,contentType:"application/xml",crossDomain:!0,data:"<body rid='"+(S.rid||S._proto.rid)+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+(S.sid||S._proto.sid)+"' type='terminate'><presence xmlns='jabber:client' type='unavailable'/></body>",success:function(e){console.log("signed out"),console.log(e)},error:function(e,t,n){console.log("signout error",t+" ("+n+")")}}),A.disposeConference(!0))}}(),A={getConnection:function(){return S},sessionTerminated:!1,Status:Strophe.Status,forceMuted:!1,start:function(){s(),r(),a(),c.init(this,b);var e=config.hosts.anonymousdomain||config.hosts.domain;config.hosts.anonymousdomain&&-1!==window.location.search.indexOf("login=true")&&(e=config.hosts.domain);var t=e||window.location.hostname;n(t,null)},createConnection:function(){var e=config.bosh||"/http-bind";return new Strophe.Connection(e)},getStatusString:function(e){return Strophe.getStatusString(e)},promptLogin:function(){APP.UI.showLoginPopup(n)},joinRoom:function(e,t,n){var i;if(i=e,t)i+=n?"/"+n:"/"+Strophe.getNodeFromJid(S.jid);else{var o=Strophe.getNodeFromJid(S.jid);_||(o=o.substr(0,8)),i+="/"+o}S.emuc.doJoin(i)},myJid:function(){return S?S.emuc.myroomjid:null},myResource:function(){return S&&S.emuc.myroomjid?Strophe.getResourceFromJid(S.emuc.myroomjid):null},disposeConference:function(e){b.emit(v.DISPOSE_CONFERENCE,e);var t=S.jingle.activecall;t&&t.peerconnection&&(APP.RTC.localAudio&&t.peerconnection.removeStream(APP.RTC.localAudio.getOriginalStream(),e),APP.RTC.localVideo&&t.peerconnection.removeStream(APP.RTC.localVideo.getOriginalStream(),e),t.peerconnection.close()),S.jingle.activecall=null,e||(this.sessionTerminated=!0,S.emuc.doLeave())},addListener:function(e,t){b.on(e,t)},removeListener:function(e,t){b.removeListener(e,t)},allocateConferenceFocus:function(e,t){c.allocateConferenceFocus(e,t)},getLoginUrl:function(e,t){c.getLoginUrl(e,t)},getPopupLoginUrl:function(e,t){c.getPopupLoginUrl(e,t)},isModerator:function(){return c.isModerator()},isSipGatewayEnabled:function(){return c.isSipGatewayEnabled()},isExternalAuthEnabled:function(){return c.isExternalAuthEnabled()},switchStreams:function(e,t,n,i){S&&S.jingle.activecall?S.jingle.activecall.switchStreams(e,t,n,i):(console.warn("No conference handler or conference not started yet"),n())},sendVideoInfoPresence:function(e){S&&(S.emuc.addVideoInfoToPresence(e),S.emuc.sendPresence())},setVideoMute:function(e,t,n){if(S){var i=this,o=function(e){return i.sendVideoInfoPresence(e),t(e)};S.jingle.activecall?S.jingle.activecall.setVideoMute(e,o,n):o(e)}},setAudioMute:function(e,t){return S&&APP.RTC.localAudio?(this.forceMuted&&!e&&(console.info("Asking focus for unmute"),S.moderate.setMute(S.emuc.myroomjid,e),this.forceMuted=!1),e==APP.RTC.localAudio.isMuted()?!0:(APP.RTC.localAudio.setMute(!e),this.sendAudioInfoPresence(e,t),!0)):!1},sendAudioInfoPresence:function(e,t){return S&&(S.emuc.addAudioInfoToPresence(e),S.emuc.sendPresence()),t(),!0},muteVideo:function(e,t){e.setRemoteDescription(e.remoteDescription,function(){e.createAnswer(function(n){var i=new d(n.sdp);i.media.length>1&&(i.media[1]=t?i.media[1].replace("a=recvonly","a=sendrecv"):i.media[1].replace("a=sendrecv","a=recvonly"),i.raw=i.session+i.media.join(""),n.sdp=i.raw),e.setLocalDescription(n,function(){console.log("mute SLD ok")},function(){console.log("mute SLD error"),APP.UI.messageHandler.showError("dialog.error","dialog.SLDFailure")})},function(e){console.log(e),APP.UI.messageHandler.showError()})},function(){console.log("muteVideo SRD error"),APP.UI.messageHandler.showError("dialog.error","dialog.SRDFailure")})},toggleRecording:function(e,t,n){u.toggleRecording(e,t,n,S)},addToPresence:function(e,t,n){switch(e){case"displayName":S.emuc.addDisplayNameToPresence(t);break;case"etherpad":S.emuc.addEtherpadToPresence(t);break;case"prezi":S.emuc.addPreziToPresence(t,0);break;case"preziSlide":S.emuc.addCurrentSlideToPresence(t);break;case"connectionQuality":S.emuc.addConnectionInfoToPresence(t);break;case"email":S.emuc.addEmailToPresence(t);break;case"devices":S.emuc.addDevicesToPresence(t);break;case"startMuted":if(!c.isModerator())return;S.emuc.addStartMutedToPresence(t[0],t[1]);break;default:return void console.log("Unknown tag for presence: "+e)}n||S.emuc.sendPresence()},sendLogs:function(e){if(!S.emuc.focusMucJid)return!1;var t=!0,n=JSON.stringify(e);t&&(n=String.fromCharCode.apply(null,f.deflateRaw(n))),n=Base64.encode(n);var i=$msg({to:S.emuc.focusMucJid,type:"normal"});return i.c("log",{xmlns:"urn:xmpp:eventlog",id:"PeerConnectionStats"}),i.c("message").t(n).up(),t&&i.c("tag",{name:"deflated",value:"true"}).up(),i.up(),S.send(i),!0},populateData:function(){var e={};return S.jingle&&(e=S.jingle.populateData()),e},getLogger:function(){return S.logger?S.logger.log:null},getPrezi:function(){return S.emuc.getPrezi(this.myJid())},removePreziFromPresence:function(){S.emuc.removePreziFromPresence(),S.emuc.sendPresence()},sendChatMessage:function(e,t){S.emuc.sendMessage(e,t)},setSubject:function(e){S.emuc.setSubject(e)},lockRoom:function(e,t,n,i){S.emuc.lockRoom(e,t,n,i)},dial:function(e,t,n,i){S.rayo.dial(e,t,n,i)},setMute:function(e,t){S.moderate.setMute(e,t)},eject:function(e){S.moderate.eject(e)},logout:function(e){c.logout(e)},findJidFromResource:function(e){return S.emuc.findJidFromResource(e)},getMembers:function(){return S.emuc.members},getJidFromSSRC:function(e){return S?S.emuc.ssrc2jid[e]:null},getMUCJoined:function(){return S.emuc.joined},getSessions:function(){return S.jingle.sessions},removeStream:function(e){S&&S.jingle.activecall&&S.jingle.activecall.peerconnection&&S.jingle.activecall.peerconnection.removeStream(e)}};t.exports=A},{"../../service/RTC/RTCEvents":66,"../../service/RTC/StreamEventTypes":68,"../../service/UI/UIEvents":69,"../../service/xmpp/XMPPEvents":75,"../settings/Settings":40,"./SDP":51,"./moderator":55,"./recording":56,"./strophe.emuc":57,"./strophe.jingle":58,"./strophe.logger":59,"./strophe.moderate":60,"./strophe.rayo":61,"./strophe.util":62,events:77,pako:81,retry:97}],64:[function(e,t){var n={VIDEO_TYPE:"Video",AUDIO_TYPE:"Audio"};t.exports=n},{}],65:[function(e,t){var n={RTC_BROWSER_CHROME:"rtc_browser.chrome",RTC_BROWSER_FIREFOX:"rtc_browser.firefox"};t.exports=n},{}],66:[function(e,t){var n={LASTN_CHANGED:"rtc.lastn_changed",DOMINANTSPEAKER_CHANGED:"rtc.dominantspeaker_changed",LASTN_ENDPOINT_CHANGED:"rtc.lastn_endpoint_changed",SIMULCAST_LAYER_CHANGED:"rtc.simulcast_layer_changed",SIMULCAST_LAYER_CHANGING:"rtc.simulcast_layer_changing",SIMULCAST_START:"rtc.simlcast_start",SIMULCAST_STOP:"rtc.simlcast_stop",AVAILABLE_DEVICES_CHANGED:"rtc.available_devices_changed"};t.exports=n},{}],67:[function(e,t){var n={1080:{width:1920,height:1080,order:7},fullhd:{width:1920,height:1080,order:7},720:{width:1280,height:720,order:6},hd:{width:1280,height:720,order:6},960:{width:960,height:720,order:5},640:{width:640,height:480,order:4},vga:{width:640,height:480,order:4},360:{width:640,height:360,order:3},320:{width:320,height:240,order:2},180:{width:320,height:180,order:1}};t.exports=n},{}],68:[function(e,t){var n={EVENT_TYPE_LOCAL_CREATED:"stream.local_created",EVENT_TYPE_LOCAL_CHANGED:"stream.local_changed",EVENT_TYPE_LOCAL_ENDED:"stream.local_ended",EVENT_TYPE_REMOTE_CREATED:"stream.remote_created",EVENT_TYPE_REMOTE_ENDED:"stream.remote_ended",EVENT_TYPE_REMOTE_CHANGED:"stream.changed"};t.exports=n},{}],69:[function(e,t){var n={NICKNAME_CHANGED:"UI.nickname_changed",SELECTED_ENDPOINT:"UI.selected_endpoint",PINNED_ENDPOINT:"UI.pinned_endpoint"};
t.exports=n},{}],70:[function(e,t){var n={IDENTITY_UPDATED:"authentication.identity_updated"};t.exports=n},{}],71:[function(e,t){var n={LOCALSTATS_UPDATED:"cq.localstats_updated",REMOTESTATS_UPDATED:"cq.remotestats_updated",STOP:"cq.stop"};t.exports=n},{}],72:[function(e,t){var n={INIT:"ds.init",SWITCHING_DONE:"ds.switching_done",NEW_STREAM_CREATED:"ds.new_stream_created"};t.exports=n},{}],73:[function(e,t){var n={DTMF_SUPPORT_CHANGED:"members.dtmf_support_changed"};t.exports=n},{}],74:[function(e,t){t.exports={getLanguages:function(){var e=[];for(var t in this)"string"==typeof this[t]&&e.push(this[t]);return e},EN:"en",BG:"bg",DE:"de",TR:"tr"}},{}],75:[function(e,t){var n={CONNECTION_FAILED:"xmpp.connection.failed",CONFERENCE_CREATED:"xmpp.conferenceCreated.jingle",CALL_TERMINATED:"xmpp.callterminated.jingle",CALL_INCOMING:"xmpp.callincoming.jingle",DISPOSE_CONFERENCE:"xmpp.dispose_conference",GRACEFUL_SHUTDOWN:"xmpp.graceful_shutdown",KICKED:"xmpp.kicked",BRIDGE_DOWN:"xmpp.bridge_down",USER_ID_CHANGED:"xmpp.user_id_changed",STREAMS_CHANGED:"xmpp.streams_changed",MUC_JOINED:"xmpp.muc_joined",MUC_MEMBER_JOINED:"xmpp.muc_member_joined",MUC_MEMBER_LEFT:"xmpp.muc_member_left",MUC_ROLE_CHANGED:"xmpp.muc_role_changed",MUC_DESTROYED:"xmpp.muc_destroyed",DISPLAY_NAME_CHANGED:"xmpp.display_name_changed",REMOTE_STATS:"xmpp.remote_stats",LOCAL_ROLE_CHANGED:"xmpp.localrole_changed",PRESENCE_STATUS:"xmpp.presence_status",RESERVATION_ERROR:"xmpp.room_reservation_error",SUBJECT_CHANGED:"xmpp.subject_changed",MESSAGE_RECEIVED:"xmpp.message_received",SENDING_CHAT_MESSAGE:"xmpp.sending_chat_message",PASSWORD_REQUIRED:"xmpp.password_required",AUTHENTICATION_REQUIRED:"xmpp.authentication_required",CHAT_ERROR_RECEIVED:"xmpp.chat_error_received",ETHERPAD:"xmpp.etherpad",DEVICE_AVAILABLE:"xmpp.device_available",START_MUTED:"xmpp.start_muted"};t.exports=n},{}],76:[function(t,n){(function(t){!function(){function i(e){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0,e.apply(o,arguments)}}var o,r,a={};o=this,null!=o&&(r=o.async),a.noConflict=function(){return o.async=r,a};var s=Object.prototype.toString,c=Array.isArray||function(e){return"[object Array]"===s.call(e)},l=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n+=1)t(e[n],n,e)},u=function(e,t){if(e.map)return e.map(t);var n=[];return l(e,function(e,i,o){n.push(t(e,i,o))}),n},d=function(e,t,n){return e.reduce?e.reduce(t,n):(l(e,function(e,i,o){n=t(n,e,i,o)}),n)},p=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};"undefined"!=typeof t&&t.nextTick?(a.nextTick=t.nextTick,a.setImmediate="undefined"!=typeof setImmediate?function(e){setImmediate(e)}:a.nextTick):"function"==typeof setImmediate?(a.nextTick=function(e){setImmediate(e)},a.setImmediate=a.nextTick):(a.nextTick=function(e){setTimeout(e,0)},a.setImmediate=a.nextTick),a.each=function(e,t,n){function o(t){t?(n(t),n=function(){}):(r+=1,r>=e.length&&n())}if(n=n||function(){},!e.length)return n();var r=0;l(e,function(e){t(e,i(o))})},a.forEach=a.each,a.eachSeries=function(e,t,n){if(n=n||function(){},!e.length)return n();var i=0,o=function(){t(e[i],function(t){t?(n(t),n=function(){}):(i+=1,i>=e.length?n():o())})};o()},a.forEachSeries=a.eachSeries,a.eachLimit=function(e,t,n,i){var o=f(t);o.apply(null,[e,n,i])},a.forEachLimit=a.eachLimit;var f=function(e){return function(t,n,i){if(i=i||function(){},!t.length||0>=e)return i();var o=0,r=0,a=0;!function s(){if(o>=t.length)return i();for(;e>a&&r<t.length;)r+=1,a+=1,n(t[r-1],function(e){e?(i(e),i=function(){}):(o+=1,a-=1,o>=t.length?i():s())})}()}},h=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[a.each].concat(t))}},m=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[f(e)].concat(n))}},g=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[a.eachSeries].concat(t))}},v=function(e,t,n,i){if(t=u(t,function(e,t){return{index:t,value:e}}),i){var o=[];e(t,function(e,t){n(e.value,function(n,i){o[e.index]=i,t(n)})},function(e){i(e,o)})}else e(t,function(e,t){n(e.value,function(e){t(e)})})};a.map=h(v),a.mapSeries=g(v),a.mapLimit=function(e,t,n,i){return y(t)(e,n,i)};var y=function(e){return m(e,v)};a.reduce=function(e,t,n,i){a.eachSeries(e,function(e,i){n(t,e,function(e,n){t=n,i(e)})},function(e){i(e,t)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(e,t,n,i){var o=u(e,function(e){return e}).reverse();a.reduce(o,t,n,i)},a.foldr=a.reduceRight;var b=function(e,t,n,i){var o=[];t=u(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n&&o.push(e),t()})},function(){i(u(o.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};a.filter=h(b),a.filterSeries=g(b),a.select=a.filter,a.selectSeries=a.filterSeries;var S=function(e,t,n,i){var o=[];t=u(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n||o.push(e),t()})},function(){i(u(o.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};a.reject=h(S),a.rejectSeries=g(S);var _=function(e,t,n,i){e(t,function(e,t){n(e,function(n){n?(i(e),i=function(){}):t()})},function(){i()})};a.detect=h(_),a.detectSeries=g(_),a.some=function(e,t,n){a.each(e,function(e,i){t(e,function(e){e&&(n(!0),n=function(){}),i()})},function(){n(!1)})},a.any=a.some,a.every=function(e,t,n){a.each(e,function(e,i){t(e,function(e){e||(n(!1),n=function(){}),i()})},function(){n(!0)})},a.all=a.every,a.sortBy=function(e,t,n){a.map(e,function(e,n){t(e,function(t,i){t?n(t):n(null,{value:e,criteria:i})})},function(e,t){if(e)return n(e);var i=function(e,t){var n=e.criteria,i=t.criteria;return i>n?-1:n>i?1:0};n(null,u(t.sort(i),function(e){return e.value}))})},a.auto=function(e,t){t=t||function(){};var n=p(e),i=n.length;if(!i)return t();var o={},r=[],s=function(e){r.unshift(e)},u=function(e){for(var t=0;t<r.length;t+=1)if(r[t]===e)return void r.splice(t,1)},f=function(){i--,l(r.slice(0),function(e){e()})};s(function(){if(!i){var e=t;t=function(){},e(null,o)}}),l(n,function(n){var i=c(e[n])?e[n]:[e[n]],r=function(e){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1&&(i=i[0]),e){var r={};l(p(o),function(e){r[e]=o[e]}),r[n]=i,t(e,r),t=function(){}}else o[n]=i,a.setImmediate(f)},h=i.slice(0,Math.abs(i.length-1))||[],m=function(){return d(h,function(e,t){return e&&o.hasOwnProperty(t)},!0)&&!o.hasOwnProperty(n)};if(m())i[i.length-1](r,o);else{var g=function(){m()&&(u(g),i[i.length-1](r,o))};s(g)}})},a.retry=function(e,t,n){var i=5,o=[];"function"==typeof e&&(n=t,t=e,e=i),e=parseInt(e,10)||i;var r=function(i,r){for(var s=function(e,t){return function(n){e(function(e,i){n(!e||t,{err:e,result:i})},r)}};e;)o.push(s(t,!(e-=1)));a.series(o,function(e,t){t=t[t.length-1],(i||n)(t.err,t.result)})};return n?r():r},a.waterfall=function(e,t){if(t=t||function(){},!c(e)){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}if(!e.length)return t();var i=function(e){return function(n){if(n)t.apply(null,arguments),t=function(){};else{var o=Array.prototype.slice.call(arguments,1),r=e.next();o.push(r?i(r):t),a.setImmediate(function(){e.apply(null,o)})}}};i(a.iterator(e))()};var w=function(e,t,n){if(n=n||function(){},c(t))e.map(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var i={};e.each(p(t),function(e,n){t[e](function(t){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),i[e]=o,n(t)})},function(e){n(e,i)})}};a.parallel=function(e,t){w({map:a.map,each:a.each},e,t)},a.parallelLimit=function(e,t,n){w({map:y(t),each:f(t)},e,n)},a.series=function(e,t){if(t=t||function(){},c(e))a.mapSeries(e,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},t);else{var n={};a.eachSeries(p(e),function(t,i){e[t](function(e){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),n[t]=o,i(e)})},function(e){t(e,n)})}},a.iterator=function(e){var t=function(n){var i=function(){return e.length&&e[n].apply(null,arguments),i.next()};return i.next=function(){return n<e.length-1?t(n+1):null},i};return t(0)},a.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var A=function(e,t,n,i){var o=[];e(t,function(e,t){n(e,function(e,n){o=o.concat(n||[]),t(e)})},function(e){i(e,o)})};a.concat=h(A),a.concatSeries=g(A),a.whilst=function(e,t,n){e()?t(function(i){return i?n(i):void a.whilst(e,t,n)}):n()},a.doWhilst=function(e,t,n){e(function(i){if(i)return n(i);var o=Array.prototype.slice.call(arguments,1);t.apply(null,o)?a.doWhilst(e,t,n):n()})},a.until=function(e,t,n){e()?n():t(function(i){return i?n(i):void a.until(e,t,n)})},a.doUntil=function(e,t,n){e(function(i){if(i)return n(i);var o=Array.prototype.slice.call(arguments,1);t.apply(null,o)?n():a.doUntil(e,t,n)})},a.queue=function(e,t){function n(e,t,n,i){return e.started||(e.started=!0),c(t)||(t=[t]),0==t.length?a.setImmediate(function(){e.drain&&e.drain()}):void l(t,function(t){var o={data:t,callback:"function"==typeof i?i:null};n?e.tasks.unshift(o):e.tasks.push(o),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),a.setImmediate(e.process)})}void 0===t&&(t=1);var o=0,r={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(e,t){n(r,e,!1,t)},kill:function(){r.drain=null,r.tasks=[]},unshift:function(e,t){n(r,e,!0,t)},process:function(){if(!r.paused&&o<r.concurrency&&r.tasks.length){var t=r.tasks.shift();r.empty&&0===r.tasks.length&&r.empty(),o+=1;var n=function(){o-=1,t.callback&&t.callback.apply(t,arguments),r.drain&&r.tasks.length+o===0&&r.drain(),r.process()},a=i(n);e(t.data,a)}},length:function(){return r.tasks.length},running:function(){return o},idle:function(){return r.tasks.length+o===0},pause:function(){r.paused!==!0&&(r.paused=!0,r.process())},resume:function(){r.paused!==!1&&(r.paused=!1,r.process())}};return r},a.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}function i(e,t,n){for(var i=-1,o=e.length-1;o>i;){var r=i+(o-i+1>>>1);n(t,e[r])>=0?i=r:o=r-1}return i}function o(e,t,o,r){return e.started||(e.started=!0),c(t)||(t=[t]),0==t.length?a.setImmediate(function(){e.drain&&e.drain()}):void l(t,function(t){var s={data:t,priority:o,callback:"function"==typeof r?r:null};e.tasks.splice(i(e.tasks,s,n)+1,0,s),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),a.setImmediate(e.process)})}var r=a.queue(e,t);return r.push=function(e,t,n){o(r,e,t,n)},delete r.unshift,r},a.cargo=function(e,t){var n=!1,i=[],o={tasks:i,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(e,n){c(e)||(e=[e]),l(e,function(e){i.push({data:e,callback:"function"==typeof n?n:null}),o.drained=!1,o.saturated&&i.length===t&&o.saturated()}),a.setImmediate(o.process)},process:function r(){if(!n){if(0===i.length)return o.drain&&!o.drained&&o.drain(),void(o.drained=!0);var a="number"==typeof t?i.splice(0,t):i.splice(0,i.length),s=u(a,function(e){return e.data});o.empty&&o.empty(),n=!0,e(s,function(){n=!1;var e=arguments;l(a,function(t){t.callback&&t.callback.apply(null,e)}),r()})}},length:function(){return i.length},running:function(){return n}};return o};var x=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&l(n,function(t){console[e](t)}))}]))}};a.log=x("log"),a.dir=x("dir"),a.memoize=function(e,t){var n={},i={};t=t||function(e){return e};var o=function(){var o=Array.prototype.slice.call(arguments),r=o.pop(),s=t.apply(null,o);s in n?a.nextTick(function(){r.apply(null,n[s])}):s in i?i[s].push(r):(i[s]=[r],e.apply(null,o.concat([function(){n[s]=arguments;var e=i[s];delete i[s];for(var t=0,o=e.length;o>t;t++)e[t].apply(null,arguments)}])))};return o.memo=n,o.unmemoized=e,o},a.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},a.times=function(e,t,n){for(var i=[],o=0;e>o;o++)i.push(o);return a.map(i,t,n)},a.timesSeries=function(e,t,n){for(var i=[],o=0;e>o;o++)i.push(o);return a.mapSeries(i,t,n)},a.seq=function(){var e=arguments;return function(){var t=this,n=Array.prototype.slice.call(arguments),i=n.pop();a.reduce(e,n,function(e,n,i){n.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);i(e,t)}]))},function(e,n){i.apply(t,[e].concat(n))})}},a.compose=function(){return a.seq.apply(null,Array.prototype.reverse.call(arguments))};var P=function(e,t){var n=function(){var n=this,i=Array.prototype.slice.call(arguments),o=i.pop();return e(t,function(e,t){e.apply(n,i.concat([t]))},o)};if(arguments.length>2){var i=Array.prototype.slice.call(arguments,2);return n.apply(this,i)}return n};a.applyEach=h(P),a.applyEachSeries=g(P),a.forever=function(e,t){function n(i){if(i){if(t)return t(i);throw i}e(n)}n()},"undefined"!=typeof n&&n.exports?n.exports=a:"undefined"!=typeof e&&e.amd?e([],function(){return a}):o.async=a}()}).call(this,t("oMfpAn"))},{oMfpAn:78}],77:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function r(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,s,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,s=new Array(o-1),c=1;o>c;c++)s[c-1]=arguments[c];n.apply(this,s)}else if(r(n)){for(o=arguments.length,s=new Array(o-1),c=1;o>c;c++)s[c-1]=arguments[c];for(l=n.slice(),o=l.length,c=0;o>c;c++)l[c].apply(this,s)}return!0},n.prototype.addListener=function(e,t){var o;if(!i(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned){var o;o=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,o=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(n)){for(s=a;s-->0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=s;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}],78:[function(e,t){function n(){}var i=t.exports={};i.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var i=n.shift();i()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=n,i.addListener=n,i.once=n,i.off=n,i.removeListener=n,i.removeAllListeners=n,i.emit=n,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")}},{}],79:[function(e,t){!function(){function n(e,t){if(!t||"function"==typeof t)return e;for(var n in t)e[n]=t[n];return e}function i(e,t){for(var n in t)n in e?i(e[n],t[n]):e[n]=t[n];return e}function o(e,t,n){var i,o=0,r=e.length,a=void 0===r||"[object Array]"!==Object.prototype.toString.apply(e)||"function"==typeof e;if(n)if(a){for(i in e)if(t.apply(e[i],n)===!1)break}else for(;r>o&&t.apply(e[o++],n)!==!1;);else if(a){for(i in e)if(t.call(e[i],i,e[i])===!1)break}else for(;r>o&&t.call(e[o],o,e[o++])!==!1;);return e}function r(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,function(e){return z[e]}):e}function a(e){var t=function(e){if(window.XMLHttpRequest)return e(null,new XMLHttpRequest);if(window.ActiveXObject)try{return e(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(t){return e(null,new ActiveXObject("Microsoft.XMLHTTP"))}return e(new Error)},n=function(e){if("string"==typeof e)return e;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},i=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);128>i?t+=String.fromCharCode(i):i>127&&2048>i?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},o=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=i(e);var n,o,r,a,s,c,l,u="",d=0;do n=e.charCodeAt(d++),o=e.charCodeAt(d++),r=e.charCodeAt(d++),a=n>>2,s=(3&n)<<4|o>>4,c=(15&o)<<2|r>>6,l=63&r,isNaN(o)?c=l=64:isNaN(r)&&(l=64),u+=t.charAt(a)+t.charAt(s)+t.charAt(c)+t.charAt(l),n=o=r="",a=s=c=l="";while(d<e.length);return u},r=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e},a=function(e,i,o,s){"function"==typeof o&&(s=o,o={}),o.cache=o.cache||!1,o.data=o.data||{},o.headers=o.headers||{},o.jsonp=o.jsonp||!1,o.async=void 0===o.async?!0:o.async;var c,l=r({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},a.headers,o.headers);if(c="application/json"===l["content-type"]?JSON.stringify(o.data):n(o.data),"GET"===e){var u=[];if(c&&(u.push(c),c=null),o.cache||u.push("_="+(new Date).getTime()),o.jsonp&&(u.push("callback="+o.jsonp),u.push("jsonp="+o.jsonp)),u=u.join("&"),u.length>1&&(i+=i.indexOf("?")>-1?"&"+u:"?"+u),o.jsonp){var d=document.getElementsByTagName("head")[0],p=document.createElement("script");return p.type="text/javascript",p.src=i,void d.appendChild(p)}}t(function(t,n){if(t)return s(t);n.open(e,i,o.async);for(var r in l)l.hasOwnProperty(r)&&n.setRequestHeader(r,l[r]);n.onreadystatechange=function(){if(4===n.readyState){var e=n.responseText||"";if(!s)return;s(n.status,{text:function(){return e},json:function(){try{return JSON.parse(e)}catch(t){return q.error("Can not parse JSON. URL: "+i),{}}}})}},n.send(c)})},s={authBasic:function(e,t){a.headers.Authorization="Basic "+o(e+":"+t)},connect:function(e,t,n){return a("CONNECT",e,t,n)},del:function(e,t,n){return a("DELETE",e,t,n)},get:function(e,t,n){return a("GET",e,t,n)},head:function(e,t,n){return a("HEAD",e,t,n)},headers:function(e){a.headers=e||{}},isAllowed:function(e,t,n){this.options(e,function(e,i){n(-1!==i.text().indexOf(t))})},options:function(e,t,n){return a("OPTIONS",e,t,n)},patch:function(e,t,n){return a("PATCH",e,t,n)},post:function(e,t,n){return a("POST",e,t,n)},put:function(e,t,n){return a("PUT",e,t,n)},trace:function(e,t,n){return a("TRACE",e,t,n)}},c=e.type?e.type.toLowerCase():"get";s[c](e.url,e,function(t,n){200===t||0===t&&n.text()?e.success(n.json(),t,null):e.error(n.text(),t,null)})}function s(e,t){"function"==typeof e&&(t=e,e={}),e=e||{},q.extend(B,e),delete B.fixLng,B.functions&&(delete B.functions,q.extend(q,e.functions)),"string"==typeof B.ns&&(B.ns={namespaces:[B.ns],defaultNs:B.ns}),"string"==typeof B.fallbackNS&&(B.fallbackNS=[B.fallbackNS]),("string"==typeof B.fallbackLng||"boolean"==typeof B.fallbackLng)&&(B.fallbackLng=[B.fallbackLng]),B.interpolationPrefixEscaped=q.regexEscape(B.interpolationPrefix),B.interpolationSuffixEscaped=q.regexEscape(B.interpolationSuffix),B.lng||(B.lng=q.detectLanguage()),V=q.toLanguages(B.lng),M=V[0],q.log("currentLng set to: "+M),B.useCookie&&q.cookie.read(B.cookieName)!==M&&q.cookie.create(B.cookieName,M,B.cookieExpirationTime,B.cookieDomain),B.detectLngFromLocalStorage&&"undefined"!=typeof document&&window.localStorage&&q.localStorage.setItem("i18next_lng",M);var n=C;e.fixLng&&(n=function(e,t){return t=t||{},t.lng=t.lng||n.lng,C(e,t)},n.lng=M),K.setCurrentLng(M),N&&B.setJqueryExt&&S();var i;if(N&&N.Deferred&&(i=N.Deferred()),!B.resStore){var o=q.toLanguages(B.lng);"string"==typeof B.preload&&(B.preload=[B.preload]);for(var r=0,a=B.preload.length;a>r;r++)for(var s=q.toLanguages(B.preload[r]),c=0,l=s.length;l>c;c++)o.indexOf(s[c])<0&&o.push(s[c]);return j.sync.load(o,B,function(e,o){O=o,U=!0,t&&t(n),i&&i.resolve(n)}),i?i.promise():void 0}return O=B.resStore,U=!0,t&&t(n),i&&i.resolve(n),i?i.promise():void 0}function c(e,t){"string"==typeof e&&(e=[e]);for(var n=0,i=e.length;i>n;n++)B.preload.indexOf(e[n])<0&&B.preload.push(e[n]);return s(t)}function l(e,t,n,i){"string"!=typeof t?(n=t,t=B.ns.defaultNs):B.ns.namespaces.indexOf(t)<0&&B.ns.namespaces.push(t),O[e]=O[e]||{},O[e][t]=O[e][t]||{},i?q.deepExtend(O[e][t],n):q.extend(O[e][t],n)}function u(e,t){"string"!=typeof t&&(t=B.ns.defaultNs),O[e]=O[e]||{};var n=O[e][t]||{},i=!1;for(var o in n)n.hasOwnProperty(o)&&(i=!0);return i}function d(e,t){"string"!=typeof t&&(t=B.ns.defaultNs),O[e]=O[e]||{},O[e][t]={}}function p(e,t,n,i){"string"!=typeof t?(resource=t,t=B.ns.defaultNs):B.ns.namespaces.indexOf(t)<0&&B.ns.namespaces.push(t),O[e]=O[e]||{},O[e][t]=O[e][t]||{};for(var o=n.split(B.keyseparator),r=0,a=O[e][t];o[r];)r==o.length-1?a[o[r]]=i:(null==a[o[r]]&&(a[o[r]]={}),a=a[o[r]]),r++}function f(e,t,n){"string"!=typeof t?(resource=t,t=B.ns.defaultNs):B.ns.namespaces.indexOf(t)<0&&B.ns.namespaces.push(t);for(var i in n)"string"==typeof n[i]&&p(e,t,i,n[i])}function h(e){B.ns.defaultNs=e}function m(e,t){g([e],t)}function g(e,t){var n={dynamicLoad:B.dynamicLoad,resGetPath:B.resGetPath,getAsync:B.getAsync,customLoad:B.customLoad,ns:{namespaces:e,defaultNs:""}},i=q.toLanguages(B.lng);"string"==typeof B.preload&&(B.preload=[B.preload]);for(var o=0,r=B.preload.length;r>o;o++)for(var a=q.toLanguages(B.preload[o]),s=0,c=a.length;c>s;s++)i.indexOf(a[s])<0&&i.push(a[s]);for(var l=[],u=0,d=i.length;d>u;u++){var p=!1,f=O[i[u]];if(f)for(var h=0,m=e.length;m>h;h++)f[e[h]]||(p=!0);else p=!0;p&&l.push(i[u])}l.length?j.sync._fetch(l,n,function(n,i){var o=e.length*l.length;q.each(e,function(e,n){B.ns.namespaces.indexOf(n)<0&&B.ns.namespaces.push(n),q.each(l,function(e,r){O[r]=O[r]||{},O[r][n]=i[r][n],o--,0===o&&t&&(B.useLocalStorage&&j.sync._storeLocal(O),t())})})}):t&&t()}function v(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),t.lng=e,s(t,n)}function y(){return M}function b(e){O={},v(M,e)}function S(){function e(e,t,n){if(0!==t.length){var i="text";if(0===t.indexOf("[")){var o=t.split("]");t=o[1],i=o[0].substr(1,o[0].length-1)}t.indexOf(";")===t.length-1&&(t=t.substr(0,t.length-2));var r;if("html"===i)r=B.defaultValueFromContent?N.extend({defaultValue:e.html()},n):n,e.html(N.t(t,r));else if("text"===i)r=B.defaultValueFromContent?N.extend({defaultValue:e.text()},n):n,e.text(N.t(t,r));else if("prepend"===i)r=B.defaultValueFromContent?N.extend({defaultValue:e.html()},n):n,e.prepend(N.t(t,r));else if("append"===i)r=B.defaultValueFromContent?N.extend({defaultValue:e.html()},n):n,e.append(N.t(t,r));else if(0===i.indexOf("data-")){var a=i.substr("data-".length);r=B.defaultValueFromContent?N.extend({defaultValue:e.data(a)},n):n;var s=N.t(t,r);e.data(a,s),e.attr(i,s)}else r=B.defaultValueFromContent?N.extend({defaultValue:e.attr(i)},n):n,e.attr(i,N.t(t,r))}}function t(t,n){var i=t.attr(B.selectorAttr);if(i||"undefined"==typeof i||i===!1||(i=t.text()||t.val()),i){var o=t,r=t.data("i18n-target");if(r&&(o=t.find(r)||t),n||B.useDataAttrOptions!==!0||(n=t.data("i18n-options")),n=n||{},i.indexOf(";")>=0){var a=i.split(";");N.each(a,function(t,i){""!==i&&e(o,i,n)})}else e(o,i,n);B.useDataAttrOptions===!0&&t.data("i18n-options",n)}}N.t=N.t||C,N.fn.i18n=function(e){return this.each(function(){t(N(this),e);var n=N(this).find("["+B.selectorAttr+"]");n.each(function(){t(N(this),e)})})}}function _(e,t,n,i){if(!e)return e;if(i=i||t,e.indexOf(i.interpolationPrefix||B.interpolationPrefix)<0)return e;var o=i.interpolationPrefix?q.regexEscape(i.interpolationPrefix):B.interpolationPrefixEscaped,r=i.interpolationSuffix?q.regexEscape(i.interpolationSuffix):B.interpolationSuffixEscaped,a="HTML"+r,s=t.replace&&"object"==typeof t.replace?t.replace:t;return q.each(s,function(t,s){var c=n?n+B.keyseparator+t:t;"object"==typeof s&&null!==s?e=_(e,s,c,i):i.escapeInterpolation||B.escapeInterpolation?(e=e.replace(new RegExp([o,c,a].join(""),"g"),q.regexReplacementEscape(s)),e=e.replace(new RegExp([o,c,r].join(""),"g"),q.regexReplacementEscape(q.escape(s)))):e=e.replace(new RegExp([o,c,r].join(""),"g"),q.regexReplacementEscape(s))}),e}function w(e,t){var n=",",i="{",o="}",r=q.extend({},t);for(delete r.postProcess;-1!=e.indexOf(B.reusePrefix)&&($++,!($>B.maxRecursion));){var a=e.lastIndexOf(B.reusePrefix),s=e.indexOf(B.reuseSuffix,a)+B.reuseSuffix.length,c=e.substring(a,s),l=c.replace(B.reusePrefix,"").replace(B.reuseSuffix,"");if(a>=s)return q.error("there is an missing closing in following translation value",e),"";if(-1!=l.indexOf(n)){var u=l.indexOf(n);if(-1!=l.indexOf(i,u)&&-1!=l.indexOf(o,u)){var d=l.indexOf(i,u),p=l.indexOf(o,d)+o.length;try{r=q.extend(r,JSON.parse(l.substring(d,p))),l=l.substring(0,u)}catch(f){}}}var h=R(l,r);e=e.replace(c,q.regexReplacementEscape(h))}return e}function A(e){return e.context&&("string"==typeof e.context||"number"==typeof e.context)}function x(e){return void 0!==e.count&&"string"!=typeof e.count}function P(e){return void 0!==e.indefinite_article&&"string"!=typeof e.indefinite_article&&e.indefinite_article}function T(e,t){t=t||{};var n=E(e,t),i=L(e,t);return void 0!==i||i===n}function C(e,t){return t=t||{},U?($=0,R.apply(null,arguments)):(q.log("i18next not finished initialization. you might have called t function before loading resources finished."),t.defaultValue||"")}function E(e,t){return void 0!==t.defaultValue?t.defaultValue:e}function k(){for(var e=[],t=1;t<arguments.length;t++)e.push(arguments[t]);return{postProcess:"sprintf",sprintf:e}}function R(e,t){if(t&&"object"!=typeof t?"sprintf"===B.shortcutFunction?t=k.apply(null,arguments):"defaultValue"===B.shortcutFunction&&(t={defaultValue:t}):t=t||{},"object"==typeof B.defaultVariables&&(t=q.extend({},B.defaultVariables,t)),void 0===e||null===e||""===e)return"";"string"==typeof e&&(e=[e]);var n=e[0];if(e.length>1)for(var i=0;i<e.length&&(n=e[i],!T(n,t));i++);var o,r=E(n,t),a=L(n,t),s=t.lng?q.toLanguages(t.lng,t.fallbackLng):V,c=t.ns||B.ns.defaultNs;n.indexOf(B.nsseparator)>-1&&(o=n.split(B.nsseparator),c=o[0],n=o[1]),void 0===a&&B.sendMissing&&"function"==typeof B.missingKeyHandler&&(t.lng?B.missingKeyHandler(s[0],c,n,r,s):B.missingKeyHandler(B.lng,c,n,r,s));var l=t.postProcess||B.postProcess;void 0!==a&&l&&X[l]&&(a=X[l](a,n,t));var u=r;if(r.indexOf(B.nsseparator)>-1&&(o=r.split(B.nsseparator),u=o[1]),u===n&&B.parseMissingKey&&(r=B.parseMissingKey(r)),void 0===a&&(r=_(r,t),r=w(r,t),l&&X[l])){var d=E(n,t);a=X[l](d,n,t)}return void 0!==a?a:r}function L(e,t){t=t||{};var n,i,o=E(e,t),r=V;if(!O)return o;if("cimode"===r[0].toLowerCase())return o;if(t.lngs&&(r=t.lngs),t.lng&&(r=q.toLanguages(t.lng,t.fallbackLng),!O[r[0]])){var a=B.getAsync;B.getAsync=!1,j.sync.load(r,B,function(e,t){q.extend(O,t),B.getAsync=a})}var s=t.ns||B.ns.defaultNs;if(e.indexOf(B.nsseparator)>-1){var c=e.split(B.nsseparator);s=c[0],e=c[1]}if(A(t)){n=q.extend({},t),delete n.context,n.defaultValue=B.contextNotFound;var l=s+B.nsseparator+e+"_"+t.context;if(i=C(l,n),i!=B.contextNotFound)return _(i,{context:t.context})}if(x(t,r[0])){n=q.extend({lngs:[r[0]]},t),delete n.count,delete n.lng,n.defaultValue=B.pluralNotFound;var u;if(K.needsPlural(r[0],t.count)){u=s+B.nsseparator+e+B.pluralSuffix;var d=K.get(r[0],t.count);d>=0?u=u+"_"+d:1===d&&(u=s+B.nsseparator+e)}else u=s+B.nsseparator+e;if(i=C(u,n),i!=B.pluralNotFound)return _(i,{count:t.count,interpolationPrefix:t.interpolationPrefix,interpolationSuffix:t.interpolationSuffix});if(!(r.length>1))return i;var p=r.slice();if(p.shift(),t=q.extend(t,{lngs:p}),delete t.lng,i=C(s+B.nsseparator+e,t),i!=B.pluralNotFound)return i}if(P(t)){var f=q.extend({},t);delete f.indefinite_article,f.defaultValue=B.indefiniteNotFound;var h=s+B.nsseparator+e+(t.count&&!x(t,r[0])||!t.count?B.indefiniteSuffix:"");if(i=C(h,f),i!=B.indefiniteNotFound)return i}for(var m,g=e.split(B.keyseparator),v=0,y=r.length;y>v&&void 0===m;v++){for(var b=r[v],S=0,T=O[b]&&O[b][s];g[S];)T=T&&T[g[S]],S++;if(void 0!==T){var k=Object.prototype.toString.apply(T);if("string"==typeof T)T=_(T,t),T=w(T,t);else if("[object Array]"!==k||B.returnObjectTrees||t.returnObjectTrees){if(null===T&&B.fallbackOnNull===!0)T=void 0;else if(null!==T)if(B.returnObjectTrees||t.returnObjectTrees){if("[object Number]"!==k&&"[object Function]"!==k&&"[object RegExp]"!==k){var D="[object Array]"===k?[]:{};q.each(T,function(n){D[n]=R(s+B.nsseparator+e+B.keyseparator+n,t)}),T=D}}else B.objectTreeKeyHandler&&"function"==typeof B.objectTreeKeyHandler?T=B.objectTreeKeyHandler(e,T,b,s,t):(T="key '"+s+":"+e+" ("+b+")' returned an object instead of string.",q.log(T))}else T=T.join("\n"),T=_(T,t),T=w(T,t);"string"==typeof T&&""===T.trim()&&B.fallbackOnEmpty===!0&&(T=void 0),m=T}}if(void 0===m&&!t.isFallbackLookup&&(B.fallbackToDefaultNS===!0||B.fallbackNS&&B.fallbackNS.length>0)){if(t.isFallbackLookup=!0,B.fallbackNS.length){for(var M=0,I=B.fallbackNS.length;I>M;M++)if(m=L(B.fallbackNS[M]+B.nsseparator+e,t),m||""===m&&B.fallbackOnEmpty===!1){var N=m.indexOf(B.nsseparator)>-1?m.split(B.nsseparator)[1]:m,$=o.indexOf(B.nsseparator)>-1?o.split(B.nsseparator)[1]:o;if(N!==$)break}}else m=L(e,t);t.isFallbackLookup=!1}return m}function D(){var e,t=B.lngWhitelist||[],n=[];if("undefined"!=typeof window&&!function(){for(var e=window.location.search.substring(1),t=e.split("&"),i=0;i<t.length;i++){var o=t[i].indexOf("=");
if(o>0){var r=t[i].substring(0,o);r==B.detectLngQS&&n.push(t[i].substring(o+1))}}}(),B.useCookie&&"undefined"!=typeof document){var i=q.cookie.read(B.cookieName);i&&n.push(i)}if(B.detectLngFromLocalStorage&&"undefined"!=typeof window&&window.localStorage&&n.push(window.localStorage.getItem("i18next_lng")),"undefined"!=typeof navigator){if(navigator.languages)for(var o=0;o<navigator.languages.length;o++)n.push(navigator.languages[o]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return function(){for(var i=0;i<n.length;i++){var o=n[i];if(o.indexOf("-")>-1){var r=o.split("-");o=B.lowerCaseLng?r[0].toLowerCase()+"-"+r[1].toLowerCase():r[0].toLowerCase()+"-"+r[1].toUpperCase()}if(0===t.length||t.indexOf(o)>-1){e=o;break}}}(),e||(e=B.fallbackLng[0]),e}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var i=0;if(arguments.length>0&&(i=Number(arguments[1]),i!=i?i=0:0!=i&&1/0!=i&&i!=-1/0&&(i=(i>0||-1)*Math.floor(Math.abs(i)))),i>=n)return-1;for(var o=i>=0?i:Math.max(n-Math.abs(i),0);n>o;o++)if(o in t&&t[o]===e)return o;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var i=n;arguments.length>1&&(i=Number(arguments[1]),i!=i?i=0:0!=i&&i!=1/0&&i!=-(1/0)&&(i=(i>0||-1)*Math.floor(Math.abs(i))));for(var o=i>=0?Math.min(i,n-1):n-Math.abs(i);o>=0;o--)if(o in t&&t[o]===e)return o;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var M,I=this,N=I.jQuery||I.Zepto,j={},O={},$=0,V=[],U=!1,F={};if("undefined"!=typeof t&&t.exports){if(!N)try{N=e("jquery")}catch(H){}N&&(N.i18n=N.i18n||j),t.exports=j}else N&&(N.i18n=N.i18n||j),I.i18n=I.i18n||j;F={load:function(e,t,n){t.useLocalStorage?F._loadLocal(e,t,function(i,o){for(var r=[],a=0,s=e.length;s>a;a++)o[e[a]]||r.push(e[a]);r.length>0?F._fetch(r,t,function(e,t){q.extend(o,t),F._storeLocal(t),n(null,o)}):n(null,o)}):F._fetch(e,t,function(e,t){n(null,t)})},_loadLocal:function(e,t,n){var i={},o=(new Date).getTime();if(window.localStorage){var r=e.length;q.each(e,function(e,a){var s=window.localStorage.getItem("res_"+a);s&&(s=JSON.parse(s),s.i18nStamp&&s.i18nStamp+t.localStorageExpirationTime>o&&(i[a]=s)),r--,0===r&&n(null,i)})}},_storeLocal:function(e){if(window.localStorage)for(var t in e)e[t].i18nStamp=(new Date).getTime(),q.localStorage.setItem("res_"+t,JSON.stringify(e[t]))},_fetch:function(e,t,n){var i=t.ns,o={};if(t.dynamicLoad){var r=function(e,t){n(null,t)};if("function"==typeof t.customLoad)t.customLoad(e,i.namespaces,t,r);else{var a=_(t.resGetPath,{lng:e.join("+"),ns:i.namespaces.join("+")});q.ajax({url:a,success:function(e){q.log("loaded: "+a),r(null,e)},error:function(e,t,n){q.log("failed loading: "+a),r("failed loading resource.json error: "+n)},dataType:"json",async:t.getAsync})}}else{var s,c=i.namespaces.length*e.length;q.each(i.namespaces,function(i,r){q.each(e,function(e,i){var a=function(e,t){e&&(s=s||[],s.push(e)),o[i]=o[i]||{},o[i][r]=t,c--,0===c&&n(s,o)};"function"==typeof t.customLoad?t.customLoad(i,r,t,a):F._fetchOne(i,r,t,a)})})}},_fetchOne:function(e,t,n,i){var o=_(n.resGetPath,{lng:e,ns:t});q.ajax({url:o,success:function(e){q.log("loaded: "+o),i(null,e)},error:function(e,t,n){if(t&&200==t||e&&e.status&&200==e.status)q.error("There is a typo in: "+o);else if(t&&404==t||e&&e.status&&404==e.status)q.log("Does not exist: "+o);else{var r=t?t:e&&e.status?e.status:null;q.log(r+" when loading "+o)}i(n,{})},dataType:"json",async:n.getAsync})},postMissing:function(e,t,n,i,o){var r={};r[n]=i;var a=[];if("fallback"===B.sendMissingTo&&B.fallbackLng[0]!==!1)for(var s=0;s<B.fallbackLng.length;s++)a.push({lng:B.fallbackLng[s],url:_(B.resPostPath,{lng:B.fallbackLng[s],ns:t})});else if("current"===B.sendMissingTo||"fallback"===B.sendMissingTo&&B.fallbackLng[0]===!1)a.push({lng:e,url:_(B.resPostPath,{lng:e,ns:t})});else if("all"===B.sendMissingTo)for(var s=0,c=o.length;c>s;s++)a.push({lng:o[s],url:_(B.resPostPath,{lng:o[s],ns:t})});for(var l=0,u=a.length;u>l;l++){var d=a[l];q.ajax({url:d.url,type:B.sendType,data:r,success:function(){q.log("posted missing key '"+n+"' to: "+d.url);for(var e=n.split("."),o=0,r=O[d.lng][t];e[o];)r=r[e[o]]=o===e.length-1?i:r[e[o]]||{},o++},error:function(){q.log("failed posting missing key '"+n+"' to: "+d.url)},dataType:"json",async:B.postAsync})}},reload:b};var B={lng:void 0,load:"all",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",detectLngFromLocalStorage:!1,ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"locales/__lng__/__ns__.json",resPostPath:"locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",defaultVariables:!1,reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,indefiniteSuffix:"_indefinite",indefiniteNotFound:["indefinite_not_found",Math.random()].join(""),setJqueryExt:!0,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,missingKeyHandler:F.postMissing,shortcutFunction:"sprintf"},z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},J={create:function(e,t,n,i){var o;if(n){var r=new Date;r.setTime(r.getTime()+60*n*1e3),o="; expires="+r.toGMTString()}else o="";i=i?"domain="+i+";":"",document.cookie=e+"="+t+o+";"+i+"path=/"},read:function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null},remove:function(e){this.create(e,"",-1)}},G={create:function(){},read:function(){return null},remove:function(){}},q={extend:N?N.extend:n,deepExtend:i,each:N?N.each:o,ajax:N?N.ajax:"undefined"!=typeof document?a:function(){},cookie:"undefined"!=typeof document?J:G,detectLanguage:D,escape:r,log:function(e){B.debug&&"undefined"!=typeof console&&console.log(e)},error:function(e){"undefined"!=typeof console&&console.error(e)},getCountyIndexOfLng:function(e){var t=0;return("nb-NO"===e||"nn-NO"===e||"nb-no"===e||"nn-no"===e)&&(t=1),t},toLanguages:function(e){function t(e){var t=e;if("string"==typeof e&&e.indexOf("-")>-1){var n=e.split("-");t=B.lowerCaseLng?n[0].toLowerCase()+"-"+n[1].toLowerCase():n[0].toLowerCase()+"-"+n[1].toUpperCase()}else t=B.lowerCaseLng?e.toLowerCase():e;return t}var n=this.log,i=[],o=B.lngWhitelist||!1,r=function(e){!o||o.indexOf(e)>-1?i.push(e):n("rejecting non-whitelisted language: "+e)};if("string"==typeof e&&e.indexOf("-")>-1){var a=e.split("-");"unspecific"!==B.load&&r(t(e)),"current"!==B.load&&r(t(a[this.getCountyIndexOfLng(e)]))}else r(t(e));for(var s=0;s<B.fallbackLng.length;s++)-1===i.indexOf(B.fallbackLng[s])&&B.fallbackLng[s]&&i.push(t(B.fallbackLng[s]));return i},regexEscape:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},regexReplacementEscape:function(e){return"string"==typeof e?e.replace(/\$/g,"$$$$"):e},localStorage:{setItem:function(e,t){if(window.localStorage)try{window.localStorage.setItem(e,t)}catch(n){q.log('failed to set value for key "'+e+'" to localStorage.')}}}};q.applyReplacement=_;var W=[["ach","Acholi",[1,2],1],["af","Afrikaans",[1,2],2],["ak","Akan",[1,2],1],["am","Amharic",[1,2],1],["an","Aragonese",[1,2],2],["ar","Arabic",[0,1,2,3,11,100],5],["arn","Mapudungun",[1,2],1],["ast","Asturian",[1,2],2],["ay","Aymará",[1],3],["az","Azerbaijani",[1,2],2],["be","Belarusian",[1,2,5],4],["bg","Bulgarian",[1,2],2],["bn","Bengali",[1,2],2],["bo","Tibetan",[1],3],["br","Breton",[1,2],1],["bs","Bosnian",[1,2,5],4],["ca","Catalan",[1,2],2],["cgg","Chiga",[1],3],["cs","Czech",[1,2,5],6],["csb","Kashubian",[1,2,5],7],["cy","Welsh",[1,2,3,8],8],["da","Danish",[1,2],2],["de","German",[1,2],2],["dev","Development Fallback",[1,2],2],["dz","Dzongkha",[1],3],["el","Greek",[1,2],2],["en","English",[1,2],2],["eo","Esperanto",[1,2],2],["es","Spanish",[1,2],2],["es_ar","Argentinean Spanish",[1,2],2],["et","Estonian",[1,2],2],["eu","Basque",[1,2],2],["fa","Persian",[1],3],["fi","Finnish",[1,2],2],["fil","Filipino",[1,2],1],["fo","Faroese",[1,2],2],["fr","French",[1,2],9],["fur","Friulian",[1,2],2],["fy","Frisian",[1,2],2],["ga","Irish",[1,2,3,7,11],10],["gd","Scottish Gaelic",[1,2,3,20],11],["gl","Galician",[1,2],2],["gu","Gujarati",[1,2],2],["gun","Gun",[1,2],1],["ha","Hausa",[1,2],2],["he","Hebrew",[1,2],2],["hi","Hindi",[1,2],2],["hr","Croatian",[1,2,5],4],["hu","Hungarian",[1,2],2],["hy","Armenian",[1,2],2],["ia","Interlingua",[1,2],2],["id","Indonesian",[1],3],["is","Icelandic",[1,2],12],["it","Italian",[1,2],2],["ja","Japanese",[1],3],["jbo","Lojban",[1],3],["jv","Javanese",[0,1],13],["ka","Georgian",[1],3],["kk","Kazakh",[1],3],["km","Khmer",[1],3],["kn","Kannada",[1,2],2],["ko","Korean",[1],3],["ku","Kurdish",[1,2],2],["kw","Cornish",[1,2,3,4],14],["ky","Kyrgyz",[1],3],["lb","Letzeburgesch",[1,2],2],["ln","Lingala",[1,2],1],["lo","Lao",[1],3],["lt","Lithuanian",[1,2,10],15],["lv","Latvian",[1,2,0],16],["mai","Maithili",[1,2],2],["mfe","Mauritian Creole",[1,2],1],["mg","Malagasy",[1,2],1],["mi","Maori",[1,2],1],["mk","Macedonian",[1,2],17],["ml","Malayalam",[1,2],2],["mn","Mongolian",[1,2],2],["mnk","Mandinka",[0,1,2],18],["mr","Marathi",[1,2],2],["ms","Malay",[1],3],["mt","Maltese",[1,2,11,20],19],["nah","Nahuatl",[1,2],2],["nap","Neapolitan",[1,2],2],["nb","Norwegian Bokmal",[1,2],2],["ne","Nepali",[1,2],2],["nl","Dutch",[1,2],2],["nn","Norwegian Nynorsk",[1,2],2],["no","Norwegian",[1,2],2],["nso","Northern Sotho",[1,2],2],["oc","Occitan",[1,2],1],["or","Oriya",[2,1],2],["pa","Punjabi",[1,2],2],["pap","Papiamento",[1,2],2],["pl","Polish",[1,2,5],7],["pms","Piemontese",[1,2],2],["ps","Pashto",[1,2],2],["pt","Portuguese",[1,2],2],["pt_br","Brazilian Portuguese",[1,2],2],["rm","Romansh",[1,2],2],["ro","Romanian",[1,2,20],20],["ru","Russian",[1,2,5],4],["sah","Yakut",[1],3],["sco","Scots",[1,2],2],["se","Northern Sami",[1,2],2],["si","Sinhala",[1,2],2],["sk","Slovak",[1,2,5],6],["sl","Slovenian",[5,1,2,3],21],["so","Somali",[1,2],2],["son","Songhay",[1,2],2],["sq","Albanian",[1,2],2],["sr","Serbian",[1,2,5],4],["su","Sundanese",[1],3],["sv","Swedish",[1,2],2],["sw","Swahili",[1,2],2],["ta","Tamil",[1,2],2],["te","Telugu",[1,2],2],["tg","Tajik",[1,2],1],["th","Thai",[1],3],["ti","Tigrinya",[1,2],1],["tk","Turkmen",[1,2],2],["tr","Turkish",[1,2],1],["tt","Tatar",[1],3],["ug","Uyghur",[1],3],["uk","Ukrainian",[1,2,5],4],["ur","Urdu",[1,2],2],["uz","Uzbek",[1,2],1],["vi","Vietnamese",[1],3],["wa","Walloon",[1,2],1],["wo","Wolof",[1],3],["yo","Yoruba",[1,2],2],["zh","Chinese",[1],3]],Y={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)},5:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&10>=e%100?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:7>e?2:11>e?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&20>e?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(10>e%100||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1?0:1)},18:function(e){return Number(1==e?1:2)},19:function(e){return Number(1==e?0:0===e||e%100>1&&11>e%100?1:e%100>10&&20>e%100?2:3)},20:function(e){return Number(1==e?0:0===e||e%100>0&&20>e%100?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)}},K={rules:function(){var e,t={};for(e=W.length;e--;)t[W[e][0]]={name:W[e][1],numbers:W[e][2],plurals:Y[W[e][3]]};return t}(),addRule:function(e,t){K.rules[e]=t},setCurrentLng:function(e){if(!K.currentRule||K.currentRule.lng!==e){var t=e.split("-");K.currentRule={lng:e,rule:K.rules[t[0]]}}},needsPlural:function(e,t){var n,i=e.split("-");return n=K.currentRule&&K.currentRule.lng===e?K.currentRule.rule:K.rules[i[q.getCountyIndexOfLng(e)]],n&&n.numbers.length<=1?!1:1!==this.get(e,t)},get:function(e,t){function n(t,n){var i;if(i=K.currentRule&&K.currentRule.lng===e?K.currentRule.rule:K.rules[t]){var o;o=i.plurals(i.noAbs?n:Math.abs(n));var r=i.numbers[o];return 2===i.numbers.length&&1===i.numbers[0]&&(2===r?r=-1:1===r&&(r=1)),r}return 1===n?"1":"-1"}var i=e.split("-");return n(i[q.getCountyIndexOfLng(e)],t)}},X={},Q=function(e,t){X[e]=t},Z=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,i){var o,r,a,s,c,l,u,d=1,p=n.length,f="",h=[];for(r=0;p>r;r++)if(f=e(n[r]),"string"===f)h.push(n[r]);else if("array"===f){if(s=n[r],s[2])for(o=i[d],a=0;a<s[2].length;a++){if(!o.hasOwnProperty(s[2][a]))throw Z('[sprintf] property "%s" does not exist',s[2][a]);o=o[s[2][a]]}else o=s[1]?i[s[1]]:i[d++];if(/[^s]/.test(s[8])&&"number"!=e(o))throw Z("[sprintf] expecting number but found %s",e(o));switch(s[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":o=parseInt(o,10);break;case"e":o=s[7]?o.toExponential(s[7]):o.toExponential();break;case"f":o=s[7]?parseFloat(o).toFixed(s[7]):parseFloat(o);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&s[7]?o.substring(0,s[7]):o;break;case"u":o=Math.abs(o);break;case"x":o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase()}o=/[def]/.test(s[8])&&s[3]&&o>=0?"+"+o:o,l=s[4]?"0"==s[4]?"0":s[4].charAt(1):" ",u=s[6]-String(o).length,c=s[6]?t(l,u):"",h.push(s[5]?o+c:c+o)}return h.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],i=[],o=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))i.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))i.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(n[2]){o|=1;var r=[],a=n[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(a)))throw"[sprintf] huh?";for(r.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(a)))r.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(a)))throw"[sprintf] huh?";r.push(s[1])}n[2]=r}else o|=2;if(3===o)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";i.push(n)}t=t.substring(n[0].length)}return i},n}(),et=function(e,t){return t.unshift(e),Z.apply(null,t)};Q("sprintf",function(e,t,n){return n.sprintf?"[object Array]"===Object.prototype.toString.apply(n.sprintf)?et(e,n.sprintf):"object"==typeof n.sprintf?Z(e,n.sprintf):e:e}),j.init=s,j.setLng=v,j.preload=c,j.addResourceBundle=l,j.hasResourceBundle=u,j.addResource=p,j.addResources=f,j.removeResourceBundle=d,j.loadNamespace=m,j.loadNamespaces=g,j.setDefaultNamespace=h,j.t=C,j.translate=C,j.exists=T,j.detectLanguage=q.detectLanguage,j.pluralExtensions=K,j.sync=F,j.functions=q,j.lng=y,j.addPostProcessor=Q,j.options=B}()},{jquery:80}],80:[function(t,n){!function(e,t){"object"==typeof n&&"object"==typeof n.exports?n.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(t,n){function i(e){var t="length"in e&&e.length,n=et.type(e);return"function"===n||et.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function o(e,t,n){if(et.isFunction(t))return et.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return et.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ct.test(t))return et.filter(t,e,n);t=et.filter(t,e)}return et.grep(e,function(e){return q.call(t,e)>=0!==n})}function r(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function a(e){var t=mt[e]={};return et.each(e.match(ht)||[],function(e,n){t[n]=!0}),t}function s(){Q.removeEventListener("DOMContentLoaded",s,!1),t.removeEventListener("load",s,!1),et.ready()}function c(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=et.expando+c.uid++}function l(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(_t,"-$1").toLowerCase(),n=e.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:St.test(n)?et.parseJSON(n):n}catch(o){}bt.set(e,t,n)}else n=void 0;return n}function u(){return!0}function d(){return!1}function p(){try{return Q.activeElement}catch(e){}}function f(e,t){return et.nodeName(e,"table")&&et.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function h(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function m(e){var t=Ot.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var n=0,i=e.length;i>n;n++)yt.set(e[n],"globalEval",!t||yt.get(t[n],"globalEval"))}function v(e,t){var n,i,o,r,a,s,c,l;if(1===t.nodeType){if(yt.hasData(e)&&(r=yt.access(e),a=yt.set(t,r),l=r.events)){delete a.handle,a.events={};for(o in l)for(n=0,i=l[o].length;i>n;n++)et.event.add(t,o,l[o][n])}bt.hasData(e)&&(s=bt.access(e),c=et.extend({},s),bt.set(t,c))}}function y(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&et.nodeName(e,t)?et.merge([e],n):n}function b(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Pt.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function S(e,n){var i,o=et(n.createElement(e)).appendTo(n.body),r=t.getDefaultComputedStyle&&(i=t.getDefaultComputedStyle(o[0]))?i.display:et.css(o[0],"display");return o.detach(),r}function _(e){var t=Q,n=Ft[e];return n||(n=S(e,t),"none"!==n&&n||(Ut=(Ut||et("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Ut[0].contentDocument,t.write(),t.close(),n=S(e,t),Ut.detach()),Ft[e]=n),n}function w(e,t,n){var i,o,r,a,s=e.style;return n=n||zt(e),n&&(a=n.getPropertyValue(t)||n[t]),n&&(""!==a||et.contains(e.ownerDocument,e)||(a=et.style(e,t)),Bt.test(a)&&Ht.test(t)&&(i=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=o,s.maxWidth=r)),void 0!==a?a+"":a}function A(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function x(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),i=t,o=Kt.length;o--;)if(t=Kt[o]+n,t in e)return t;return i}function P(e,t,n){var i=Gt.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function T(e,t,n,i,o){for(var r=n===(i?"border":"content")?4:"width"===t?1:0,a=0;4>r;r+=2)"margin"===n&&(a+=et.css(e,n+At[r],!0,o)),i?("content"===n&&(a-=et.css(e,"padding"+At[r],!0,o)),"margin"!==n&&(a-=et.css(e,"border"+At[r]+"Width",!0,o))):(a+=et.css(e,"padding"+At[r],!0,o),"padding"!==n&&(a+=et.css(e,"border"+At[r]+"Width",!0,o)));return a}function C(e,t,n){var i=!0,o="width"===t?e.offsetWidth:e.offsetHeight,r=zt(e),a="border-box"===et.css(e,"boxSizing",!1,r);if(0>=o||null==o){if(o=w(e,t,r),(0>o||null==o)&&(o=e.style[t]),Bt.test(o))return o;i=a&&(X.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+T(e,t,n||(a?"border":"content"),i,r)+"px"}function E(e,t){for(var n,i,o,r=[],a=0,s=e.length;s>a;a++)i=e[a],i.style&&(r[a]=yt.get(i,"olddisplay"),n=i.style.display,t?(r[a]||"none"!==n||(i.style.display=""),""===i.style.display&&xt(i)&&(r[a]=yt.access(i,"olddisplay",_(i.nodeName)))):(o=xt(i),"none"===n&&o||yt.set(i,"olddisplay",o?n:et.css(i,"display"))));for(a=0;s>a;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?r[a]||"":"none"));return e}function k(e,t,n,i,o){return new k.prototype.init(e,t,n,i,o)}function R(){return setTimeout(function(){Xt=void 0}),Xt=et.now()}function L(e,t){var n,i=0,o={height:e};for(t=t?1:0;4>i;i+=2-t)n=At[i],o["margin"+n]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function D(e,t,n){for(var i,o=(on[t]||[]).concat(on["*"]),r=0,a=o.length;a>r;r++)if(i=o[r].call(n,t,e))return i}function M(e,t,n){var i,o,r,a,s,c,l,u,d=this,p={},f=e.style,h=e.nodeType&&xt(e),m=yt.get(e,"fxshow");n.queue||(s=et._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,c=s.empty.fire,s.empty.fire=function(){s.unqueued||c()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,et.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],l=et.css(e,"display"),u="none"===l?yt.get(e,"olddisplay")||_(e.nodeName):l,"inline"===u&&"none"===et.css(e,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",d.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(i in t)if(o=t[i],Zt.exec(o)){if(delete t[i],r=r||"toggle"===o,o===(h?"hide":"show")){if("show"!==o||!m||void 0===m[i])continue;h=!0}p[i]=m&&m[i]||et.style(e,i)}else l=void 0;if(et.isEmptyObject(p))"inline"===("none"===l?_(e.nodeName):l)&&(f.display=l);else{m?"hidden"in m&&(h=m.hidden):m=yt.access(e,"fxshow",{}),r&&(m.hidden=!h),h?et(e).show():d.done(function(){et(e).hide()}),d.done(function(){var t;yt.remove(e,"fxshow");for(t in p)et.style(e,t,p[t])});for(i in p)a=D(h?m[i]:0,i,d),i in m||(m[i]=a.start,h&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function I(e,t){var n,i,o,r,a;for(n in e)if(i=et.camelCase(n),o=t[i],r=e[n],et.isArray(r)&&(o=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),a=et.cssHooks[i],a&&"expand"in a){r=a.expand(r),delete e[i];for(n in r)n in e||(e[n]=r[n],t[n]=o)}else t[i]=o}function N(e,t,n){var i,o,r=0,a=nn.length,s=et.Deferred().always(function(){delete c.elem}),c=function(){if(o)return!1;for(var t=Xt||R(),n=Math.max(0,l.startTime+l.duration-t),i=n/l.duration||0,r=1-i,a=0,c=l.tweens.length;c>a;a++)l.tweens[a].run(r);return s.notifyWith(e,[l,r,n]),1>r&&c?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:et.extend({},t),opts:et.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xt||R(),duration:n.duration,tweens:[],createTween:function(t,n){var i=et.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){var n=0,i=t?l.tweens.length:0;if(o)return this;for(o=!0;i>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),u=l.props;for(I(u,l.opts.specialEasing);a>r;r++)if(i=nn[r].call(l,e,u,l.opts))return i;return et.map(u,D,l),et.isFunction(l.opts.start)&&l.opts.start.call(e,l),et.fx.timer(et.extend(c,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function j(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,o=0,r=t.toLowerCase().match(ht)||[];if(et.isFunction(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function O(e,t,n,i){function o(s){var c;return r[s]=!0,et.each(e[s]||[],function(e,s){var l=s(t,n,i);return"string"!=typeof l||a||r[l]?a?!(c=l):void 0:(t.dataTypes.unshift(l),o(l),!1)}),c}var r={},a=e===_n;return o(t.dataTypes[0])||!r["*"]&&o("*")}function $(e,t){var n,i,o=et.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:i||(i={}))[n]=t[n]);return i&&et.extend(!0,e,i),e}function V(e,t,n){for(var i,o,r,a,s=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in s)if(s[o]&&s[o].test(i)){c.unshift(o);break}if(c[0]in n)r=c[0];else{for(o in n){if(!c[0]||e.converters[o+" "+c[0]]){r=o;break}a||(a=o)}r=r||a}return r?(r!==c[0]&&c.unshift(r),n[r]):void 0}function U(e,t,n,i){var o,r,a,s,c,l={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(r=u.shift();r;)if(e.responseFields[r]&&(n[e.responseFields[r]]=t),!c&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=r,r=u.shift())if("*"===r)r=c;else if("*"!==c&&c!==r){if(a=l[c+" "+r]||l["* "+r],!a)for(o in l)if(s=o.split(" "),s[1]===r&&(a=l[c+" "+s[0]]||l["* "+s[0]])){a===!0?a=l[o]:l[o]!==!0&&(r=s[0],u.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+c+" to "+r}}}return{state:"success",data:t}}function F(e,t,n,i){var o;if(et.isArray(t))et.each(t,function(t,o){n||Tn.test(e)?i(e,o):F(e+"["+("object"==typeof o?t:"")+"]",o,n,i)});else if(n||"object"!==et.type(t))i(e,t);else for(o in t)F(e+"["+o+"]",t[o],n,i)}function H(e){return et.isWindow(e)?e:9===e.nodeType&&e.defaultView}var B=[],z=B.slice,J=B.concat,G=B.push,q=B.indexOf,W={},Y=W.toString,K=W.hasOwnProperty,X={},Q=t.document,Z="2.1.4",et=function(e,t){return new et.fn.init(e,t)},tt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,nt=/^-ms-/,it=/-([\da-z])/gi,ot=function(e,t){return t.toUpperCase()};et.fn=et.prototype={jquery:Z,constructor:et,selector:"",length:0,toArray:function(){return z.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:z.call(this)},pushStack:function(e){var t=et.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return et.each(this,e,t)},map:function(e){return this.pushStack(et.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(z.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:G,sort:B.sort,splice:B.splice},et.extend=et.fn.extend=function(){var e,t,n,i,o,r,a=arguments[0]||{},s=1,c=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||et.isFunction(a)||(a={}),s===c&&(a=this,s--);c>s;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],i=e[t],a!==i&&(l&&i&&(et.isPlainObject(i)||(o=et.isArray(i)))?(o?(o=!1,r=n&&et.isArray(n)?n:[]):r=n&&et.isPlainObject(n)?n:{},a[t]=et.extend(l,r,i)):void 0!==i&&(a[t]=i));return a},et.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===et.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!et.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==et.type(e)||e.nodeType||et.isWindow(e)?!1:e.constructor&&!K.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?W[Y.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;e=et.trim(e),e&&(1===e.indexOf("use strict")?(t=Q.createElement("script"),t.text=e,Q.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(nt,"ms-").replace(it,ot)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var o,r=0,a=e.length,s=i(e);if(n){if(s)for(;a>r&&(o=t.apply(e[r],n),o!==!1);r++);else for(r in e)if(o=t.apply(e[r],n),o===!1)break}else if(s)for(;a>r&&(o=t.call(e[r],r,e[r]),o!==!1);r++);else for(r in e)if(o=t.call(e[r],r,e[r]),o===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(tt,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?et.merge(n,"string"==typeof e?[e]:e):G.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:q.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,o=e.length;n>i;i++)e[o++]=t[i];return e.length=o,e},grep:function(e,t,n){for(var i,o=[],r=0,a=e.length,s=!n;a>r;r++)i=!t(e[r],r),i!==s&&o.push(e[r]);return o},map:function(e,t,n){var o,r=0,a=e.length,s=i(e),c=[];if(s)for(;a>r;r++)o=t(e[r],r,n),null!=o&&c.push(o);else for(r in e)o=t(e[r],r,n),null!=o&&c.push(o);return J.apply([],c)},guid:1,proxy:function(e,t){var n,i,o;return"string"==typeof t&&(n=e[t],t=e,e=n),et.isFunction(e)?(i=z.call(arguments,2),o=function(){return e.apply(t||this,i.concat(z.call(arguments)))},o.guid=e.guid=e.guid||et.guid++,o):void 0},now:Date.now,support:X}),et.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){W["[object "+t+"]"]=t.toLowerCase()});var rt=function(e){function t(e,t,n,i){var o,r,a,s,c,l,d,f,h,m;if((t?t.ownerDocument||t:U)!==D&&L(t),t=t||D,n=n||[],s=t.nodeType,"string"!=typeof e||!e||1!==s&&9!==s&&11!==s)return n;if(!i&&I){if(11!==s&&(o=yt.exec(e)))if(a=o[1]){if(9===s){if(r=t.getElementById(a),!r||!r.parentNode)return n;if(r.id===a)return n.push(r),n}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&$(t,r)&&r.id===a)return n.push(r),n}else{if(o[2])return Q.apply(n,t.getElementsByTagName(e)),n;if((a=o[3])&&_.getElementsByClassName)return Q.apply(n,t.getElementsByClassName(a)),n}if(_.qsa&&(!N||!N.test(e))){if(f=d=V,h=t,m=1!==s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(l=P(e),(d=t.getAttribute("id"))?f=d.replace(St,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",c=l.length;c--;)l[c]=f+p(l[c]);h=bt.test(e)&&u(t.parentNode)||t,m=l.join(",")}if(m)try{return Q.apply(n,h.querySelectorAll(m)),n}catch(g){}finally{d||t.removeAttribute("id")}}}return C(e.replace(ct,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>w.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[V]=!0,e}function o(e){var t=D.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t){for(var n=e.split("|"),i=e.length;i--;)w.attrHandle[n[i]]=t}function a(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||q)-(~e.sourceIndex||q);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function c(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e){return i(function(t){return t=+t,i(function(n,i){for(var o,r=e([],n.length,t),a=r.length;a--;)n[o=r[a]]&&(n[o]=!(i[o]=n[o]))})})}function u(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function d(){}function p(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function f(e,t,n){var i=t.dir,o=n&&"parentNode"===i,r=H++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var s,c,l=[F,r];if(a){for(;t=t[i];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||o){if(c=t[V]||(t[V]={}),(s=c[i])&&s[0]===F&&s[1]===r)return l[2]=s[2];if(c[i]=l,l[2]=e(t,n,a))return!0}}}function h(e){return e.length>1?function(t,n,i){for(var o=e.length;o--;)if(!e[o](t,n,i))return!1;return!0}:e[0]}function m(e,n,i){for(var o=0,r=n.length;r>o;o++)t(e,n[o],i);return i}function g(e,t,n,i,o){for(var r,a=[],s=0,c=e.length,l=null!=t;c>s;s++)(r=e[s])&&(!n||n(r,i,o))&&(a.push(r),l&&t.push(s));return a
}function v(e,t,n,o,r,a){return o&&!o[V]&&(o=v(o)),r&&!r[V]&&(r=v(r,a)),i(function(i,a,s,c){var l,u,d,p=[],f=[],h=a.length,v=i||m(t||"*",s.nodeType?[s]:s,[]),y=!e||!i&&t?v:g(v,p,e,s,c),b=n?r||(i?e:h||o)?[]:a:y;if(n&&n(y,b,s,c),o)for(l=g(b,f),o(l,[],s,c),u=l.length;u--;)(d=l[u])&&(b[f[u]]=!(y[f[u]]=d));if(i){if(r||e){if(r){for(l=[],u=b.length;u--;)(d=b[u])&&l.push(y[u]=d);r(null,b=[],l,c)}for(u=b.length;u--;)(d=b[u])&&(l=r?et(i,d):p[u])>-1&&(i[l]=!(a[l]=d))}}else b=g(b===a?b.splice(h,b.length):b),r?r(null,a,b,c):Q.apply(a,b)})}function y(e){for(var t,n,i,o=e.length,r=w.relative[e[0].type],a=r||w.relative[" "],s=r?1:0,c=f(function(e){return e===t},a,!0),l=f(function(e){return et(t,e)>-1},a,!0),u=[function(e,n,i){var o=!r&&(i||n!==E)||((t=n).nodeType?c(e,n,i):l(e,n,i));return t=null,o}];o>s;s++)if(n=w.relative[e[s].type])u=[f(h(u),n)];else{if(n=w.filter[e[s].type].apply(null,e[s].matches),n[V]){for(i=++s;o>i&&!w.relative[e[i].type];i++);return v(s>1&&h(u),s>1&&p(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ct,"$1"),n,i>s&&y(e.slice(s,i)),o>i&&y(e=e.slice(i)),o>i&&p(e))}u.push(n)}return h(u)}function b(e,n){var o=n.length>0,r=e.length>0,a=function(i,a,s,c,l){var u,d,p,f=0,h="0",m=i&&[],v=[],y=E,b=i||r&&w.find.TAG("*",l),S=F+=null==y?1:Math.random()||.1,_=b.length;for(l&&(E=a!==D&&a);h!==_&&null!=(u=b[h]);h++){if(r&&u){for(d=0;p=e[d++];)if(p(u,a,s)){c.push(u);break}l&&(F=S)}o&&((u=!p&&u)&&f--,i&&m.push(u))}if(f+=h,o&&h!==f){for(d=0;p=n[d++];)p(m,v,a,s);if(i){if(f>0)for(;h--;)m[h]||v[h]||(v[h]=K.call(c));v=g(v)}Q.apply(c,v),l&&!i&&v.length>0&&f+n.length>1&&t.uniqueSort(c)}return l&&(F=S,E=y),m};return o?i(a):a}var S,_,w,A,x,P,T,C,E,k,R,L,D,M,I,N,j,O,$,V="sizzle"+1*new Date,U=e.document,F=0,H=0,B=n(),z=n(),J=n(),G=function(e,t){return e===t&&(R=!0),0},q=1<<31,W={}.hasOwnProperty,Y=[],K=Y.pop,X=Y.push,Q=Y.push,Z=Y.slice,et=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=it.replace("w","w#"),rt="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ot+"))|)"+nt+"*\\]",at=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",st=new RegExp(nt+"+","g"),ct=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),lt=new RegExp("^"+nt+"*,"+nt+"*"),ut=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),dt=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),pt=new RegExp(at),ft=new RegExp("^"+ot+"$"),ht={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it.replace("w","w*")+")"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+tt+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bt=/[+~]/,St=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),wt=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},At=function(){L()};try{Q.apply(Y=Z.call(U.childNodes),U.childNodes),Y[U.childNodes.length].nodeType}catch(xt){Q={apply:Y.length?function(e,t){X.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}_=t.support={},x=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},L=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:U;return i!==D&&9===i.nodeType&&i.documentElement?(D=i,M=i.documentElement,n=i.defaultView,n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",At,!1):n.attachEvent&&n.attachEvent("onunload",At)),I=!x(i),_.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=o(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=vt.test(i.getElementsByClassName),_.getById=o(function(e){return M.appendChild(e).id=V,!i.getElementsByName||!i.getElementsByName(V).length}),_.getById?(w.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&I){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},w.filter.ID=function(e){var t=e.replace(_t,wt);return function(e){return e.getAttribute("id")===t}}):(delete w.find.ID,w.filter.ID=function(e){var t=e.replace(_t,wt);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),w.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},w.find.CLASS=_.getElementsByClassName&&function(e,t){return I?t.getElementsByClassName(e):void 0},j=[],N=[],(_.qsa=vt.test(i.querySelectorAll))&&(o(function(e){M.appendChild(e).innerHTML="<a id='"+V+"'></a><select id='"+V+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+nt+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+nt+"*(?:value|"+tt+")"),e.querySelectorAll("[id~="+V+"-]").length||N.push("~="),e.querySelectorAll(":checked").length||N.push(":checked"),e.querySelectorAll("a#"+V+"+*").length||N.push(".#.+[+~]")}),o(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+nt+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")})),(_.matchesSelector=vt.test(O=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&o(function(e){_.disconnectedMatch=O.call(e,"div"),O.call(e,"[s!='']:x"),j.push("!=",at)}),N=N.length&&new RegExp(N.join("|")),j=j.length&&new RegExp(j.join("|")),t=vt.test(M.compareDocumentPosition),$=t||vt.test(M.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},G=t?function(e,t){if(e===t)return R=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!_.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===U&&$(U,e)?-1:t===i||t.ownerDocument===U&&$(U,t)?1:k?et(k,e)-et(k,t):0:4&n?-1:1)}:function(e,t){if(e===t)return R=!0,0;var n,o=0,r=e.parentNode,s=t.parentNode,c=[e],l=[t];if(!r||!s)return e===i?-1:t===i?1:r?-1:s?1:k?et(k,e)-et(k,t):0;if(r===s)return a(e,t);for(n=e;n=n.parentNode;)c.unshift(n);for(n=t;n=n.parentNode;)l.unshift(n);for(;c[o]===l[o];)o++;return o?a(c[o],l[o]):c[o]===U?-1:l[o]===U?1:0},i):D},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==D&&L(e),n=n.replace(dt,"='$1']"),!(!_.matchesSelector||!I||j&&j.test(n)||N&&N.test(n)))try{var i=O.call(e,n);if(i||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(o){}return t(n,D,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==D&&L(e),$(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==D&&L(e);var n=w.attrHandle[t.toLowerCase()],i=n&&W.call(w.attrHandle,t.toLowerCase())?n(e,t,!I):void 0;return void 0!==i?i:_.attributes||!I?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,o=0;if(R=!_.detectDuplicates,k=!_.sortStable&&e.slice(0),e.sort(G),R){for(;t=e[o++];)t===e[o]&&(i=n.push(o));for(;i--;)e.splice(n[i],1)}return k=null,e},A=t.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=A(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=A(t);return n},w=t.selectors={cacheLength:50,createPseudo:i,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_t,wt),e[3]=(e[3]||e[4]||e[5]||"").replace(_t,wt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return ht.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&pt.test(n)&&(t=P(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_t,wt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=B[e+" "];return t||(t=new RegExp("(^|"+nt+")"+e+"("+nt+"|$)"))&&B(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(o){var r=t.attr(o,e);return null==r?"!="===n:n?(r+="","="===n?r===i:"!="===n?r!==i:"^="===n?i&&0===r.indexOf(i):"*="===n?i&&r.indexOf(i)>-1:"$="===n?i&&r.slice(-i.length)===i:"~="===n?(" "+r.replace(st," ")+" ").indexOf(i)>-1:"|="===n?r===i||r.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,o){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===o?function(e){return!!e.parentNode}:function(t,n,c){var l,u,d,p,f,h,m=r!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!c&&!s;if(g){if(r){for(;m;){for(d=t;d=d[m];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;h=m="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?g.firstChild:g.lastChild],a&&y){for(u=g[V]||(g[V]={}),l=u[e]||[],f=l[0]===F&&l[1],p=l[0]===F&&l[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(p=f=0)||h.pop();)if(1===d.nodeType&&++p&&d===t){u[e]=[F,f,p];break}}else if(y&&(l=(t[V]||(t[V]={}))[e])&&l[0]===F)p=l[1];else for(;(d=++f&&d&&d[m]||(p=f=0)||h.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++p||(y&&((d[V]||(d[V]={}))[e]=[F,p]),d!==t)););return p-=o,p===i||p%i===0&&p/i>=0}}},PSEUDO:function(e,n){var o,r=w.pseudos[e]||w.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return r[V]?r(n):r.length>1?(o=[e,e,"",n],w.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,o=r(e,n),a=o.length;a--;)i=et(e,o[a]),e[i]=!(t[i]=o[a])}):function(e){return r(e,0,o)}):r}},pseudos:{not:i(function(e){var t=[],n=[],o=T(e.replace(ct,"$1"));return o[V]?i(function(e,t,n,i){for(var r,a=o(e,null,i,[]),s=e.length;s--;)(r=a[s])&&(e[s]=!(t[s]=r))}):function(e,i,r){return t[0]=e,o(t,null,r,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(_t,wt),function(t){return(t.textContent||t.innerText||A(t)).indexOf(e)>-1}}),lang:i(function(e){return ft.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_t,wt).toLowerCase(),function(t){var n;do if(n=I?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===M},focus:function(e){return e===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return gt.test(e.nodeName)},input:function(e){return mt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[0>n?n+t:n]}),even:l(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:l(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},w.pseudos.nth=w.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[S]=s(S);for(S in{submit:!0,reset:!0})w.pseudos[S]=c(S);return d.prototype=w.filters=w.pseudos,w.setFilters=new d,P=t.tokenize=function(e,n){var i,o,r,a,s,c,l,u=z[e+" "];if(u)return n?0:u.slice(0);for(s=e,c=[],l=w.preFilter;s;){(!i||(o=lt.exec(s)))&&(o&&(s=s.slice(o[0].length)||s),c.push(r=[])),i=!1,(o=ut.exec(s))&&(i=o.shift(),r.push({value:i,type:o[0].replace(ct," ")}),s=s.slice(i.length));for(a in w.filter)!(o=ht[a].exec(s))||l[a]&&!(o=l[a](o))||(i=o.shift(),r.push({value:i,type:a,matches:o}),s=s.slice(i.length));if(!i)break}return n?s.length:s?t.error(e):z(e,c).slice(0)},T=t.compile=function(e,t){var n,i=[],o=[],r=J[e+" "];if(!r){for(t||(t=P(e)),n=t.length;n--;)r=y(t[n]),r[V]?i.push(r):o.push(r);r=J(e,b(o,i)),r.selector=e}return r},C=t.select=function(e,t,n,i){var o,r,a,s,c,l="function"==typeof e&&e,d=!i&&P(e=l.selector||e);if(n=n||[],1===d.length){if(r=d[0]=d[0].slice(0),r.length>2&&"ID"===(a=r[0]).type&&_.getById&&9===t.nodeType&&I&&w.relative[r[1].type]){if(t=(w.find.ID(a.matches[0].replace(_t,wt),t)||[])[0],!t)return n;l&&(t=t.parentNode),e=e.slice(r.shift().value.length)}for(o=ht.needsContext.test(e)?0:r.length;o--&&(a=r[o],!w.relative[s=a.type]);)if((c=w.find[s])&&(i=c(a.matches[0].replace(_t,wt),bt.test(r[0].type)&&u(t.parentNode)||t))){if(r.splice(o,1),e=i.length&&p(r),!e)return Q.apply(n,i),n;break}}return(l||T(e,d))(i,t,!I,n,bt.test(e)&&u(t.parentNode)||t),n},_.sortStable=V.split("").sort(G).join("")===V,_.detectDuplicates=!!R,L(),_.sortDetached=o(function(e){return 1&e.compareDocumentPosition(D.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||r("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||r("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||r(tt,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(t);et.find=rt,et.expr=rt.selectors,et.expr[":"]=et.expr.pseudos,et.unique=rt.uniqueSort,et.text=rt.getText,et.isXMLDoc=rt.isXML,et.contains=rt.contains;var at=et.expr.match.needsContext,st=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ct=/^.[^:#\[\.,]*$/;et.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?et.find.matchesSelector(i,e)?[i]:[]:et.find.matches(e,et.grep(t,function(e){return 1===e.nodeType}))},et.fn.extend({find:function(e){var t,n=this.length,i=[],o=this;if("string"!=typeof e)return this.pushStack(et(e).filter(function(){for(t=0;n>t;t++)if(et.contains(o[t],this))return!0}));for(t=0;n>t;t++)et.find(e,o[t],i);return i=this.pushStack(n>1?et.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(o(this,e||[],!1))},not:function(e){return this.pushStack(o(this,e||[],!0))},is:function(e){return!!o(this,"string"==typeof e&&at.test(e)?et(e):e||[],!1).length}});var lt,ut=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,dt=et.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ut.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||lt).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof et?t[0]:t,et.merge(this,et.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:Q,!0)),st.test(n[1])&&et.isPlainObject(t))for(n in t)et.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return i=Q.getElementById(n[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=Q,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):et.isFunction(e)?"undefined"!=typeof lt.ready?lt.ready(e):e(et):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),et.makeArray(e,this))};dt.prototype=et.fn,lt=et(Q);var pt=/^(?:parents|prev(?:Until|All))/,ft={children:!0,contents:!0,next:!0,prev:!0};et.extend({dir:function(e,t,n){for(var i=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&et(e).is(n))break;i.push(e)}return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),et.fn.extend({has:function(e){var t=et(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(et.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,i=0,o=this.length,r=[],a=at.test(e)||"string"!=typeof e?et(e,t||this.context):0;o>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&et.find.matchesSelector(n,e))){r.push(n);break}return this.pushStack(r.length>1?et.unique(r):r)},index:function(e){return e?"string"==typeof e?q.call(et(e),this[0]):q.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(et.unique(et.merge(this.get(),et(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),et.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return et.dir(e,"parentNode")},parentsUntil:function(e,t,n){return et.dir(e,"parentNode",n)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return et.dir(e,"nextSibling")},prevAll:function(e){return et.dir(e,"previousSibling")},nextUntil:function(e,t,n){return et.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return et.dir(e,"previousSibling",n)},siblings:function(e){return et.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return et.sibling(e.firstChild)},contents:function(e){return e.contentDocument||et.merge([],e.childNodes)}},function(e,t){et.fn[e]=function(n,i){var o=et.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=et.filter(i,o)),this.length>1&&(ft[e]||et.unique(o),pt.test(e)&&o.reverse()),this.pushStack(o)}});var ht=/\S+/g,mt={};et.Callbacks=function(e){e="string"==typeof e?mt[e]||a(e):et.extend({},e);var t,n,i,o,r,s,c=[],l=!e.once&&[],u=function(a){for(t=e.memory&&a,n=!0,s=o||0,o=0,r=c.length,i=!0;c&&r>s;s++)if(c[s].apply(a[0],a[1])===!1&&e.stopOnFalse){t=!1;break}i=!1,c&&(l?l.length&&u(l.shift()):t?c=[]:d.disable())},d={add:function(){if(c){var n=c.length;!function a(t){et.each(t,function(t,n){var i=et.type(n);"function"===i?e.unique&&d.has(n)||c.push(n):n&&n.length&&"string"!==i&&a(n)})}(arguments),i?r=c.length:t&&(o=n,u(t))}return this},remove:function(){return c&&et.each(arguments,function(e,t){for(var n;(n=et.inArray(t,c,n))>-1;)c.splice(n,1),i&&(r>=n&&r--,s>=n&&s--)}),this},has:function(e){return e?et.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],r=0,this},disable:function(){return c=l=t=void 0,this},disabled:function(){return!c},lock:function(){return l=void 0,t||d.disable(),this},locked:function(){return!l},fireWith:function(e,t){return!c||n&&!l||(t=t||[],t=[e,t.slice?t.slice():t],i?l.push(t):u(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},et.extend({Deferred:function(e){var t=[["resolve","done",et.Callbacks("once memory"),"resolved"],["reject","fail",et.Callbacks("once memory"),"rejected"],["notify","progress",et.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return et.Deferred(function(n){et.each(t,function(t,r){var a=et.isFunction(e[t])&&e[t];o[r[1]](function(){var e=a&&a.apply(this,arguments);e&&et.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[r[0]+"With"](this===i?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?et.extend(e,i):i}},o={};return i.pipe=i.then,et.each(t,function(e,r){var a=r[2],s=r[3];i[r[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?i:this,arguments),this},o[r[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t,n,i,o=0,r=z.call(arguments),a=r.length,s=1!==a||e&&et.isFunction(e.promise)?a:0,c=1===s?e:et.Deferred(),l=function(e,n,i){return function(o){n[e]=this,i[e]=arguments.length>1?z.call(arguments):o,i===t?c.notifyWith(n,i):--s||c.resolveWith(n,i)}};if(a>1)for(t=new Array(a),n=new Array(a),i=new Array(a);a>o;o++)r[o]&&et.isFunction(r[o].promise)?r[o].promise().done(l(o,i,r)).fail(c.reject).progress(l(o,n,t)):--s;return s||c.resolveWith(i,r),c.promise()}});var gt;et.fn.ready=function(e){return et.ready.promise().done(e),this},et.extend({isReady:!1,readyWait:1,holdReady:function(e){e?et.readyWait++:et.ready(!0)},ready:function(e){(e===!0?--et.readyWait:et.isReady)||(et.isReady=!0,e!==!0&&--et.readyWait>0||(gt.resolveWith(Q,[et]),et.fn.triggerHandler&&(et(Q).triggerHandler("ready"),et(Q).off("ready"))))}}),et.ready.promise=function(e){return gt||(gt=et.Deferred(),"complete"===Q.readyState?setTimeout(et.ready):(Q.addEventListener("DOMContentLoaded",s,!1),t.addEventListener("load",s,!1))),gt.promise(e)},et.ready.promise();var vt=et.access=function(e,t,n,i,o,r,a){var s=0,c=e.length,l=null==n;if("object"===et.type(n)){o=!0;for(s in n)et.access(e,t,s,n[s],!0,r,a)}else if(void 0!==i&&(o=!0,et.isFunction(i)||(a=!0),l&&(a?(t.call(e,i),t=null):(l=t,t=function(e,t,n){return l.call(et(e),n)})),t))for(;c>s;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return o?e:l?t.call(e):c?t(e[0],n):r};et.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},c.uid=1,c.accepts=et.acceptData,c.prototype={key:function(e){if(!c.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=c.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,et.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,o=this.key(e),r=this.cache[o];if("string"==typeof t)r[t]=n;else if(et.isEmptyObject(r))et.extend(this.cache[o],t);else for(i in t)r[i]=t[i];return r},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var i;return void 0===t||t&&"string"==typeof t&&void 0===n?(i=this.get(e,t),void 0!==i?i:this.get(e,et.camelCase(t))):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i,o,r=this.key(e),a=this.cache[r];if(void 0===t)this.cache[r]={};else{et.isArray(t)?i=t.concat(t.map(et.camelCase)):(o=et.camelCase(t),t in a?i=[t,o]:(i=o,i=i in a?[i]:i.match(ht)||[])),n=i.length;for(;n--;)delete a[i[n]]}},hasData:function(e){return!et.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var yt=new c,bt=new c,St=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,_t=/([A-Z])/g;et.extend({hasData:function(e){return bt.hasData(e)||yt.hasData(e)},data:function(e,t,n){return bt.access(e,t,n)},removeData:function(e,t){bt.remove(e,t)},_data:function(e,t,n){return yt.access(e,t,n)},_removeData:function(e,t){yt.remove(e,t)}}),et.fn.extend({data:function(e,t){var n,i,o,r=this[0],a=r&&r.attributes;if(void 0===e){if(this.length&&(o=bt.get(r),1===r.nodeType&&!yt.get(r,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(i=a[n].name,0===i.indexOf("data-")&&(i=et.camelCase(i.slice(5)),l(r,i,o[i])));yt.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){bt.set(this,e)}):vt(this,function(t){var n,i=et.camelCase(e);if(r&&void 0===t){if(n=bt.get(r,e),void 0!==n)return n;if(n=bt.get(r,i),void 0!==n)return n;if(n=l(r,i,void 0),void 0!==n)return n}else this.each(function(){var n=bt.get(this,i);bt.set(this,i,t),-1!==e.indexOf("-")&&void 0!==n&&bt.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){bt.remove(this,e)})}}),et.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=yt.get(e,t),n&&(!i||et.isArray(n)?i=yt.access(e,t,et.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=et.queue(e,t),i=n.length,o=n.shift(),r=et._queueHooks(e,t),a=function(){et.dequeue(e,t)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete r.stop,o.call(e,a,r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return yt.get(e,n)||yt.access(e,n,{empty:et.Callbacks("once memory").add(function(){yt.remove(e,[t+"queue",n])})})}}),et.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?et.queue(this[0],e):void 0===t?this:this.each(function(){var n=et.queue(this,e,t);et._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&et.dequeue(this,e)})},dequeue:function(e){return this.each(function(){et.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,o=et.Deferred(),r=this,a=this.length,s=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)n=yt.get(r[a],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(s));return s(),o.promise(t)}});var wt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,At=["Top","Right","Bottom","Left"],xt=function(e,t){return e=t||e,"none"===et.css(e,"display")||!et.contains(e.ownerDocument,e)},Pt=/^(?:checkbox|radio)$/i;!function(){var e=Q.createDocumentFragment(),t=e.appendChild(Q.createElement("div")),n=Q.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),X.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",X.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Tt="undefined";X.focusinBubbles="onfocusin"in t;var Ct=/^key/,Et=/^(?:mouse|pointer|contextmenu)|click/,kt=/^(?:focusinfocus|focusoutblur)$/,Rt=/^([^.]*)(?:\.(.+)|)$/;et.event={global:{},add:function(e,t,n,i,o){var r,a,s,c,l,u,d,p,f,h,m,g=yt.get(e);if(g)for(n.handler&&(r=n,n=r.handler,o=r.selector),n.guid||(n.guid=et.guid++),(c=g.events)||(c=g.events={}),(a=g.handle)||(a=g.handle=function(t){return typeof et!==Tt&&et.event.triggered!==t.type?et.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(ht)||[""],l=t.length;l--;)s=Rt.exec(t[l])||[],f=m=s[1],h=(s[2]||"").split(".").sort(),f&&(d=et.event.special[f]||{},f=(o?d.delegateType:d.bindType)||f,d=et.event.special[f]||{},u=et.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&et.expr.match.needsContext.test(o),namespace:h.join(".")},r),(p=c[f])||(p=c[f]=[],p.delegateCount=0,d.setup&&d.setup.call(e,i,h,a)!==!1||e.addEventListener&&e.addEventListener(f,a,!1)),d.add&&(d.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,u):p.push(u),et.event.global[f]=!0)},remove:function(e,t,n,i,o){var r,a,s,c,l,u,d,p,f,h,m,g=yt.hasData(e)&&yt.get(e);if(g&&(c=g.events)){for(t=(t||"").match(ht)||[""],l=t.length;l--;)if(s=Rt.exec(t[l])||[],f=m=s[1],h=(s[2]||"").split(".").sort(),f){for(d=et.event.special[f]||{},f=(i?d.delegateType:d.bindType)||f,p=c[f]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=p.length;r--;)u=p[r],!o&&m!==u.origType||n&&n.guid!==u.guid||s&&!s.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(p.splice(r,1),u.selector&&p.delegateCount--,d.remove&&d.remove.call(e,u));a&&!p.length&&(d.teardown&&d.teardown.call(e,h,g.handle)!==!1||et.removeEvent(e,f,g.handle),delete c[f])}else for(f in c)et.event.remove(e,f+t[l],n,i,!0);et.isEmptyObject(c)&&(delete g.handle,yt.remove(e,"events"))}},trigger:function(e,n,i,o){var r,a,s,c,l,u,d,p=[i||Q],f=K.call(e,"type")?e.type:e,h=K.call(e,"namespace")?e.namespace.split("."):[];if(a=s=i=i||Q,3!==i.nodeType&&8!==i.nodeType&&!kt.test(f+et.event.triggered)&&(f.indexOf(".")>=0&&(h=f.split("."),f=h.shift(),h.sort()),l=f.indexOf(":")<0&&"on"+f,e=e[et.expando]?e:new et.Event(f,"object"==typeof e&&e),e.isTrigger=o?2:3,e.namespace=h.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:et.makeArray(n,[e]),d=et.event.special[f]||{},o||!d.trigger||d.trigger.apply(i,n)!==!1)){if(!o&&!d.noBubble&&!et.isWindow(i)){for(c=d.delegateType||f,kt.test(c+f)||(a=a.parentNode);a;a=a.parentNode)p.push(a),s=a;s===(i.ownerDocument||Q)&&p.push(s.defaultView||s.parentWindow||t)}for(r=0;(a=p[r++])&&!e.isPropagationStopped();)e.type=r>1?c:d.bindType||f,u=(yt.get(a,"events")||{})[e.type]&&yt.get(a,"handle"),u&&u.apply(a,n),u=l&&a[l],u&&u.apply&&et.acceptData(a)&&(e.result=u.apply(a,n),e.result===!1&&e.preventDefault());return e.type=f,o||e.isDefaultPrevented()||d._default&&d._default.apply(p.pop(),n)!==!1||!et.acceptData(i)||l&&et.isFunction(i[f])&&!et.isWindow(i)&&(s=i[l],s&&(i[l]=null),et.event.triggered=f,i[f](),et.event.triggered=void 0,s&&(i[l]=s)),e.result}},dispatch:function(e){e=et.event.fix(e);var t,n,i,o,r,a=[],s=z.call(arguments),c=(yt.get(this,"events")||{})[e.type]||[],l=et.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){for(a=et.event.handlers.call(this,e,c),t=0;(o=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(r.namespace))&&(e.handleObj=r,e.data=r.data,i=((et.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,s),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,o,r,a=[],s=t.delegateCount,c=e.target;if(s&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!==this;c=c.parentNode||this)if(c.disabled!==!0||"click"!==e.type){for(i=[],n=0;s>n;n++)r=t[n],o=r.selector+" ",void 0===i[o]&&(i[o]=r.needsContext?et(o,this).index(c)>=0:et.find(o,this,null,[c]).length),i[o]&&i.push(r);i.length&&a.push({elem:c,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,o,r=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||Q,i=n.documentElement,o=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e
}},fix:function(e){if(e[et.expando])return e;var t,n,i,o=e.type,r=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Et.test(o)?this.mouseHooks:Ct.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new et.Event(r),t=i.length;t--;)n=i[t],e[n]=r[n];return e.target||(e.target=Q),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,r):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==p()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===p()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&et.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return et.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var o=et.extend(new et.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?et.event.trigger(o,null,t):et.event.dispatch.call(t,o),o.isDefaultPrevented()&&n.preventDefault()}},et.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},et.Event=function(e,t){return this instanceof et.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?u:d):this.type=e,t&&et.extend(this,t),this.timeStamp=e&&e.timeStamp||et.now(),void(this[et.expando]=!0)):new et.Event(e,t)},et.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=u,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=u,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=u,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},et.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){et.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,o=e.relatedTarget,r=e.handleObj;return(!o||o!==i&&!et.contains(i,o))&&(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),X.focusinBubbles||et.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){et.event.simulate(t,e.target,et.event.fix(e),!0)};et.event.special[t]={setup:function(){var i=this.ownerDocument||this,o=yt.access(i,t);o||i.addEventListener(e,n,!0),yt.access(i,t,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=yt.access(i,t)-1;o?yt.access(i,t,o):(i.removeEventListener(e,n,!0),yt.remove(i,t))}}}),et.fn.extend({on:function(e,t,n,i,o){var r,a;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(a in e)this.on(a,t,n,e[a],o);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),i===!1)i=d;else if(!i)return this;return 1===o&&(r=i,i=function(e){return et().off(e),r.apply(this,arguments)},i.guid=r.guid||(r.guid=et.guid++)),this.each(function(){et.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,et(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=d),this.each(function(){et.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){et.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?et.event.trigger(e,t,n,!0):void 0}});var Lt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Dt=/<([\w:]+)/,Mt=/<|&#?\w+;/,It=/<(?:script|style|link)/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,jt=/^$|\/(?:java|ecma)script/i,Ot=/^true\/(.*)/,$t=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Vt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Vt.optgroup=Vt.option,Vt.tbody=Vt.tfoot=Vt.colgroup=Vt.caption=Vt.thead,Vt.th=Vt.td,et.extend({clone:function(e,t,n){var i,o,r,a,s=e.cloneNode(!0),c=et.contains(e.ownerDocument,e);if(!(X.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||et.isXMLDoc(e)))for(a=y(s),r=y(e),i=0,o=r.length;o>i;i++)b(r[i],a[i]);if(t)if(n)for(r=r||y(e),a=a||y(s),i=0,o=r.length;o>i;i++)v(r[i],a[i]);else v(e,s);return a=y(s,"script"),a.length>0&&g(a,!c&&y(e,"script")),s},buildFragment:function(e,t,n,i){for(var o,r,a,s,c,l,u=t.createDocumentFragment(),d=[],p=0,f=e.length;f>p;p++)if(o=e[p],o||0===o)if("object"===et.type(o))et.merge(d,o.nodeType?[o]:o);else if(Mt.test(o)){for(r=r||u.appendChild(t.createElement("div")),a=(Dt.exec(o)||["",""])[1].toLowerCase(),s=Vt[a]||Vt._default,r.innerHTML=s[1]+o.replace(Lt,"<$1></$2>")+s[2],l=s[0];l--;)r=r.lastChild;et.merge(d,r.childNodes),r=u.firstChild,r.textContent=""}else d.push(t.createTextNode(o));for(u.textContent="",p=0;o=d[p++];)if((!i||-1===et.inArray(o,i))&&(c=et.contains(o.ownerDocument,o),r=y(u.appendChild(o),"script"),c&&g(r),n))for(l=0;o=r[l++];)jt.test(o.type||"")&&n.push(o);return u},cleanData:function(e){for(var t,n,i,o,r=et.event.special,a=0;void 0!==(n=e[a]);a++){if(et.acceptData(n)&&(o=n[yt.expando],o&&(t=yt.cache[o]))){if(t.events)for(i in t.events)r[i]?et.event.remove(n,i):et.removeEvent(n,i,t.handle);yt.cache[o]&&delete yt.cache[o]}delete bt.cache[n[bt.expando]]}}}),et.fn.extend({text:function(e){return vt(this,function(e){return void 0===e?et.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?et.filter(e,this):this,o=0;null!=(n=i[o]);o++)t||1!==n.nodeType||et.cleanData(y(n)),n.parentNode&&(t&&et.contains(n.ownerDocument,n)&&g(y(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(et.cleanData(y(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return et.clone(this,e,t)})},html:function(e){return vt(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!It.test(e)&&!Vt[(Dt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Lt,"<$1></$2>");try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(et.cleanData(y(t,!1)),t.innerHTML=e);t=0}catch(o){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,et.cleanData(y(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=J.apply([],e);var n,i,o,r,a,s,c=0,l=this.length,u=this,d=l-1,p=e[0],f=et.isFunction(p);if(f||l>1&&"string"==typeof p&&!X.checkClone&&Nt.test(p))return this.each(function(n){var i=u.eq(n);f&&(e[0]=p.call(this,n,i.html())),i.domManip(e,t)});if(l&&(n=et.buildFragment(e,this[0].ownerDocument,!1,this),i=n.firstChild,1===n.childNodes.length&&(n=i),i)){for(o=et.map(y(n,"script"),h),r=o.length;l>c;c++)a=n,c!==d&&(a=et.clone(a,!0,!0),r&&et.merge(o,y(a,"script"))),t.call(this[c],a,c);if(r)for(s=o[o.length-1].ownerDocument,et.map(o,m),c=0;r>c;c++)a=o[c],jt.test(a.type||"")&&!yt.access(a,"globalEval")&&et.contains(s,a)&&(a.src?et._evalUrl&&et._evalUrl(a.src):et.globalEval(a.textContent.replace($t,"")))}return this}}),et.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){et.fn[e]=function(e){for(var n,i=[],o=et(e),r=o.length-1,a=0;r>=a;a++)n=a===r?this:this.clone(!0),et(o[a])[t](n),G.apply(i,n.get());return this.pushStack(i)}});var Ut,Ft={},Ht=/^margin/,Bt=new RegExp("^("+wt+")(?!px)[a-z%]+$","i"),zt=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):t.getComputedStyle(e,null)};!function(){function e(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",o.appendChild(r);var e=t.getComputedStyle(a,null);n="1%"!==e.top,i="4px"===e.width,o.removeChild(r)}var n,i,o=Q.documentElement,r=Q.createElement("div"),a=Q.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",X.clearCloneStyle="content-box"===a.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(a),t.getComputedStyle&&et.extend(X,{pixelPosition:function(){return e(),n},boxSizingReliable:function(){return null==i&&e(),i},reliableMarginRight:function(){var e,n=a.appendChild(Q.createElement("div"));return n.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",a.style.width="1px",o.appendChild(r),e=!parseFloat(t.getComputedStyle(n,null).marginRight),o.removeChild(r),a.removeChild(n),e}}))}(),et.swap=function(e,t,n,i){var o,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];o=n.apply(e,i||[]);for(r in t)e.style[r]=a[r];return o};var Jt=/^(none|table(?!-c[ea]).+)/,Gt=new RegExp("^("+wt+")(.*)$","i"),qt=new RegExp("^([+-])=("+wt+")","i"),Wt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:"0",fontWeight:"400"},Kt=["Webkit","O","Moz","ms"];et.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=w(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,a,s=et.camelCase(t),c=e.style;return t=et.cssProps[s]||(et.cssProps[s]=x(c,s)),a=et.cssHooks[t]||et.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(o=a.get(e,!1,i))?o:c[t]:(r=typeof n,"string"===r&&(o=qt.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(et.css(e,t)),r="number"),null!=n&&n===n&&("number"!==r||et.cssNumber[s]||(n+="px"),X.clearCloneStyle||""!==n||0!==t.indexOf("background")||(c[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,i))||(c[t]=n)),void 0)}},css:function(e,t,n,i){var o,r,a,s=et.camelCase(t);return t=et.cssProps[s]||(et.cssProps[s]=x(e.style,s)),a=et.cssHooks[t]||et.cssHooks[s],a&&"get"in a&&(o=a.get(e,!0,n)),void 0===o&&(o=w(e,t,i)),"normal"===o&&t in Yt&&(o=Yt[t]),""===n||n?(r=parseFloat(o),n===!0||et.isNumeric(r)?r||0:o):o}}),et.each(["height","width"],function(e,t){et.cssHooks[t]={get:function(e,n,i){return n?Jt.test(et.css(e,"display"))&&0===e.offsetWidth?et.swap(e,Wt,function(){return C(e,t,i)}):C(e,t,i):void 0},set:function(e,n,i){var o=i&&zt(e);return P(e,n,i?T(e,t,i,"border-box"===et.css(e,"boxSizing",!1,o),o):0)}}}),et.cssHooks.marginRight=A(X.reliableMarginRight,function(e,t){return t?et.swap(e,{display:"inline-block"},w,[e,"marginRight"]):void 0}),et.each({margin:"",padding:"",border:"Width"},function(e,t){et.cssHooks[e+t]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];4>i;i++)o[e+At[i]+t]=r[i]||r[i-2]||r[0];return o}},Ht.test(e)||(et.cssHooks[e+t].set=P)}),et.fn.extend({css:function(e,t){return vt(this,function(e,t,n){var i,o,r={},a=0;if(et.isArray(t)){for(i=zt(e),o=t.length;o>a;a++)r[t[a]]=et.css(e,t[a],!1,i);return r}return void 0!==n?et.style(e,t,n):et.css(e,t)},e,t,arguments.length>1)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){xt(this)?et(this).show():et(this).hide()})}}),et.Tween=k,k.prototype={constructor:k,init:function(e,t,n,i,o,r){this.elem=e,this.prop=n,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(et.cssNumber[n]?"":"px")},cur:function(){var e=k.propHooks[this.prop];return e&&e.get?e.get(this):k.propHooks._default.get(this)},run:function(e){var t,n=k.propHooks[this.prop];return this.pos=t=this.options.duration?et.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):k.propHooks._default.set(this),this}},k.prototype.init.prototype=k.prototype,k.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=et.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){et.fx.step[e.prop]?et.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[et.cssProps[e.prop]]||et.cssHooks[e.prop])?et.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},k.propHooks.scrollTop=k.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},et.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},et.fx=k.prototype.init,et.fx.step={};var Xt,Qt,Zt=/^(?:toggle|show|hide)$/,en=new RegExp("^(?:([+-])=|)("+wt+")([a-z%]*)$","i"),tn=/queueHooks$/,nn=[M],on={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),o=en.exec(t),r=o&&o[3]||(et.cssNumber[e]?"":"px"),a=(et.cssNumber[e]||"px"!==r&&+i)&&en.exec(et.css(n.elem,e)),s=1,c=20;if(a&&a[3]!==r){r=r||a[3],o=o||[],a=+i||1;do s=s||".5",a/=s,et.style(n.elem,e,a+r);while(s!==(s=n.cur()/i)&&1!==s&&--c)}return o&&(a=n.start=+a||+i||0,n.unit=r,n.end=o[1]?a+(o[1]+1)*o[2]:+o[2]),n}]};et.Animation=et.extend(N,{tweener:function(e,t){et.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,o=e.length;o>i;i++)n=e[i],on[n]=on[n]||[],on[n].unshift(t)},prefilter:function(e,t){t?nn.unshift(e):nn.push(e)}}),et.speed=function(e,t,n){var i=e&&"object"==typeof e?et.extend({},e):{complete:n||!n&&t||et.isFunction(e)&&e,duration:e,easing:n&&t||t&&!et.isFunction(t)&&t};return i.duration=et.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in et.fx.speeds?et.fx.speeds[i.duration]:et.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){et.isFunction(i.old)&&i.old.call(this),i.queue&&et.dequeue(this,i.queue)},i},et.fn.extend({fadeTo:function(e,t,n,i){return this.filter(xt).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=et.isEmptyObject(e),r=et.speed(t,n,i),a=function(){var t=N(this,et.extend({},e),r);(o||yt.get(this,"finish"))&&t.stop(!0)};return a.finish=a,o||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",r=et.timers,a=yt.get(this);if(o)a[o]&&a[o].stop&&i(a[o]);else for(o in a)a[o]&&a[o].stop&&tn.test(o)&&i(a[o]);for(o=r.length;o--;)r[o].elem!==this||null!=e&&r[o].queue!==e||(r[o].anim.stop(n),t=!1,r.splice(o,1));(t||!n)&&et.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=yt.get(this),i=n[e+"queue"],o=n[e+"queueHooks"],r=et.timers,a=i?i.length:0;for(n.finish=!0,et.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;a>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),et.each(["toggle","show","hide"],function(e,t){var n=et.fn[t];et.fn[t]=function(e,i,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(L(t,!0),e,i,o)}}),et.each({slideDown:L("show"),slideUp:L("hide"),slideToggle:L("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){et.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),et.timers=[],et.fx.tick=function(){var e,t=0,n=et.timers;for(Xt=et.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||et.fx.stop(),Xt=void 0},et.fx.timer=function(e){et.timers.push(e),e()?et.fx.start():et.timers.pop()},et.fx.interval=13,et.fx.start=function(){Qt||(Qt=setInterval(et.fx.tick,et.fx.interval))},et.fx.stop=function(){clearInterval(Qt),Qt=null},et.fx.speeds={slow:600,fast:200,_default:400},et.fn.delay=function(e,t){return e=et.fx?et.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},function(){var e=Q.createElement("input"),t=Q.createElement("select"),n=t.appendChild(Q.createElement("option"));e.type="checkbox",X.checkOn=""!==e.value,X.optSelected=n.selected,t.disabled=!0,X.optDisabled=!n.disabled,e=Q.createElement("input"),e.value="t",e.type="radio",X.radioValue="t"===e.value}();var rn,an,sn=et.expr.attrHandle;et.fn.extend({attr:function(e,t){return vt(this,et.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){et.removeAttr(this,e)})}}),et.extend({attr:function(e,t,n){var i,o,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return typeof e.getAttribute===Tt?et.prop(e,t,n):(1===r&&et.isXMLDoc(e)||(t=t.toLowerCase(),i=et.attrHooks[t]||(et.expr.match.bool.test(t)?an:rn)),void 0===n?i&&"get"in i&&null!==(o=i.get(e,t))?o:(o=et.find.attr(e,t),null==o?void 0:o):null!==n?i&&"set"in i&&void 0!==(o=i.set(e,n,t))?o:(e.setAttribute(t,n+""),n):void et.removeAttr(e,t))},removeAttr:function(e,t){var n,i,o=0,r=t&&t.match(ht);if(r&&1===e.nodeType)for(;n=r[o++];)i=et.propFix[n]||n,et.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!X.radioValue&&"radio"===t&&et.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),an={set:function(e,t,n){return t===!1?et.removeAttr(e,n):e.setAttribute(n,n),n}},et.each(et.expr.match.bool.source.match(/\w+/g),function(e,t){var n=sn[t]||et.find.attr;sn[t]=function(e,t,i){var o,r;return i||(r=sn[t],sn[t]=o,o=null!=n(e,t,i)?t.toLowerCase():null,sn[t]=r),o}});var cn=/^(?:input|select|textarea|button)$/i;et.fn.extend({prop:function(e,t){return vt(this,et.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[et.propFix[e]||e]})}}),et.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var i,o,r,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return r=1!==a||!et.isXMLDoc(e),r&&(t=et.propFix[t]||t,o=et.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:e[t]=n:o&&"get"in o&&null!==(i=o.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||cn.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),X.optSelected||(et.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),et.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){et.propFix[this.toLowerCase()]=this});var ln=/[\t\r\n\f]/g;et.fn.extend({addClass:function(e){var t,n,i,o,r,a,s="string"==typeof e&&e,c=0,l=this.length;if(et.isFunction(e))return this.each(function(t){et(this).addClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(ht)||[];l>c;c++)if(n=this[c],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ln," "):" ")){for(r=0;o=t[r++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=et.trim(i),n.className!==a&&(n.className=a)}return this},removeClass:function(e){var t,n,i,o,r,a,s=0===arguments.length||"string"==typeof e&&e,c=0,l=this.length;if(et.isFunction(e))return this.each(function(t){et(this).removeClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(ht)||[];l>c;c++)if(n=this[c],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ln," "):"")){for(r=0;o=t[r++];)for(;i.indexOf(" "+o+" ")>=0;)i=i.replace(" "+o+" "," ");a=e?et.trim(i):"",n.className!==a&&(n.className=a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(et.isFunction(e)?function(n){et(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,i=0,o=et(this),r=e.match(ht)||[];t=r[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else(n===Tt||"boolean"===n)&&(this.className&&yt.set(this,"__className__",this.className),this.className=this.className||e===!1?"":yt.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(ln," ").indexOf(t)>=0)return!0;return!1}});var un=/\r/g;et.fn.extend({val:function(e){var t,n,i,o=this[0];{if(arguments.length)return i=et.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=i?e.call(this,n,et(this).val()):e,null==o?o="":"number"==typeof o?o+="":et.isArray(o)&&(o=et.map(o,function(e){return null==e?"":e+""})),t=et.valHooks[this.type]||et.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))});if(o)return t=et.valHooks[o.type]||et.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(o,"value"))?n:(n=o.value,"string"==typeof n?n.replace(un,""):null==n?"":n)}}}),et.extend({valHooks:{option:{get:function(e){var t=et.find.attr(e,"value");return null!=t?t:et.trim(et.text(e))}},select:{get:function(e){for(var t,n,i=e.options,o=e.selectedIndex,r="select-one"===e.type||0>o,a=r?null:[],s=r?o+1:i.length,c=0>o?s:r?o:0;s>c;c++)if(n=i[c],!(!n.selected&&c!==o||(X.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&et.nodeName(n.parentNode,"optgroup"))){if(t=et(n).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var n,i,o=e.options,r=et.makeArray(t),a=o.length;a--;)i=o[a],(i.selected=et.inArray(i.value,r)>=0)&&(n=!0);return n||(e.selectedIndex=-1),r}}}}),et.each(["radio","checkbox"],function(){et.valHooks[this]={set:function(e,t){return et.isArray(t)?e.checked=et.inArray(et(e).val(),t)>=0:void 0}},X.checkOn||(et.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),et.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){et.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),et.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var dn=et.now(),pn=/\?/;et.parseJSON=function(e){return JSON.parse(e+"")},et.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(i){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&et.error("Invalid XML: "+e),t};var fn=/#.*$/,hn=/([?&])_=[^&]*/,mn=/^(.*?):[ \t]*([^\r\n]*)$/gm,gn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,yn=/^\/\//,bn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Sn={},_n={},wn="*/".concat("*"),An=t.location.href,xn=bn.exec(An.toLowerCase())||[];et.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:An,type:"GET",isLocal:gn.test(xn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":et.parseJSON,"text xml":et.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?$($(e,et.ajaxSettings),t):$(et.ajaxSettings,e)},ajaxPrefilter:j(Sn),ajaxTransport:j(_n),ajax:function(e,t){function n(e,t,n,a){var c,u,v,y,S,w=t;2!==b&&(b=2,s&&clearTimeout(s),i=void 0,r=a||"",_.readyState=e>0?4:0,c=e>=200&&300>e||304===e,n&&(y=V(d,_,n)),y=U(d,y,_,c),c?(d.ifModified&&(S=_.getResponseHeader("Last-Modified"),S&&(et.lastModified[o]=S),S=_.getResponseHeader("etag"),S&&(et.etag[o]=S)),204===e||"HEAD"===d.type?w="nocontent":304===e?w="notmodified":(w=y.state,u=y.data,v=y.error,c=!v)):(v=w,(e||!w)&&(w="error",0>e&&(e=0))),_.status=e,_.statusText=(t||w)+"",c?h.resolveWith(p,[u,w,_]):h.rejectWith(p,[_,w,v]),_.statusCode(g),g=void 0,l&&f.trigger(c?"ajaxSuccess":"ajaxError",[_,d,c?u:v]),m.fireWith(p,[_,w]),l&&(f.trigger("ajaxComplete",[_,d]),--et.active||et.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,o,r,a,s,c,l,u,d=et.ajaxSetup({},t),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?et(p):et.event,h=et.Deferred(),m=et.Callbacks("once memory"),g=d.statusCode||{},v={},y={},b=0,S="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!a)for(a={};t=mn.exec(r);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?r:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,v[e]=t),this},overrideMimeType:function(e){return b||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)g[t]=[g[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||S;return i&&i.abort(t),n(0,t),this}};if(h.promise(_).complete=m.add,_.success=_.done,_.error=_.fail,d.url=((e||d.url||An)+"").replace(fn,"").replace(yn,xn[1]+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=et.trim(d.dataType||"*").toLowerCase().match(ht)||[""],null==d.crossDomain&&(c=bn.exec(d.url.toLowerCase()),d.crossDomain=!(!c||c[1]===xn[1]&&c[2]===xn[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(xn[3]||("http:"===xn[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=et.param(d.data,d.traditional)),O(Sn,d,t,_),2===b)return _;l=et.event&&d.global,l&&0===et.active++&&et.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!vn.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(pn.test(o)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=hn.test(o)?o.replace(hn,"$1_="+dn++):o+(pn.test(o)?"&":"?")+"_="+dn++)),d.ifModified&&(et.lastModified[o]&&_.setRequestHeader("If-Modified-Since",et.lastModified[o]),et.etag[o]&&_.setRequestHeader("If-None-Match",et.etag[o])),(d.data&&d.hasContent&&d.contentType!==!1||t.contentType)&&_.setRequestHeader("Content-Type",d.contentType),_.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+wn+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)_.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(p,_,d)===!1||2===b))return _.abort();S="abort";for(u in{success:1,error:1,complete:1})_[u](d[u]);if(i=O(_n,d,t,_)){_.readyState=1,l&&f.trigger("ajaxSend",[_,d]),d.async&&d.timeout>0&&(s=setTimeout(function(){_.abort("timeout")},d.timeout));try{b=1,i.send(v,n)}catch(w){if(!(2>b))throw w;n(-1,w)}}else n(-1,"No Transport");return _},getJSON:function(e,t,n){return et.get(e,t,n,"json")},getScript:function(e,t){return et.get(e,void 0,t,"script")}}),et.each(["get","post"],function(e,t){et[t]=function(e,n,i,o){return et.isFunction(n)&&(o=o||i,i=n,n=void 0),et.ajax({url:e,type:t,dataType:o,data:n,success:i})}}),et._evalUrl=function(e){return et.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},et.fn.extend({wrapAll:function(e){var t;return et.isFunction(e)?this.each(function(t){et(this).wrapAll(e.call(this,t))}):(this[0]&&(t=et(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(et.isFunction(e)?function(t){et(this).wrapInner(e.call(this,t))}:function(){var t=et(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=et.isFunction(e);return this.each(function(n){et(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){et.nodeName(this,"body")||et(this).replaceWith(this.childNodes)}).end()}}),et.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},et.expr.filters.visible=function(e){return!et.expr.filters.hidden(e)};var Pn=/%20/g,Tn=/\[\]$/,Cn=/\r?\n/g,En=/^(?:submit|button|image|reset|file)$/i,kn=/^(?:input|select|textarea|keygen)/i;et.param=function(e,t){var n,i=[],o=function(e,t){t=et.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=et.ajaxSettings&&et.ajaxSettings.traditional),et.isArray(e)||e.jquery&&!et.isPlainObject(e))et.each(e,function(){o(this.name,this.value)});else for(n in e)F(n,e[n],t,o);return i.join("&").replace(Pn,"+")},et.fn.extend({serialize:function(){return et.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=et.prop(this,"elements");return e?et.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!et(this).is(":disabled")&&kn.test(this.nodeName)&&!En.test(e)&&(this.checked||!Pt.test(e))}).map(function(e,t){var n=et(this).val();return null==n?null:et.isArray(n)?et.map(n,function(e){return{name:t.name,value:e.replace(Cn,"\r\n")}}):{name:t.name,value:n.replace(Cn,"\r\n")}}).get()}}),et.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Rn=0,Ln={},Dn={0:200,1223:204},Mn=et.ajaxSettings.xhr();t.attachEvent&&t.attachEvent("onunload",function(){for(var e in Ln)Ln[e]()}),X.cors=!!Mn&&"withCredentials"in Mn,X.ajax=Mn=!!Mn,et.ajaxTransport(function(e){var t;return X.cors||Mn&&!e.crossDomain?{send:function(n,i){var o,r=e.xhr(),a=++Rn;if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)r[o]=e.xhrFields[o];e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(o in n)r.setRequestHeader(o,n[o]);t=function(e){return function(){t&&(delete Ln[a],t=r.onload=r.onerror=null,"abort"===e?r.abort():"error"===e?i(r.status,r.statusText):i(Dn[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=t(),r.onerror=t("error"),t=Ln[a]=t("abort");try{r.send(e.hasContent&&e.data||null)}catch(s){if(t)throw s}},abort:function(){t&&t()}}:void 0}),et.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return et.globalEval(e),e}}}),et.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),et.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,o){t=et("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)
}),Q.head.appendChild(t[0])},abort:function(){n&&n()}}}});var In=[],Nn=/(=)\?(?=&|$)|\?\?/;et.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=In.pop()||et.expando+"_"+dn++;return this[e]=!0,e}}),et.ajaxPrefilter("json jsonp",function(e,n,i){var o,r,a,s=e.jsonp!==!1&&(Nn.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Nn.test(e.data)&&"data");return s||"jsonp"===e.dataTypes[0]?(o=e.jsonpCallback=et.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Nn,"$1"+o):e.jsonp!==!1&&(e.url+=(pn.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return a||et.error(o+" was not called"),a[0]},e.dataTypes[0]="json",r=t[o],t[o]=function(){a=arguments},i.always(function(){t[o]=r,e[o]&&(e.jsonpCallback=n.jsonpCallback,In.push(o)),a&&et.isFunction(r)&&r(a[0]),a=r=void 0}),"script"):void 0}),et.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||Q;var i=st.exec(e),o=!n&&[];return i?[t.createElement(i[1])]:(i=et.buildFragment([e],t,o),o&&o.length&&et(o).remove(),et.merge([],i.childNodes))};var jn=et.fn.load;et.fn.load=function(e,t,n){if("string"!=typeof e&&jn)return jn.apply(this,arguments);var i,o,r,a=this,s=e.indexOf(" ");return s>=0&&(i=et.trim(e.slice(s)),e=e.slice(0,s)),et.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),a.length>0&&et.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){r=arguments,a.html(i?et("<div>").append(et.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){a.each(n,r||[e.responseText,t,e])}),this},et.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){et.fn[t]=function(e){return this.on(t,e)}}),et.expr.filters.animated=function(e){return et.grep(et.timers,function(t){return e===t.elem}).length};var On=t.document.documentElement;et.offset={setOffset:function(e,t,n){var i,o,r,a,s,c,l,u=et.css(e,"position"),d=et(e),p={};"static"===u&&(e.style.position="relative"),s=d.offset(),r=et.css(e,"top"),c=et.css(e,"left"),l=("absolute"===u||"fixed"===u)&&(r+c).indexOf("auto")>-1,l?(i=d.position(),a=i.top,o=i.left):(a=parseFloat(r)||0,o=parseFloat(c)||0),et.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+o),"using"in t?t.using.call(e,p):d.css(p)}},et.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){et.offset.setOffset(this,e,t)});var t,n,i=this[0],o={top:0,left:0},r=i&&i.ownerDocument;if(r)return t=r.documentElement,et.contains(t,i)?(typeof i.getBoundingClientRect!==Tt&&(o=i.getBoundingClientRect()),n=H(r),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===et.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),et.nodeName(e[0],"html")||(i=e.offset()),i.top+=et.css(e[0],"borderTopWidth",!0),i.left+=et.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-et.css(n,"marginTop",!0),left:t.left-i.left-et.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||On;e&&!et.nodeName(e,"html")&&"static"===et.css(e,"position");)e=e.offsetParent;return e||On})}}),et.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var i="pageYOffset"===n;et.fn[e]=function(o){return vt(this,function(e,o,r){var a=H(e);return void 0===r?a?a[n]:e[o]:void(a?a.scrollTo(i?t.pageXOffset:r,i?r:t.pageYOffset):e[o]=r)},e,o,arguments.length,null)}}),et.each(["top","left"],function(e,t){et.cssHooks[t]=A(X.pixelPosition,function(e,n){return n?(n=w(e,t),Bt.test(n)?et(e).position()[t]+"px":n):void 0})}),et.each({Height:"height",Width:"width"},function(e,t){et.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){et.fn[i]=function(i,o){var r=arguments.length&&(n||"boolean"!=typeof i),a=n||(i===!0||o===!0?"margin":"border");return vt(this,function(t,n,i){var o;return et.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?et.css(t,n,a):et.style(t,n,i,a)},t,r?i:void 0,r,null)}})}),et.fn.size=function(){return this.length},et.fn.andSelf=et.fn.addBack,"function"==typeof e&&e.amd&&e("jquery",[],function(){return et});var $n=t.jQuery,Vn=t.$;return et.noConflict=function(e){return t.$===et&&(t.$=Vn),e&&t.jQuery===et&&(t.jQuery=$n),et},typeof n===Tt&&(t.jQuery=t.$=et),et})},{}],81:[function(e,t){"use strict";var n=e("./lib/utils/common").assign,i=e("./lib/deflate"),o=e("./lib/inflate"),r=e("./lib/zlib/constants"),a={};n(a,i,o,r),t.exports=a},{"./lib/deflate":82,"./lib/inflate":83,"./lib/utils/common":84,"./lib/zlib/constants":87}],82:[function(e,t,n){"use strict";function i(e,t){var n=new S(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}function o(e,t){return t=t||{},t.raw=!0,i(e,t)}function r(e,t){return t=t||{},t.gzip=!0,i(e,t)}var a=e("./zlib/deflate.js"),s=e("./utils/common"),c=e("./utils/strings"),l=e("./zlib/messages"),u=e("./zlib/zstream"),d=Object.prototype.toString,p=0,f=4,h=0,m=1,g=2,v=-1,y=0,b=8,S=function(e){this.options=s.assign({level:v,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:y,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==h)throw new Error(l[n]);t.header&&a.deflateSetHeader(this.strm,t.header)};S.prototype.push=function(e,t){var n,i,o=this.strm,r=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:t===!0?f:p,o.input="string"==typeof e?c.string2buf(e):"[object ArrayBuffer]"===d.call(e)?new Uint8Array(e):e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new s.Buf8(r),o.next_out=0,o.avail_out=r),n=a.deflate(o,i),n!==m&&n!==h)return this.onEnd(n),this.ended=!0,!1;(0===o.avail_out||0===o.avail_in&&(i===f||i===g))&&this.onData("string"===this.options.to?c.buf2binstring(s.shrinkBuf(o.output,o.next_out)):s.shrinkBuf(o.output,o.next_out))}while((o.avail_in>0||0===o.avail_out)&&n!==m);return i===f?(n=a.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h):i===g?(this.onEnd(h),o.avail_out=0,!0):!0},S.prototype.onData=function(e){this.chunks.push(e)},S.prototype.onEnd=function(e){e===h&&(this.result="string"===this.options.to?this.chunks.join(""):s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=S,n.deflate=i,n.deflateRaw=o,n.gzip=r},{"./utils/common":84,"./utils/strings":85,"./zlib/deflate.js":89,"./zlib/messages":94,"./zlib/zstream":96}],83:[function(e,t,n){"use strict";function i(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}function o(e,t){return t=t||{},t.raw=!0,i(e,t)}var r=e("./zlib/inflate.js"),a=e("./utils/common"),s=e("./utils/strings"),c=e("./zlib/constants"),l=e("./zlib/messages"),u=e("./zlib/zstream"),d=e("./zlib/gzheader"),p=Object.prototype.toString,f=function(e){this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==c.Z_OK)throw new Error(l[n]);this.header=new d,r.inflateGetHeader(this.strm,this.header)};f.prototype.push=function(e,t){var n,i,o,l,u,d=this.strm,f=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:t===!0?c.Z_FINISH:c.Z_NO_FLUSH,d.input="string"==typeof e?s.binstring2buf(e):"[object ArrayBuffer]"===p.call(e)?new Uint8Array(e):e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new a.Buf8(f),d.next_out=0,d.avail_out=f),n=r.inflate(d,c.Z_NO_FLUSH),n!==c.Z_STREAM_END&&n!==c.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0===d.avail_out||n===c.Z_STREAM_END||0===d.avail_in&&(i===c.Z_FINISH||i===c.Z_SYNC_FLUSH))&&("string"===this.options.to?(o=s.utf8border(d.output,d.next_out),l=d.next_out-o,u=s.buf2string(d.output,o),d.next_out=l,d.avail_out=f-l,l&&a.arraySet(d.output,d.output,o,l,0),this.onData(u)):this.onData(a.shrinkBuf(d.output,d.next_out)))}while(d.avail_in>0&&n!==c.Z_STREAM_END);return n===c.Z_STREAM_END&&(i=c.Z_FINISH),i===c.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c.Z_OK):i===c.Z_SYNC_FLUSH?(this.onEnd(c.Z_OK),d.avail_out=0,!0):!0},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===c.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=f,n.inflate=i,n.inflateRaw=o,n.ungzip=i},{"./utils/common":84,"./utils/strings":85,"./zlib/constants":87,"./zlib/gzheader":90,"./zlib/inflate.js":92,"./zlib/messages":94,"./zlib/zstream":96}],84:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,n,i,o){if(t.subarray&&e.subarray)return void e.set(t.subarray(n,n+i),o);for(var r=0;i>r;r++)e[o+r]=t[n+r]},flattenChunks:function(e){var t,n,i,o,r,a;for(i=0,t=0,n=e.length;n>t;t++)i+=e[t].length;for(a=new Uint8Array(i),o=0,t=0,n=e.length;n>t;t++)r=e[t],a.set(r,o),o+=r.length;return a}},r={arraySet:function(e,t,n,i,o){for(var r=0;i>r;r++)e[o+r]=t[n+r]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,o)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,r))},n.setTyped(i)},{}],85:[function(e,t,n){"use strict";function i(e,t){if(65537>t&&(e.subarray&&a||!e.subarray&&r))return String.fromCharCode.apply(null,o.shrinkBuf(e,t));for(var n="",i=0;t>i;i++)n+=String.fromCharCode(e[i]);return n}var o=e("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(s){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){a=!1}for(var c=new o.Buf8(256),l=0;256>l;l++)c[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;c[254]=c[254]=1,n.string2buf=function(e){var t,n,i,r,a,s=e.length,c=0;for(r=0;s>r;r++)n=e.charCodeAt(r),55296===(64512&n)&&s>r+1&&(i=e.charCodeAt(r+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),c+=128>n?1:2048>n?2:65536>n?3:4;for(t=new o.Buf8(c),a=0,r=0;c>a;r++)n=e.charCodeAt(r),55296===(64512&n)&&s>r+1&&(i=e.charCodeAt(r+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),128>n?t[a++]=n:2048>n?(t[a++]=192|n>>>6,t[a++]=128|63&n):65536>n?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},n.buf2binstring=function(e){return i(e,e.length)},n.binstring2buf=function(e){for(var t=new o.Buf8(e.length),n=0,i=t.length;i>n;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,o,r,a,s=t||e.length,l=new Array(2*s);for(o=0,n=0;s>n;)if(r=e[n++],128>r)l[o++]=r;else if(a=c[r],a>4)l[o++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&s>n;)r=r<<6|63&e[n++],a--;a>1?l[o++]=65533:65536>r?l[o++]=r:(r-=65536,l[o++]=55296|r>>10&1023,l[o++]=56320|1023&r)}return i(l,o)},n.utf8border=function(e,t){var n;for(t=t||e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&128===(192&e[n]);)n--;return 0>n?t:0===n?t:n+c[e[n]]>t?n:t}},{"./common":84}],86:[function(e,t){"use strict";function n(e,t,n,i){for(var o=65535&e|0,r=e>>>16&65535|0,a=0;0!==n;){a=n>2e3?2e3:n,n-=a;do o=o+t[i++]|0,r=r+o|0;while(--a);o%=65521,r%=65521}return o|r<<16|0}t.exports=n},{}],87:[function(e,t){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],88:[function(e,t){"use strict";function n(){for(var e,t=[],n=0;256>n;n++){e=n;for(var i=0;8>i;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}function i(e,t,n,i){var r=o,a=i+n;e=-1^e;for(var s=i;a>s;s++)e=e>>>8^r[255&(e^t[s])];return-1^e}var o=n();t.exports=i},{}],89:[function(e,t,n){"use strict";function i(e,t){return e.msg=D[t],t}function o(e){return(e<<1)-(e>4?9:0)}function r(e){for(var t=e.length;--t>=0;)e[t]=0}function a(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(E.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function s(e,t){k._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,a(e.strm)}function c(e,t){e.pending_buf[e.pending++]=t}function l(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function u(e,t,n,i){var o=e.avail_in;return o>i&&(o=i),0===o?0:(e.avail_in-=o,E.arraySet(t,e.input,e.next_in,o,n),1===e.state.wrap?e.adler=R(e.adler,t,o,n):2===e.state.wrap&&(e.adler=L(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)}function d(e,t){var n,i,o=e.max_chain_length,r=e.strstart,a=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-lt?e.strstart-(e.w_size-lt):0,l=e.window,u=e.w_mask,d=e.prev,p=e.strstart+ct,f=l[r+a-1],h=l[r+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do if(n=t,l[n+a]===h&&l[n+a-1]===f&&l[n]===l[r]&&l[++n]===l[r+1]){r+=2,n++;do;while(l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&p>r);if(i=ct-(p-r),r=p-ct,i>a){if(e.match_start=t,a=i,i>=s)break;f=l[r+a-1],h=l[r+a]}}while((t=d[t&u])>c&&0!==--o);return a<=e.lookahead?a:e.lookahead}function p(e){var t,n,i,o,r,a=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-lt)){E.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,n=e.hash_size,t=n;do i=e.head[--t],e.head[t]=i>=a?i-a:0;while(--n);n=a,t=n;do i=e.prev[--t],e.prev[t]=i>=a?i-a:0;while(--n);o+=a}if(0===e.strm.avail_in)break;if(n=u(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=n,e.lookahead+e.insert>=st)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+st-1])&e.hash_mask,e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<st)););}while(e.lookahead<lt&&0!==e.strm.avail_in)}function f(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(p(e),0===e.lookahead&&t===M)return yt;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,s(e,!1),0===e.strm.avail_out))return yt;if(e.strstart-e.block_start>=e.w_size-lt&&(s(e,!1),0===e.strm.avail_out))return yt}return e.insert=0,t===j?(s(e,!0),0===e.strm.avail_out?St:_t):e.strstart>e.block_start&&(s(e,!1),0===e.strm.avail_out)?yt:yt}function h(e,t){for(var n,i;;){if(e.lookahead<lt){if(p(e),e.lookahead<lt&&t===M)return yt;if(0===e.lookahead)break}if(n=0,e.lookahead>=st&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+st-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-lt&&(e.match_length=d(e,n)),e.match_length>=st)if(i=k._tr_tally(e,e.strstart-e.match_start,e.match_length-st),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=st){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+st-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=k._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(s(e,!1),0===e.strm.avail_out))return yt}return e.insert=e.strstart<st-1?e.strstart:st-1,t===j?(s(e,!0),0===e.strm.avail_out?St:_t):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?yt:bt}function m(e,t){for(var n,i,o;;){if(e.lookahead<lt){if(p(e),e.lookahead<lt&&t===M)return yt;if(0===e.lookahead)break}if(n=0,e.lookahead>=st&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+st-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=st-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-lt&&(e.match_length=d(e,n),e.match_length<=5&&(e.strategy===z||e.match_length===st&&e.strstart-e.match_start>4096)&&(e.match_length=st-1)),e.prev_length>=st&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-st,i=k._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-st),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+st-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!==--e.prev_length);if(e.match_available=0,e.match_length=st-1,e.strstart++,i&&(s(e,!1),0===e.strm.avail_out))return yt}else if(e.match_available){if(i=k._tr_tally(e,0,e.window[e.strstart-1]),i&&s(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return yt}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=k._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<st-1?e.strstart:st-1,t===j?(s(e,!0),0===e.strm.avail_out?St:_t):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?yt:bt}function g(e,t){for(var n,i,o,r,a=e.window;;){if(e.lookahead<=ct){if(p(e),e.lookahead<=ct&&t===M)return yt;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=st&&e.strstart>0&&(o=e.strstart-1,i=a[o],i===a[++o]&&i===a[++o]&&i===a[++o])){r=e.strstart+ct;do;while(i===a[++o]&&i===a[++o]&&i===a[++o]&&i===a[++o]&&i===a[++o]&&i===a[++o]&&i===a[++o]&&i===a[++o]&&r>o);e.match_length=ct-(r-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=st?(n=k._tr_tally(e,1,e.match_length-st),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=k._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(s(e,!1),0===e.strm.avail_out))return yt}return e.insert=0,t===j?(s(e,!0),0===e.strm.avail_out?St:_t):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?yt:bt}function v(e,t){for(var n;;){if(0===e.lookahead&&(p(e),0===e.lookahead)){if(t===M)return yt;break}if(e.match_length=0,n=k._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(s(e,!1),0===e.strm.avail_out))return yt}return e.insert=0,t===j?(s(e,!0),0===e.strm.avail_out?St:_t):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?yt:bt}function y(e){e.window_size=2*e.w_size,r(e.head),e.max_lazy_match=C[e.level].max_lazy,e.good_match=C[e.level].good_length,e.nice_match=C[e.level].nice_length,e.max_chain_length=C[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=st-1,e.match_available=0,e.ins_h=0}function b(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=K,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new E.Buf16(2*rt),this.dyn_dtree=new E.Buf16(2*(2*it+1)),this.bl_tree=new E.Buf16(2*(2*ot+1)),r(this.dyn_ltree),r(this.dyn_dtree),r(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new E.Buf16(at+1),this.heap=new E.Buf16(2*nt+1),r(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new E.Buf16(2*nt+1),r(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function S(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Y,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?dt:gt,e.adler=2===t.wrap?0:1,t.last_flush=M,k._tr_init(t),$):i(e,U)}function _(e){var t=S(e);return t===$&&y(e.state),t}function w(e,t){return e&&e.state?2!==e.state.wrap?U:(e.state.gzhead=t,$):U}function A(e,t,n,o,r,a){if(!e)return U;var s=1;if(t===B&&(t=6),0>o?(s=0,o=-o):o>15&&(s=2,o-=16),1>r||r>X||n!==K||8>o||o>15||0>t||t>9||0>a||a>q)return i(e,U);8===o&&(o=9);var c=new b;return e.state=c,c.strm=e,c.wrap=s,c.gzhead=null,c.w_bits=o,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=r+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+st-1)/st),c.window=new E.Buf8(2*c.w_size),c.head=new E.Buf16(c.hash_size),c.prev=new E.Buf16(c.w_size),c.lit_bufsize=1<<r+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new E.Buf8(c.pending_buf_size),c.d_buf=c.lit_bufsize>>1,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=a,c.method=n,_(e)}function x(e,t){return A(e,t,K,Q,Z,W)}function P(e,t){var n,s,u,d;if(!e||!e.state||t>O||0>t)return e?i(e,U):U;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||s.status===vt&&t!==j)return i(e,0===e.avail_out?H:U);if(s.strm=e,n=s.last_flush,s.last_flush=t,s.status===dt)if(2===s.wrap)e.adler=0,c(s,31),c(s,139),c(s,8),s.gzhead?(c(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),c(s,255&s.gzhead.time),c(s,s.gzhead.time>>8&255),c(s,s.gzhead.time>>16&255),c(s,s.gzhead.time>>24&255),c(s,9===s.level?2:s.strategy>=J||s.level<2?4:0),c(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(c(s,255&s.gzhead.extra.length),c(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=L(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=pt):(c(s,0),c(s,0),c(s,0),c(s,0),c(s,0),c(s,9===s.level?2:s.strategy>=J||s.level<2?4:0),c(s,wt),s.status=gt);else{var p=K+(s.w_bits-8<<4)<<8,f=-1;f=s.strategy>=J||s.level<2?0:s.level<6?1:6===s.level?2:3,p|=f<<6,0!==s.strstart&&(p|=ut),p+=31-p%31,s.status=gt,l(s,p),0!==s.strstart&&(l(s,e.adler>>>16),l(s,65535&e.adler)),e.adler=1}if(s.status===pt)if(s.gzhead.extra){for(u=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>u&&(e.adler=L(e.adler,s.pending_buf,s.pending-u,u)),a(e),u=s.pending,s.pending!==s.pending_buf_size));)c(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>u&&(e.adler=L(e.adler,s.pending_buf,s.pending-u,u)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=ft)}else s.status=ft;if(s.status===ft)if(s.gzhead.name){u=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>u&&(e.adler=L(e.adler,s.pending_buf,s.pending-u,u)),a(e),u=s.pending,s.pending===s.pending_buf_size)){d=1;break}d=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,c(s,d)}while(0!==d);s.gzhead.hcrc&&s.pending>u&&(e.adler=L(e.adler,s.pending_buf,s.pending-u,u)),0===d&&(s.gzindex=0,s.status=ht)}else s.status=ht;if(s.status===ht)if(s.gzhead.comment){u=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>u&&(e.adler=L(e.adler,s.pending_buf,s.pending-u,u)),a(e),u=s.pending,s.pending===s.pending_buf_size)){d=1;break}d=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,c(s,d)}while(0!==d);s.gzhead.hcrc&&s.pending>u&&(e.adler=L(e.adler,s.pending_buf,s.pending-u,u)),0===d&&(s.status=mt)}else s.status=mt;if(s.status===mt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&a(e),s.pending+2<=s.pending_buf_size&&(c(s,255&e.adler),c(s,e.adler>>8&255),e.adler=0,s.status=gt)):s.status=gt),0!==s.pending){if(a(e),0===e.avail_out)return s.last_flush=-1,$}else if(0===e.avail_in&&o(t)<=o(n)&&t!==j)return i(e,H);if(s.status===vt&&0!==e.avail_in)return i(e,H);if(0!==e.avail_in||0!==s.lookahead||t!==M&&s.status!==vt){var h=s.strategy===J?v(s,t):s.strategy===G?g(s,t):C[s.level].func(s,t);if((h===St||h===_t)&&(s.status=vt),h===yt||h===St)return 0===e.avail_out&&(s.last_flush=-1),$;if(h===bt&&(t===I?k._tr_align(s):t!==O&&(k._tr_stored_block(s,0,0,!1),t===N&&(r(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),a(e),0===e.avail_out))return s.last_flush=-1,$}return t!==j?$:s.wrap<=0?V:(2===s.wrap?(c(s,255&e.adler),c(s,e.adler>>8&255),c(s,e.adler>>16&255),c(s,e.adler>>24&255),c(s,255&e.total_in),c(s,e.total_in>>8&255),c(s,e.total_in>>16&255),c(s,e.total_in>>24&255)):(l(s,e.adler>>>16),l(s,65535&e.adler)),a(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?$:V)}function T(e){var t;return e&&e.state?(t=e.state.status,t!==dt&&t!==pt&&t!==ft&&t!==ht&&t!==mt&&t!==gt&&t!==vt?i(e,U):(e.state=null,t===gt?i(e,F):$)):U}var C,E=e("../utils/common"),k=e("./trees"),R=e("./adler32"),L=e("./crc32"),D=e("./messages"),M=0,I=1,N=3,j=4,O=5,$=0,V=1,U=-2,F=-3,H=-5,B=-1,z=1,J=2,G=3,q=4,W=0,Y=2,K=8,X=9,Q=15,Z=8,et=29,tt=256,nt=tt+1+et,it=30,ot=19,rt=2*nt+1,at=15,st=3,ct=258,lt=ct+st+1,ut=32,dt=42,pt=69,ft=73,ht=91,mt=103,gt=113,vt=666,yt=1,bt=2,St=3,_t=4,wt=3,At=function(e,t,n,i,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=o};C=[new At(0,0,0,0,f),new At(4,4,8,4,h),new At(4,5,16,8,h),new At(4,6,32,32,h),new At(4,4,16,16,m),new At(8,16,32,32,m),new At(8,16,128,128,m),new At(8,32,128,256,m),new At(32,128,258,1024,m),new At(32,258,258,4096,m)],n.deflateInit=x,n.deflateInit2=A,n.deflateReset=_,n.deflateResetKeep=S,n.deflateSetHeader=w,n.deflate=P,n.deflateEnd=T,n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":84,"./adler32":86,"./crc32":88,"./messages":94,"./trees":95}],90:[function(e,t){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=n},{}],91:[function(e,t){"use strict";var n=30,i=12;t.exports=function(e,t){var o,r,a,s,c,l,u,d,p,f,h,m,g,v,y,b,S,_,w,A,x,P,T,C,E;o=e.state,r=e.next_in,C=e.input,a=r+(e.avail_in-5),s=e.next_out,E=e.output,c=s-(t-e.avail_out),l=s+(e.avail_out-257),u=o.dmax,d=o.wsize,p=o.whave,f=o.wnext,h=o.window,m=o.hold,g=o.bits,v=o.lencode,y=o.distcode,b=(1<<o.lenbits)-1,S=(1<<o.distbits)-1;e:do{15>g&&(m+=C[r++]<<g,g+=8,m+=C[r++]<<g,g+=8),_=v[m&b];t:for(;;){if(w=_>>>24,m>>>=w,g-=w,w=_>>>16&255,0===w)E[s++]=65535&_;else{if(!(16&w)){if(0===(64&w)){_=v[(65535&_)+(m&(1<<w)-1)];continue t}if(32&w){o.mode=i;break e}e.msg="invalid literal/length code",o.mode=n;break e}A=65535&_,w&=15,w&&(w>g&&(m+=C[r++]<<g,g+=8),A+=m&(1<<w)-1,m>>>=w,g-=w),15>g&&(m+=C[r++]<<g,g+=8,m+=C[r++]<<g,g+=8),_=y[m&S];n:for(;;){if(w=_>>>24,m>>>=w,g-=w,w=_>>>16&255,!(16&w)){if(0===(64&w)){_=y[(65535&_)+(m&(1<<w)-1)];continue n}e.msg="invalid distance code",o.mode=n;break e}if(x=65535&_,w&=15,w>g&&(m+=C[r++]<<g,g+=8,w>g&&(m+=C[r++]<<g,g+=8)),x+=m&(1<<w)-1,x>u){e.msg="invalid distance too far back",o.mode=n;break e}if(m>>>=w,g-=w,w=s-c,x>w){if(w=x-w,w>p&&o.sane){e.msg="invalid distance too far back",o.mode=n;break e}if(P=0,T=h,0===f){if(P+=d-w,A>w){A-=w;do E[s++]=h[P++];while(--w);P=s-x,T=E}}else if(w>f){if(P+=d+f-w,w-=f,A>w){A-=w;do E[s++]=h[P++];while(--w);if(P=0,A>f){w=f,A-=w;do E[s++]=h[P++];while(--w);P=s-x,T=E}}}else if(P+=f-w,A>w){A-=w;do E[s++]=h[P++];while(--w);P=s-x,T=E}for(;A>2;)E[s++]=T[P++],E[s++]=T[P++],E[s++]=T[P++],A-=3;A&&(E[s++]=T[P++],A>1&&(E[s++]=T[P++]))}else{P=s-x;do E[s++]=E[P++],E[s++]=E[P++],E[s++]=E[P++],A-=3;while(A>2);A&&(E[s++]=E[P++],A>1&&(E[s++]=E[P++]))}break}}break}}while(a>r&&l>s);A=g>>3,r-=A,g-=A<<3,m&=(1<<g)-1,e.next_in=r,e.next_out=s,e.avail_in=a>r?5+(a-r):5-(r-a),e.avail_out=l>s?257+(l-s):257-(s-l),o.hold=m,o.bits=g}},{}],92:[function(e,t,n){"use strict";function i(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function o(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function r(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=j,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new v.Buf32(ht),t.distcode=t.distdyn=new v.Buf32(mt),t.sane=1,t.back=-1,E):L}function a(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,r(e)):L}function s(e,t){var n,i;return e&&e.state?(i=e.state,0>t?(n=0,t=-t):(n=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||t>15)?L:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,a(e))):L}function c(e,t){var n,i;return e?(i=new o,e.state=i,i.window=null,n=s(e,t),n!==E&&(e.state=null),n):L}function l(e){return c(e,vt)}function u(e){if(yt){var t;for(m=new v.Buf32(512),g=new v.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(_(A,e.lens,0,288,m,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;_(x,e.lens,0,32,g,0,e.work,{bits:5}),yt=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function d(e,t,n,i){var o,r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new v.Buf8(r.wsize)),i>=r.wsize?(v.arraySet(r.window,t,n-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(o=r.wsize-r.wnext,o>i&&(o=i),v.arraySet(r.window,t,n-i,o,r.wnext),i-=o,i?(v.arraySet(r.window,t,n-i,i,0),r.wnext=i,r.whave=r.wsize):(r.wnext+=o,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=o))),0}function p(e,t){var n,o,r,a,s,c,l,p,f,h,m,g,ht,mt,gt,vt,yt,bt,St,_t,wt,At,xt,Pt,Tt=0,Ct=new v.Buf8(4),Et=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return L;n=e.state,n.mode===q&&(n.mode=W),s=e.next_out,r=e.output,l=e.avail_out,a=e.next_in,o=e.input,c=e.avail_in,p=n.hold,f=n.bits,h=c,m=l,At=E;e:for(;;)switch(n.mode){case j:if(0===n.wrap){n.mode=W;break}for(;16>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(2&n.wrap&&35615===p){n.check=0,Ct[0]=255&p,Ct[1]=p>>>8&255,n.check=b(n.check,Ct,2,0),p=0,f=0,n.mode=O;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&p)<<8)+(p>>8))%31){e.msg="incorrect header check",n.mode=dt;break}if((15&p)!==N){e.msg="unknown compression method",n.mode=dt;break}if(p>>>=4,f-=4,wt=(15&p)+8,0===n.wbits)n.wbits=wt;else if(wt>n.wbits){e.msg="invalid window size",n.mode=dt;break}n.dmax=1<<wt,e.adler=n.check=1,n.mode=512&p?J:q,p=0,f=0;break;case O:for(;16>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(n.flags=p,(255&n.flags)!==N){e.msg="unknown compression method",n.mode=dt;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=dt;break}n.head&&(n.head.text=p>>8&1),512&n.flags&&(Ct[0]=255&p,Ct[1]=p>>>8&255,n.check=b(n.check,Ct,2,0)),p=0,f=0,n.mode=$;
case $:for(;32>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}n.head&&(n.head.time=p),512&n.flags&&(Ct[0]=255&p,Ct[1]=p>>>8&255,Ct[2]=p>>>16&255,Ct[3]=p>>>24&255,n.check=b(n.check,Ct,4,0)),p=0,f=0,n.mode=V;case V:for(;16>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}n.head&&(n.head.xflags=255&p,n.head.os=p>>8),512&n.flags&&(Ct[0]=255&p,Ct[1]=p>>>8&255,n.check=b(n.check,Ct,2,0)),p=0,f=0,n.mode=U;case U:if(1024&n.flags){for(;16>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}n.length=p,n.head&&(n.head.extra_len=p),512&n.flags&&(Ct[0]=255&p,Ct[1]=p>>>8&255,n.check=b(n.check,Ct,2,0)),p=0,f=0}else n.head&&(n.head.extra=null);n.mode=F;case F:if(1024&n.flags&&(g=n.length,g>c&&(g=c),g&&(n.head&&(wt=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),v.arraySet(n.head.extra,o,a,g,wt)),512&n.flags&&(n.check=b(n.check,o,g,a)),c-=g,a+=g,n.length-=g),n.length))break e;n.length=0,n.mode=H;case H:if(2048&n.flags){if(0===c)break e;g=0;do wt=o[a+g++],n.head&&wt&&n.length<65536&&(n.head.name+=String.fromCharCode(wt));while(wt&&c>g);if(512&n.flags&&(n.check=b(n.check,o,g,a)),c-=g,a+=g,wt)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=B;case B:if(4096&n.flags){if(0===c)break e;g=0;do wt=o[a+g++],n.head&&wt&&n.length<65536&&(n.head.comment+=String.fromCharCode(wt));while(wt&&c>g);if(512&n.flags&&(n.check=b(n.check,o,g,a)),c-=g,a+=g,wt)break e}else n.head&&(n.head.comment=null);n.mode=z;case z:if(512&n.flags){for(;16>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(p!==(65535&n.check)){e.msg="header crc mismatch",n.mode=dt;break}p=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=q;break;case J:for(;32>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}e.adler=n.check=i(p),p=0,f=0,n.mode=G;case G:if(0===n.havedict)return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=c,n.hold=p,n.bits=f,R;e.adler=n.check=1,n.mode=q;case q:if(t===T||t===C)break e;case W:if(n.last){p>>>=7&f,f-=7&f,n.mode=ct;break}for(;3>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}switch(n.last=1&p,p>>>=1,f-=1,3&p){case 0:n.mode=Y;break;case 1:if(u(n),n.mode=tt,t===C){p>>>=2,f-=2;break e}break;case 2:n.mode=Q;break;case 3:e.msg="invalid block type",n.mode=dt}p>>>=2,f-=2;break;case Y:for(p>>>=7&f,f-=7&f;32>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if((65535&p)!==(p>>>16^65535)){e.msg="invalid stored block lengths",n.mode=dt;break}if(n.length=65535&p,p=0,f=0,n.mode=K,t===C)break e;case K:n.mode=X;case X:if(g=n.length){if(g>c&&(g=c),g>l&&(g=l),0===g)break e;v.arraySet(r,o,a,g,s),c-=g,a+=g,l-=g,s+=g,n.length-=g;break}n.mode=q;break;case Q:for(;14>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(n.nlen=(31&p)+257,p>>>=5,f-=5,n.ndist=(31&p)+1,p>>>=5,f-=5,n.ncode=(15&p)+4,p>>>=4,f-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=dt;break}n.have=0,n.mode=Z;case Z:for(;n.have<n.ncode;){for(;3>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}n.lens[Et[n.have++]]=7&p,p>>>=3,f-=3}for(;n.have<19;)n.lens[Et[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,xt={bits:n.lenbits},At=_(w,n.lens,0,19,n.lencode,0,n.work,xt),n.lenbits=xt.bits,At){e.msg="invalid code lengths set",n.mode=dt;break}n.have=0,n.mode=et;case et:for(;n.have<n.nlen+n.ndist;){for(;Tt=n.lencode[p&(1<<n.lenbits)-1],gt=Tt>>>24,vt=Tt>>>16&255,yt=65535&Tt,!(f>=gt);){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(16>yt)p>>>=gt,f-=gt,n.lens[n.have++]=yt;else{if(16===yt){for(Pt=gt+2;Pt>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(p>>>=gt,f-=gt,0===n.have){e.msg="invalid bit length repeat",n.mode=dt;break}wt=n.lens[n.have-1],g=3+(3&p),p>>>=2,f-=2}else if(17===yt){for(Pt=gt+3;Pt>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}p>>>=gt,f-=gt,wt=0,g=3+(7&p),p>>>=3,f-=3}else{for(Pt=gt+7;Pt>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}p>>>=gt,f-=gt,wt=0,g=11+(127&p),p>>>=7,f-=7}if(n.have+g>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=dt;break}for(;g--;)n.lens[n.have++]=wt}}if(n.mode===dt)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=dt;break}if(n.lenbits=9,xt={bits:n.lenbits},At=_(A,n.lens,0,n.nlen,n.lencode,0,n.work,xt),n.lenbits=xt.bits,At){e.msg="invalid literal/lengths set",n.mode=dt;break}if(n.distbits=6,n.distcode=n.distdyn,xt={bits:n.distbits},At=_(x,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,xt),n.distbits=xt.bits,At){e.msg="invalid distances set",n.mode=dt;break}if(n.mode=tt,t===C)break e;case tt:n.mode=nt;case nt:if(c>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=c,n.hold=p,n.bits=f,S(e,m),s=e.next_out,r=e.output,l=e.avail_out,a=e.next_in,o=e.input,c=e.avail_in,p=n.hold,f=n.bits,n.mode===q&&(n.back=-1);break}for(n.back=0;Tt=n.lencode[p&(1<<n.lenbits)-1],gt=Tt>>>24,vt=Tt>>>16&255,yt=65535&Tt,!(f>=gt);){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(vt&&0===(240&vt)){for(bt=gt,St=vt,_t=yt;Tt=n.lencode[_t+((p&(1<<bt+St)-1)>>bt)],gt=Tt>>>24,vt=Tt>>>16&255,yt=65535&Tt,!(f>=bt+gt);){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}p>>>=bt,f-=bt,n.back+=bt}if(p>>>=gt,f-=gt,n.back+=gt,n.length=yt,0===vt){n.mode=st;break}if(32&vt){n.back=-1,n.mode=q;break}if(64&vt){e.msg="invalid literal/length code",n.mode=dt;break}n.extra=15&vt,n.mode=it;case it:if(n.extra){for(Pt=n.extra;Pt>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}n.length+=p&(1<<n.extra)-1,p>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=ot;case ot:for(;Tt=n.distcode[p&(1<<n.distbits)-1],gt=Tt>>>24,vt=Tt>>>16&255,yt=65535&Tt,!(f>=gt);){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(0===(240&vt)){for(bt=gt,St=vt,_t=yt;Tt=n.distcode[_t+((p&(1<<bt+St)-1)>>bt)],gt=Tt>>>24,vt=Tt>>>16&255,yt=65535&Tt,!(f>=bt+gt);){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}p>>>=bt,f-=bt,n.back+=bt}if(p>>>=gt,f-=gt,n.back+=gt,64&vt){e.msg="invalid distance code",n.mode=dt;break}n.offset=yt,n.extra=15&vt,n.mode=rt;case rt:if(n.extra){for(Pt=n.extra;Pt>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}n.offset+=p&(1<<n.extra)-1,p>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=dt;break}n.mode=at;case at:if(0===l)break e;if(g=m-l,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=dt;break}g>n.wnext?(g-=n.wnext,ht=n.wsize-g):ht=n.wnext-g,g>n.length&&(g=n.length),mt=n.window}else mt=r,ht=s-n.offset,g=n.length;g>l&&(g=l),l-=g,n.length-=g;do r[s++]=mt[ht++];while(--g);0===n.length&&(n.mode=nt);break;case st:if(0===l)break e;r[s++]=n.length,l--,n.mode=nt;break;case ct:if(n.wrap){for(;32>f;){if(0===c)break e;c--,p|=o[a++]<<f,f+=8}if(m-=l,e.total_out+=m,n.total+=m,m&&(e.adler=n.check=n.flags?b(n.check,r,m,s-m):y(n.check,r,m,s-m)),m=l,(n.flags?p:i(p))!==n.check){e.msg="incorrect data check",n.mode=dt;break}p=0,f=0}n.mode=lt;case lt:if(n.wrap&&n.flags){for(;32>f;){if(0===c)break e;c--,p+=o[a++]<<f,f+=8}if(p!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=dt;break}p=0,f=0}n.mode=ut;case ut:At=k;break e;case dt:At=D;break e;case pt:return M;case ft:default:return L}return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=c,n.hold=p,n.bits=f,(n.wsize||m!==e.avail_out&&n.mode<dt&&(n.mode<ct||t!==P))&&d(e,e.output,e.next_out,m-e.avail_out)?(n.mode=pt,M):(h-=e.avail_in,m-=e.avail_out,e.total_in+=h,e.total_out+=m,n.total+=m,n.wrap&&m&&(e.adler=n.check=n.flags?b(n.check,r,m,e.next_out-m):y(n.check,r,m,e.next_out-m)),e.data_type=n.bits+(n.last?64:0)+(n.mode===q?128:0)+(n.mode===tt||n.mode===K?256:0),(0===h&&0===m||t===P)&&At===E&&(At=I),At)}function f(e){if(!e||!e.state)return L;var t=e.state;return t.window&&(t.window=null),e.state=null,E}function h(e,t){var n;return e&&e.state?(n=e.state,0===(2&n.wrap)?L:(n.head=t,t.done=!1,E)):L}var m,g,v=e("../utils/common"),y=e("./adler32"),b=e("./crc32"),S=e("./inffast"),_=e("./inftrees"),w=0,A=1,x=2,P=4,T=5,C=6,E=0,k=1,R=2,L=-2,D=-3,M=-4,I=-5,N=8,j=1,O=2,$=3,V=4,U=5,F=6,H=7,B=8,z=9,J=10,G=11,q=12,W=13,Y=14,K=15,X=16,Q=17,Z=18,et=19,tt=20,nt=21,it=22,ot=23,rt=24,at=25,st=26,ct=27,lt=28,ut=29,dt=30,pt=31,ft=32,ht=852,mt=592,gt=15,vt=gt,yt=!0;n.inflateReset=a,n.inflateReset2=s,n.inflateResetKeep=r,n.inflateInit=l,n.inflateInit2=c,n.inflate=p,n.inflateEnd=f,n.inflateGetHeader=h,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":84,"./adler32":86,"./crc32":88,"./inffast":91,"./inftrees":93}],93:[function(e,t){"use strict";var n=e("../utils/common"),i=15,o=852,r=592,a=0,s=1,c=2,l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,f,h,m,g,v,y){var b,S,_,w,A,x,P,T,C,E=y.bits,k=0,R=0,L=0,D=0,M=0,I=0,N=0,j=0,O=0,$=0,V=null,U=0,F=new n.Buf16(i+1),H=new n.Buf16(i+1),B=null,z=0;for(k=0;i>=k;k++)F[k]=0;for(R=0;h>R;R++)F[t[f+R]]++;for(M=E,D=i;D>=1&&0===F[D];D--);if(M>D&&(M=D),0===D)return m[g++]=20971520,m[g++]=20971520,y.bits=1,0;for(L=1;D>L&&0===F[L];L++);for(L>M&&(M=L),j=1,k=1;i>=k;k++)if(j<<=1,j-=F[k],0>j)return-1;if(j>0&&(e===a||1!==D))return-1;for(H[1]=0,k=1;i>k;k++)H[k+1]=H[k]+F[k];for(R=0;h>R;R++)0!==t[f+R]&&(v[H[t[f+R]]++]=R);if(e===a?(V=B=v,x=19):e===s?(V=l,U-=257,B=u,z-=257,x=256):(V=d,B=p,x=-1),$=0,R=0,k=L,A=g,I=M,N=0,_=-1,O=1<<M,w=O-1,e===s&&O>o||e===c&&O>r)return 1;for(var J=0;;){J++,P=k-N,v[R]<x?(T=0,C=v[R]):v[R]>x?(T=B[z+v[R]],C=V[U+v[R]]):(T=96,C=0),b=1<<k-N,S=1<<I,L=S;do S-=b,m[A+($>>N)+S]=P<<24|T<<16|C|0;while(0!==S);for(b=1<<k-1;$&b;)b>>=1;if(0!==b?($&=b-1,$+=b):$=0,R++,0===--F[k]){if(k===D)break;k=t[f+v[R]]}if(k>M&&($&w)!==_){for(0===N&&(N=M),A+=L,I=k-N,j=1<<I;D>I+N&&(j-=F[I+N],!(0>=j));)I++,j<<=1;if(O+=1<<I,e===s&&O>o||e===c&&O>r)return 1;_=$&w,m[_]=M<<24|I<<16|A-g|0}}return 0!==$&&(m[A+$]=k-N<<24|64<<16|0),y.bits=M,0}},{"../utils/common":84}],94:[function(e,t){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],95:[function(e,t,n){"use strict";function i(e){for(var t=e.length;--t>=0;)e[t]=0}function o(e){return 256>e?at[e]:at[256+(e>>>7)]}function r(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function a(e,t,n){e.bi_valid>q-n?(e.bi_buf|=t<<e.bi_valid&65535,r(e,e.bi_buf),e.bi_buf=t>>q-e.bi_valid,e.bi_valid+=n-q):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function s(e,t,n){a(e,n[2*t],n[2*t+1])}function c(e,t){var n=0;do n|=1&e,e>>>=1,n<<=1;while(--t>0);return n>>>1}function l(e){16===e.bi_valid?(r(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function u(e,t){var n,i,o,r,a,s,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,h=t.stat_desc.max_length,m=0;for(r=0;G>=r;r++)e.bl_count[r]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;J>n;n++)i=e.heap[n],r=c[2*c[2*i+1]+1]+1,r>h&&(r=h,m++),c[2*i+1]=r,i>l||(e.bl_count[r]++,a=0,i>=f&&(a=p[i-f]),s=c[2*i],e.opt_len+=s*(r+a),d&&(e.static_len+=s*(u[2*i+1]+a)));if(0!==m){do{for(r=h-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[h]--,m-=2}while(m>0);for(r=h;0!==r;r--)for(i=e.bl_count[r];0!==i;)o=e.heap[--n],o>l||(c[2*o+1]!==r&&(e.opt_len+=(r-c[2*o+1])*c[2*o],c[2*o+1]=r),i--)}}function d(e,t,n){var i,o,r=new Array(G+1),a=0;for(i=1;G>=i;i++)r[i]=a=a+n[i-1]<<1;for(o=0;t>=o;o++){var s=e[2*o+1];0!==s&&(e[2*o]=c(r[s]++,s))}}function p(){var e,t,n,i,o,r=new Array(G+1);for(n=0,i=0;U-1>i;i++)for(ct[i]=n,e=0;e<1<<Z[i];e++)st[n++]=i;for(st[n-1]=i,o=0,i=0;16>i;i++)for(lt[i]=o,e=0;e<1<<et[i];e++)at[o++]=i;for(o>>=7;B>i;i++)for(lt[i]=o<<7,e=0;e<1<<et[i]-7;e++)at[256+o++]=i;for(t=0;G>=t;t++)r[t]=0;for(e=0;143>=e;)ot[2*e+1]=8,e++,r[8]++;for(;255>=e;)ot[2*e+1]=9,e++,r[9]++;for(;279>=e;)ot[2*e+1]=7,e++,r[7]++;for(;287>=e;)ot[2*e+1]=8,e++,r[8]++;for(d(ot,H+1,r),e=0;B>e;e++)rt[2*e+1]=5,rt[2*e]=c(e,5);ut=new ft(ot,Z,F+1,H,G),dt=new ft(rt,et,0,B,G),pt=new ft(new Array(0),tt,0,z,W)}function f(e){var t;for(t=0;H>t;t++)e.dyn_ltree[2*t]=0;for(t=0;B>t;t++)e.dyn_dtree[2*t]=0;for(t=0;z>t;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Y]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function h(e){e.bi_valid>8?r(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function m(e,t,n,i){h(e),i&&(r(e,n),r(e,~n)),R.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function g(e,t,n,i){var o=2*t,r=2*n;return e[o]<e[r]||e[o]===e[r]&&i[t]<=i[n]}function v(e,t,n){for(var i=e.heap[n],o=n<<1;o<=e.heap_len&&(o<e.heap_len&&g(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!g(t,i,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=i}function y(e,t,n){var i,r,c,l,u=0;if(0!==e.last_lit)do i=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],r=e.pending_buf[e.l_buf+u],u++,0===i?s(e,r,t):(c=st[r],s(e,c+F+1,t),l=Z[c],0!==l&&(r-=ct[c],a(e,r,l)),i--,c=o(i),s(e,c,n),l=et[c],0!==l&&(i-=lt[c],a(e,i,l)));while(u<e.last_lit);s(e,Y,t)}function b(e,t){var n,i,o,r=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=J,n=0;c>n;n++)0!==r[2*n]?(e.heap[++e.heap_len]=l=n,e.depth[n]=0):r[2*n+1]=0;for(;e.heap_len<2;)o=e.heap[++e.heap_len]=2>l?++l:0,r[2*o]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=a[2*o+1]);for(t.max_code=l,n=e.heap_len>>1;n>=1;n--)v(e,r,n);o=c;do n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],v(e,r,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,r[2*o]=r[2*n]+r[2*i],e.depth[o]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,r[2*n+1]=r[2*i+1]=o,e.heap[1]=o++,v(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],u(e,t),d(r,l,e.bl_count)}function S(e,t,n){var i,o,r=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),t[2*(n+1)+1]=65535,i=0;n>=i;i++)o=a,a=t[2*(i+1)+1],++s<c&&o===a||(l>s?e.bl_tree[2*o]+=s:0!==o?(o!==r&&e.bl_tree[2*o]++,e.bl_tree[2*K]++):10>=s?e.bl_tree[2*X]++:e.bl_tree[2*Q]++,s=0,r=o,0===a?(c=138,l=3):o===a?(c=6,l=3):(c=7,l=4))}function _(e,t,n){var i,o,r=-1,c=t[1],l=0,u=7,d=4;for(0===c&&(u=138,d=3),i=0;n>=i;i++)if(o=c,c=t[2*(i+1)+1],!(++l<u&&o===c)){if(d>l){do s(e,o,e.bl_tree);while(0!==--l)}else 0!==o?(o!==r&&(s(e,o,e.bl_tree),l--),s(e,K,e.bl_tree),a(e,l-3,2)):10>=l?(s(e,X,e.bl_tree),a(e,l-3,3)):(s(e,Q,e.bl_tree),a(e,l-11,7));l=0,r=o,0===c?(u=138,d=3):o===c?(u=6,d=3):(u=7,d=4)}}function w(e){var t;for(S(e,e.dyn_ltree,e.l_desc.max_code),S(e,e.dyn_dtree,e.d_desc.max_code),b(e,e.bl_desc),t=z-1;t>=3&&0===e.bl_tree[2*nt[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function A(e,t,n,i){var o;for(a(e,t-257,5),a(e,n-1,5),a(e,i-4,4),o=0;i>o;o++)a(e,e.bl_tree[2*nt[o]+1],3);_(e,e.dyn_ltree,t-1),_(e,e.dyn_dtree,n-1)}function x(e){var t,n=4093624447;for(t=0;31>=t;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return D;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return M;for(t=32;F>t;t++)if(0!==e.dyn_ltree[2*t])return M;return D}function P(e){mt||(p(),mt=!0),e.l_desc=new ht(e.dyn_ltree,ut),e.d_desc=new ht(e.dyn_dtree,dt),e.bl_desc=new ht(e.bl_tree,pt),e.bi_buf=0,e.bi_valid=0,f(e)}function T(e,t,n,i){a(e,(N<<1)+(i?1:0),3),m(e,t,n,!0)}function C(e){a(e,j<<1,3),s(e,Y,ot),l(e)}function E(e,t,n,i){var o,r,s=0;e.level>0?(e.strm.data_type===I&&(e.strm.data_type=x(e)),b(e,e.l_desc),b(e,e.d_desc),s=w(e),o=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,o>=r&&(o=r)):o=r=n+5,o>=n+4&&-1!==t?T(e,t,n,i):e.strategy===L||r===o?(a(e,(j<<1)+(i?1:0),3),y(e,ot,rt)):(a(e,(O<<1)+(i?1:0),3),A(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),y(e,e.dyn_ltree,e.dyn_dtree)),f(e),i&&h(e)}function k(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(st[n]+F+1)]++,e.dyn_dtree[2*o(t)]++),e.last_lit===e.lit_bufsize-1}var R=e("../utils/common"),L=4,D=0,M=1,I=2,N=0,j=1,O=2,$=3,V=258,U=29,F=256,H=F+1+U,B=30,z=19,J=2*H+1,G=15,q=16,W=7,Y=256,K=16,X=17,Q=18,Z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],et=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],tt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],nt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],it=512,ot=new Array(2*(H+2));i(ot);var rt=new Array(2*B);i(rt);var at=new Array(it);i(at);var st=new Array(V-$+1);i(st);var ct=new Array(U);i(ct);var lt=new Array(B);i(lt);var ut,dt,pt,ft=function(e,t,n,i,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=o,this.has_stree=e&&e.length},ht=function(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t},mt=!1;n._tr_init=P,n._tr_stored_block=T,n._tr_flush_block=E,n._tr_tally=k,n._tr_align=C},{"../utils/common":84}],96:[function(e,t){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=n},{}],97:[function(e,t){t.exports=e("./lib/retry")},{"./lib/retry":98}],98:[function(e,t,n){var i=e("./retry_operation");n.operation=function(e){var t=n.timeouts(e);return new i(t)},n.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],o=0;o<t.retries;o++)i.push(this._createTimeout(o,t));return i.sort(function(e,t){return e-t}),i},n._createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,i=Math.round(n*t.minTimeout*Math.pow(t.factor,e));return i=Math.min(i,t.maxTimeout)}},{"./retry_operation":99}],99:[function(e,t){function n(e){this._timeouts=e,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null}t.exports=n,n.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;this._errors.push(e);var t=this._timeouts.shift();if(void 0===t)return!1;this._attempts++;var n=this;return setTimeout(function(){n._fn(n._attempts),n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout))},t),!0},n.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb)),this._fn(this._attempts);var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout))},n.prototype["try"]=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},n.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},n.prototype.start=n.prototype["try"],n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,i=0;i<this._errors.length;i++){var o=this._errors[i],r=o.message,a=(e[r]||0)+1;e[r]=a,a>=n&&(t=o,n=a)}return t}},{}],100:[function(e,t){t.exports=function n(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,i=this.length;i>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!n.apply(this[t],[e[t]]))return!1}else if(this[t]!=e[t])return!1;return!0}},{}],101:[function(e,t,n){n.Interop=e("./interop")},{"./interop":102}],102:[function(e,t){"use strict";function n(){this.cache={}}var i=e("./transform"),o=e("./array-equals");t.exports=n,n.prototype.toPlanB=function(e){if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var t=i.parse(e.sdp);if("undefined"==typeof t.media||!Array.isArray(t.media)||0===t.media.length)return console.warn("The description has no media."),e;if(t.media.length<=3&&t.media.every(function(e){return-1!==["video","audio","data"].indexOf(e.mid)}))return console.warn("This description does not look like Unified Plan."),e;this.cache[e.type]=e.sdp;var n=t.media;t.media=[];var o={},r=[];n.forEach(function(e){if(("string"!=typeof e.rtcpMux||"rtcp-mux"!==e.rtcpMux)&&"inactive"!==e.direction)throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");return"application"===e.type?(t.media.push(e),void r.push(e.mid)):("undefined"==typeof o[e.type]&&(o[e.type]=e),"object"==typeof e.sources&&Object.keys(e.sources).forEach(function(t){"object"!=typeof o[e.type].sources&&(o[e.type].sources={}),o[e.type].sources[t]=e.sources[t],"undefined"!=typeof e.msid&&(o[e.type].sources[t].msid=e.msid)}),"undefined"!=typeof e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&("undefined"!=typeof o[e.type].ssrcGroups&&Array.isArray(o[e.type].ssrcGroups)||(o[e.type].ssrcGroups=[]),o[e.type].ssrcGroups=o[e.type].ssrcGroups.concat(e.ssrcGroups)),void(o[e.type]===e&&(e.candidates=n[0].candidates,e.iceUfrag=n[0].iceUfrag,e.icePwd=n[0].icePwd,e.fingerprint=n[0].fingerprint,e.mid=e.type,delete e.bundleOnly,delete e.msid,r.push(e.type),t.media.push(e))))}),t.groups.some(function(e){return"BUNDLE"===e.type?(e.mids=r.join(" "),!0):void 0}),t.msidSemantic={semantic:"WMS",token:"*"};var a=i.write(t);return new RTCSessionDescription({type:e.type,sdp:a})},n.prototype.toUnifiedPlan=function(e){if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var t=i.parse(e.sdp);if("undefined"==typeof t.media||!Array.isArray(t.media)||0===t.media.length)return console.warn("The description has no media."),e;if(t.media.length>3||!t.media.every(function(e){return-1!==["video","audio","data"].indexOf(e.mid)}))return console.warn("This description does not look like Plan B."),e;var n=[];t.media.forEach(function(e){n.push(e.mid)});var r=!1;if("undefined"!=typeof t.groups&&Array.isArray(t.groups)&&(r=t.groups.every(function(e){return"BUNDLE"!==e.type||o.apply(e.mids.sort(),[n.sort()])})),!r)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.");var a;"undefined"!=typeof this.cache[e.type]&&(a=i.parse(this.cache[e.type]));var s={};if(t.media.forEach(function(t){if(("string"!=typeof t.rtcpMux||"rtcp-mux"!==t.rtcpMux)&&"inactive"!==t.direction)throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if("application"===t.type)return void(s[t.mid]=t);var n=t.sources,i=t.ssrcGroups,o=t.candidates,r=t.iceUfrag,c=t.icePwd,l=t.fingerprint,u=t.port;delete t.sources,delete t.ssrcGroups,delete t.candidates,delete t.iceUfrag,delete t.icePwd,delete t.fingerprint,delete t.port,delete t.mid;var d={};"undefined"!=typeof i&&Array.isArray(i)&&i.forEach(function(e){"SIM"!==e.semantics&&"undefined"!=typeof e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach(function(t){"undefined"==typeof d[t]&&(d[t]=[]),d[t].push(e)})});var p={};"object"==typeof n&&Object.keys(n).forEach(function(i){var f;if("undefined"!=typeof d[i]&&Array.isArray(d[i])&&d[i].some(function(e){return e.ssrcs.some(function(e){return"object"==typeof p[e]?(f=p[e],!0):void 0})}),"object"==typeof f)f.sources[i]=n[i],delete n[i].msid;else{if(f=Object.create(t),p[i]=f,"undefined"!=typeof n[i].msid&&(f.msid=n[i].msid,delete n[i].msid),f.sources={},f.sources[i]=n[i],f.ssrcGroups=d[i],"undefined"!=typeof a&&"undefined"!=typeof a.media&&Array.isArray(a.media)&&a.media.forEach(function(e){"object"==typeof e.sources&&Object.keys(e.sources).forEach(function(t){t===i&&(f.mid=e.mid)})}),"undefined"==typeof f.mid){if("answer"===e.type)throw new Error("An unmapped SSRC was found.");f.mid=[t.type,"-",i].join("")}f.candidates=o,f.iceUfrag=r,f.icePwd=c,f.fingerprint=l,f.port=u,s[f.mid]=f}})}),t.media=[],n=[],"answer"===e.type)for(var c=0;c<a.media.length;c++){var l=a.media[c];"undefined"==typeof s[l.mid]&&(delete l.msid,delete l.sources,delete l.ssrcGroups,l.direction&&"sendrecv"!==l.direction||(l.direction="recvonly"),l.direction&&"sendonly"!==l.direction||(l.direction="inactive")),t.media.push(l),"string"==typeof l.mid&&n.push(l.mid)}else"undefined"!=typeof a&&"undefined"!=typeof a.media&&Array.isArray(a.media)&&a.media.forEach(function(e){n.push(e.mid),"undefined"!=typeof s[e.mid]?t.media.push(s[e.mid]):(delete e.msid,delete e.sources,delete e.ssrcGroups,e.direction&&"sendrecv"!==e.direction||(e.direction="recvonly"),e.direction&&"sendonly"!==e.direction||(e.direction="inactive"),t.media.push(e))}),Object.keys(s).forEach(function(e){-1===n.indexOf(e)&&(n.push(e),"recvonly"==typeof s[e].direction?t.media.some(function(t){return"sendrecv"!==t.direction&&"sendonly"!==t.direction||t.type!==s[e].type?void 0:(Object.keys(s[e].sources).forEach(function(n){t.sources[n]=s[e].sources[n]}),!0)}):t.media.push(s[e]))});t.groups.some(function(e){return"BUNDLE"===e.type?(e.mids=n.join(" "),!0):void 0}),t.msidSemantic={semantic:"WMS",token:"*"};var u=i.write(t);return this.cache[e.type]=u,new RTCSessionDescription({type:e.type,sdp:u})}},{"./array-equals":100,"./transform":103}],103:[function(e,t,n){var i=e("sdp-transform");n.write=function(e,t){return"undefined"!=typeof e&&"undefined"!=typeof e.media&&Array.isArray(e.media)&&e.media.forEach(function(e){"undefined"!=typeof e.sources&&0!==Object.keys(e.sources).length&&(e.ssrcs=[],Object.keys(e.sources).forEach(function(t){var n=e.sources[t];Object.keys(n).forEach(function(i){e.ssrcs.push({id:t,attribute:i,value:n[i]})})}),delete e.sources),"undefined"!=typeof e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach(function(e){"undefined"!=typeof e.ssrcs&&Array.isArray(e.ssrcs)&&(e.ssrcs=e.ssrcs.join(" "))})}),"undefined"!=typeof e&&"undefined"!=typeof e.groups&&Array.isArray(e.groups)&&e.groups.forEach(function(e){"undefined"!=typeof e.mids&&Array.isArray(e.mids)&&(e.mids=e.mids.join(" "))}),i.write(e,t)},n.parse=function(e){var t=i.parse(e);return"undefined"!=typeof t&&"undefined"!=typeof t.media&&Array.isArray(t.media)&&t.media.forEach(function(e){"undefined"!=typeof e.ssrcs&&Array.isArray(e.ssrcs)&&(e.sources={},e.ssrcs.forEach(function(t){e.sources[t.id]||(e.sources[t.id]={}),e.sources[t.id][t.attribute]=t.value}),delete e.ssrcs),"undefined"!=typeof e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach(function(e){"string"==typeof e.ssrcs&&(e.ssrcs=e.ssrcs.split(" "))})}),"undefined"!=typeof t&&"undefined"!=typeof t.groups&&Array.isArray(t.groups)&&t.groups.forEach(function(e){"string"==typeof e.mids&&(e.mids=e.mids.split(" "))}),t}},{"sdp-transform":105}],104:[function(e,t){var n=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)\/(\d*)(?:\s*\/(\S*))?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":"rtpmap:%d %s/%s"}},{push:"fmtp",reg:/^fmtp:(\d*) (\S*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},{}],105:[function(e,t,n){var i=e("./parser"),o=e("./writer");n.write=o,n.parse=i.parse,n.parseFmtpConfig=i.parseFmtpConfig,n.parsePayloads=i.parsePayloads,n.parseRemoteCandidates=i.parseRemoteCandidates},{"./parser":106,"./writer":107}],106:[function(e,t,n){var i=function(e){return String(Number(e))===e?Number(e):e},o=function(e,t,n,o){if(o&&!n)t[o]=i(e[1]);else for(var r=0;r<n.length;r+=1)null!=e[r+1]&&(t[n[r]]=i(e[r+1]))},r=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var r=e.push?{}:i?t[e.name]:t;o(n.match(e.reg),r,e.names,e.name),e.push&&t[e.push].push(r)},a=e("./grammar"),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(e){var t={},n=[],i=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach(function(e){var t=e[0],o=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),i=n[n.length-1]);for(var s=0;s<(a[t]||[]).length;s+=1){var c=a[t][s];if(c.reg.test(o))return r(c,i,o)}}),t.media=n,t};var c=function(e,t){var n=t.split("=");return 2===n.length&&(e[n[0]]=i(n[1])),e};n.parseFmtpConfig=function(e){return e.split(";").reduce(c,{})},n.parsePayloads=function(e){return e.split(" ").map(Number)},n.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(i),o=0;o<n.length;o+=3)t.push({component:n[o],ip:n[o+1],port:n[o+2]});return t}},{"./grammar":104}],107:[function(e,t){var n=e("./grammar"),i=/%[sdv%]/g,o=function(e){var t=1,n=arguments,o=n.length;return e.replace(i,function(e){if(t>=o)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},r=function(e,t,n){var i=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,r=[e+"="+i];
if(t.names)for(var a=0;a<t.names.length;a+=1){var s=t.names[a];r.push(t.name?n[t.name][s]:n[t.names[a]])}else r.push(n[t.name]);return o.apply(null,r)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],s=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var i=t.outerOrder||a,o=t.innerOrder||s,c=[];return i.forEach(function(t){n[t].forEach(function(n){n.name in e&&null!=e[n.name]?c.push(r(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){c.push(r(t,n,e))})})}),e.media.forEach(function(e){c.push(r("m",n.m[0],e)),o.forEach(function(t){n[t].forEach(function(n){n.name in e&&null!=e[n.name]?c.push(r(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){c.push(r(t,n,e))})})})}),c.join("\r\n")+"\r\n"}},{"./grammar":104}]},{},[1])(1)});